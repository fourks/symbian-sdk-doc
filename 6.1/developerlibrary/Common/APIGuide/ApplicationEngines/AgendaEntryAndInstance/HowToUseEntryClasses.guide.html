<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>How to create and use entries</title>
<link href="../../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="AgendaModelGuide%2eHowToUseEntryClasses"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../../_index/index.html"><img
src="../../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../../GlobalGlossary/index.html"><img src="../../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CategorySupport.html"><img src="../../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="HowToEntryDateTime.guide.html"><img src="../../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../../Product/Generic/APIGuide/index.html">API&nbsp;Guide</a>&nbsp;<span class="separator">&#187;</span>
<a href="../index.html">Application&nbsp;Engines</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Using&nbsp;Agenda&nbsp;Entry&nbsp;and&nbsp;Instance</a>&nbsp;<span class="separator">&#187;</span>
How&nbsp;to&nbsp;create&nbsp;and&nbsp;use&nbsp;entries</p>

<hr noshade size="1">
<div class="AuthoredContent">

</div><div class="Head1">

<h1>How to create and use entries</h1>
</div><div class="Bodytext">
<a name="1.3"></a></div><div class="Head2">
<hr size="2" noshade>
<h2>Creating entries</h2>
</div><div class="Bodytext">
<p>To create a new entry, use:</p><ul><li><p><a href="../../../APIReference/AgendaEntry/CAgnApptClass.html#%3a%3aCAgnAppt%3a%3aNewL%28%29" title="Allocates memory for and constructs a new appointment entry"><code class="ApiItem">CAgnAppt::NewL()</code></a></p></li><li><p><a href="../../../APIReference/AgendaEntry/CAgnEventClass.html#%3a%3aCAgnEvent%3a%3aNewL%28%29" title="Allocates memory for and constructs a new event entry"><code class="ApiItem">CAgnEvent::NewL()</code></a></p></li><li><p><a href="../../../APIReference/AgendaEntry/CAgnAnnivClass.html#%3a%3aCAgnAnniv%3a%3aNewL%28%29" title="Allocates memory for and constructs a new anniversary entry"><code class="ApiItem">CAgnAnniv::NewL()</code></a></p></li><li><p><a href="../../../APIReference/AgendaTodoList/CAgnTodoClass.html#%3a%3aCAgnTodo%3a%3aNewL%28%29" title="Allocates memory for and constructs a new to-do entry"><code class="ApiItem">CAgnTodo::NewL()</code></a></p></li></ul><p> Alternatively, use the corresponding <code>NewLC()</code> functions.</p>
<p>You can also create a new entry, copying its details from an existing entry, using the entry classes' respective <code>CopyFromL()</code> functions.</p>
<a name="1.4"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Retrieving the different entry types</h2>
</div><div class="Bodytext">
<p>Entries can be retrieved using functions provided by the model classes. When entries or instances are retrieved from the model they have to be retrieved into a <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry" title="Abstract base class for the concrete agenda entry classes"><code class="ApiItem">CAgnEntry</code></a>, because their type is unknown at this stage. </p>
<ul><li><p>Use <code class="ApiItem">CAgnEntry::Type()</code>, which is implemented by each of the concrete entry classes, to find the type of an entry or an instance which has been read from the model.</p></li>
<li><p>You then have to cast the entry to its proper type in order to use the functions provided by the concrete class for that type. (Functions provided by <code>CAgnEntry</code> can be used without casting the entry.) The functions for casting entries are <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aCastToAppt%28%29" title="Casts an entry or instance to a CAgnAppt* in order to use the functions provided by the CAgnAppt class"><code class="ApiItem">CAgnEntry::CastToAppt()</code></a>, <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aCastToTodo%28%29" title="Casts an entry or instance to a CAgnTodo* in order to use the functions provided by the CAgnTodo class"><code class="ApiItem">CAgnEntry::CastToTodo()</code></a>, <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aCastToEvent%28%29" title="Casts an entry or instance to a CAgnEvent* in order to use the functions provided by the CAgnEvent class"><code class="ApiItem">CAgnEntry::CastToEvent()</code></a>, and <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aCastToAnniv%28%29" title="Casts an entry or instance to a CAgnAnniv* in order to use the functions provided by the CAgnAnniv class"><code class="ApiItem">CAgnEntry::CastToAnniv()</code></a>.</p></li>
</ul><a name="1.5"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Rich text in entries</h2>
</div><div class="Bodytext">
<p>Entries contain text which is typically displayed by the user interface. The Agenda model stores this text as rich text, which means it can contain embedded pictures and other objects such as  Word documents. An entry's rich text can be accessed using <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aRichTextL%28%29" title="Returns a pointer to the rich text owned by the entry"><code class="ApiItem">CAgnEntry::RichTextL()</code></a>, which returns a pointer to a <a href="../../../APIReference/TextAndTextAttributes/CRichTextClass.html#%3a%3aCRichText" title="Text with rich formatting"><code class="ApiItem">CRichText</code></a> object. <code>CRichText</code> provides an API for retrieving and updating the rich text.</p>
<a name="1.6"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Repeating entries</h2>
</div><div class="Bodytext">
<p>To make an entry repeating:</p>
<ul><li><p>create a <a href="../../../APIReference/AgendaEntry/CAgnRptDefClass.html#%3a%3aCAgnRptDef" title="A repeat definition, including exceptions, which is owned by an agenda entry"><code class="ApiItem">CAgnRptDef</code></a> and configure it for the required repeats and any exceptions to the repeats (for example, a particular week in which a weekly-repeating entry should not occur)</p></li>
<li><p>call <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aSetRptDefL%28%29" title="Sets the entry's repeat definition"><code class="ApiItem">CAgnEntry::SetRptDefL()</code></a>, passing the <code>CAgnRptDef</code> as the argument. This sets the <em>repeat details</em> of the entry.</p></li>
</ul><a name="1.6.4"></a></div><div class="Head3">
<hr size="1" noshade>
<h3>Notes</h3>
</div><div class="Bodytext">
<ul><li><p>In the instance model, instances have their date and time fields set for one of the repeats defined in the repeat details. All the repeat details are also present in each instance.</p></li>
<li><p>If you edit one individual instance of a repeating series, a new non-repeating entry is created with its date(s) set to the date(s) of the instance. This new entry has no link to the repeating series of instances to which it once belonged, and in the repeating entry an <em>exception</em> is created corresponding to the date of the edited entry. Therefore, for example, if you cross out one instance of a repeating series, and subsequently uncross it out, you do not get back to where you started.</p></li>
<li><p>If you edit a repeating entry via the entry model (e.g., set its crossed-out status), this will cause all its instances to be modified (e.g. they will all be crossed out).</p></li>
<li><p>The classes <a href="../../../APIReference/AgendaEntry/TAgnDailyRptClass.html#%3a%3aTAgnDailyRpt" title="Daily repeat details -- stores the number of days between repeats"><code class="ApiItem">TAgnDailyRpt</code></a>, <a href="../../../APIReference/AgendaEntry/TAgnWeeklyRptClass.html#%3a%3aTAgnWeeklyRpt" title="Weekly repeat details"><code class="ApiItem">TAgnWeeklyRpt</code></a>, <a href="../../../APIReference/AgendaEntry/TAgnMonthlyRptClass.html#%3a%3aTAgnMonthlyRpt" title="Provides common behaviour shared by the two monthly repeat types TAgnMonthlyByDaysRpt and TAgnMonthlyByDatesRpt"><code class="ApiItem">TAgnMonthlyRpt</code></a>, <a href="../../../APIReference/AgendaEntry/TAgnMonthlyByDaysRptClass.html#%3a%3aTAgnMonthlyByDaysRpt" title="Stores the days in a month on which a repeat can occur, for instance Tuesday in the first week, Sunday in the last week"><code class="ApiItem">TAgnMonthlyByDaysRpt</code></a>, <a href="../../../APIReference/AgendaEntry/TAgnMonthlyByDatesRptClass.html#%3a%3aTAgnMonthlyByDatesRpt" title="Stores the dates in a month on which a repeat can occur"><code class="ApiItem">TAgnMonthlyByDatesRpt</code></a>, <a href="../../../APIReference/AgendaEntry/TAgnYearlyByDateRptClass.html#%3a%3aTAgnYearlyByDateRpt" title="A yearly by date repeat, for example 3rd October each year"><code class="ApiItem">TAgnYearlyByDateRpt</code></a> and <a href="../../../APIReference/AgendaEntry/TAgnYearlyByDayRptClass.html#%3a%3aTAgnYearlyByDayRpt" title="A yearly by day repeat"><code class="ApiItem">TAgnYearlyByDayRpt</code></a> provide utilities for setting up repeat details.</p></li>
</ul><a name="1.7"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Retrieving an entry's category</h2>
</div><div class="Bodytext"><p>To check if an entry has any categories, use <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aHasCategory%28%29" title="Returns a Boolean to indicate whether the entry has any categories"><code class="ApiItem">CAgnEntry::HasCategory()</code></a>. Retrieve the entry's category using <a href="../../../APIReference/AgendaEntry/CAgnEntryClass.html#%3a%3aCAgnEntry%3a%3aFetchCategory%28%29" title="Fetches the category at aIndex"><code class="ApiItem">CAgnEntry::FetchCategory()</code></a>.</p>
</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
