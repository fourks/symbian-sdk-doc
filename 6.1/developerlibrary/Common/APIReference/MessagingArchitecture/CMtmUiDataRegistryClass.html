<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CMtmUiDataRegistry</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CMtmGroupDataClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CMtmUiRegistryClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Messaging&nbsp;Architecture</a>&nbsp;<span class="separator">&#187;</span>
CMtmUiDataRegistry</p>

<hr noshade size="1">
<div class="AuthoredContent">
<p>Location: <code>
mtudreg.h
</code><br>Link against: <code>
mtur.lib
</code></p>
</div><div class="Head1">
<a name="%3a%3aCMtmUiDataRegistry"></a>

<h1>Class <code>CMtmUiDataRegistry</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CMtmUiDataRegistry</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Accesses the UI Data MTM registry. This registry holds details of the all the UI Data MTMs currently available on the system. Message client applications use this class to get a <code>CBaseMtmUiData</code>-derived object by which to access UI Data MTM functionality.</p>
<p>Note that the base class <code>CMtmDllRegistry</code> provides functions for discovering what MTMs are present in the registry.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry">CMtmDllRegistry</a></code></td><td class="Cell">Accesses the various MTM component registries</td>
</tr>
<tr><td class="Cell"><code>CMtmUiDataRegistry</code></td><td class="Cell">Accesses the UI Data MTM registry</td>
</tr>
<tr><td class="Cell"><code><a href="CObserverRegistryClass.html#%3a%3aCObserverRegistry">CObserverRegistry</a></code></td><td class="Cell">An intermediary class used in the derivation of CClientMtmRegistry, CMtmUiDataRegistry and CMtmUiRegistry</td>
</tr>
<tr><td class="Cell"><code><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver">MMsvSessionObserver</a></code></td><td class="Cell">Provides the interface for notification of events from a Message Server session</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CMtmUiDataRegistry</code>:
<br><code class="ApiItem"><a href="CMtmUiDataRegistryClass.html#%3a%3aCMtmUiDataRegistry%3a%3aNewL%28%29" title="Gets a CMtmUiDataRegistry object">NewL()</a></code>, <code class="ApiItem"><a href="CMtmUiDataRegistryClass.html#%3a%3aCMtmUiDataRegistry%3a%3aNewMtmUiDataLayerL%28%29" title="Creates a UI Data MTM object for the MTM specified by aMtmTypeUid">NewMtmUiDataLayerL()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry" title="Accesses the various MTM component registries">CMtmDllRegistry</a></code>:
<br><code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aIsInUse%28%29" title="Tests if the MTM with the specified UID is in use">IsInUse()</a></code>,
<code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aIsPresent%28%29" title="Tests if the MTM with the specified UID is registered">IsPresent()</a></code>,
<code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aMtmTypeUid%28%29" title="Gets the MTM UID of a registered MTM using its index">MtmTypeUid()</a></code>,
<code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aNumRegisteredMtmDlls%28%29" title="Gets the number of registered MTMs">NumRegisteredMtmDlls()</a></code>,
<code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aRegisteredMtmDllInfo%28%29" title="Gets the registration data for the specified MTM">RegisteredMtmDllInfo()</a></code>,
<code class="ApiItem"><a href="CMtmDllRegistryClass.html#%3a%3aCMtmDllRegistry%3a%3aTechnologyTypeUid%28%29" title="Gets the technology type UID for the specified MTM">TechnologyTypeUid()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver" title="Provides the interface for notification of events from a Message Server session">MMsvSessionObserver</a></code>:
<br><code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCloseSession" title="The client should immediately close the session with the Message Server">EMsvCloseSession</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCorruptedIndexRebuilding" title="The Message Server has started to rebuild its index after it has been corrupted">EMsvCorruptedIndexRebuilding</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCorruptedIndexRebuilt" title="The Message Server index had been corrupted and had to be rebuilt">EMsvCorruptedIndexRebuilt</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvGeneralError" title="Something has happening in the server, but this client was unable to retrieve the information">EMsvGeneralError</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaAvailable" title="The disk containing the Message Store is available again">EMsvMediaAvailable</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaChanged" title="The Message Server has automatically changed the index location to use the internal disk">EMsvMediaChanged</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaIncorrect" title="An incorrect disk is inserted">EMsvMediaIncorrect</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaUnavailable" title="The media (disk) containing the Message Server index has been removed">EMsvMediaUnavailable</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMtmGroupDeInstalled" title="A MTM has been uninstalled">EMsvMtmGroupDeInstalled</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMtmGroupInstalled" title="A new MTM has been installed">EMsvMtmGroupInstalled</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerFailedToStart" title="Received after a client has used CMsvSession::OpenAsyncL() to create a session">EMsvServerFailedToStart</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerReady" title="Received after a client has used CMsvSession::OpenAsyncL() to create a session">EMsvServerReady</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerTerminated" title="The Message Server has been terminated">EMsvServerTerminated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreCommitted" title="A CMsvStore has been committed">EMsvStoreCommitted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreCreated" title="An entry has just created a store">EMsvStoreCreated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreDeleted" title="A CMsvStore has been deleted">EMsvStoreDeleted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesChanged" title="One or more index entries have been changed">EmsvEntriesChanged</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesDeleted" title="One or more entries have been deleted">EmsvEntriesDeleted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesMoved" title="One or more entries have been moved">EmsvEntriesMoved</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntryCreated" title="One or more entries have been created">EmsvEntryCreated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aHandleSessionEvent%28%29" title="Indicates an event has occurred--non leaving">HandleSessionEvent()</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aHandleSessionEventL%28%29" title="Indicates an event has occurred--leaving">HandleSessionEventL()</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aTMsvSessionEvent" title="Session event type">TMsvSessionEvent</a></code></p>
<a name="2.6"></a></div><div class="Head2">
<hr size="2" noshade>
<h2>Construct and allocate</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCMtmUiDataRegistry%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CMtmUiDataRegistry* NewL(CMsvSession&amp; aMsvSession, TTimeIntervalMicroSeconds32 aTimeoutMicroSeconds32=TTimeIntervalMicroSeconds32(30000000));</code></p><h4 class="subheading">Description</h4>
<p>Gets a <code>CMtmUiDataRegistry</code> object. The client should delete this object when it is no longer required.</p>
<p>The registry keeps a reference count of the number of instances of each MTM in use. When that reference count falls to zero, the DLL that provides the MTM is unloaded. However, this is not done immediately, but only after the time specified in <code>aTimeoutMicroSeconds32</code>. This increases efficiency in cases where the DLL is required again shortly.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CMsvSession&amp; aMsvSession
</code></td>
<td class="Cell"><p class="ValueDesc">
The client&#8217;s Message Server session
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
TTimeIntervalMicroSeconds32 aTimeoutMicroSeconds32=TTimeIntervalMicroSeconds32(30000000)
</code></td>
<td class="Cell"><p class="ValueDesc">
Time to wait before unloading MTM DLLs
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CMtmUiDataRegistry*
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to a newly allocated and initialised object
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
KErrNoMemory
</code></td>
<td class="Cell"><p class="ValueDesc">
A memory allocation failed
</p></td>
</tr>
</table></td></tr></table>
<a name="2.7"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Create UI Data MTM object</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCMtmUiDataRegistry%3a%3aNewMtmUiDataLayerL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewMtmUiDataLayerL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CBaseMtmUiData* NewMtmUiDataLayerL(TUid aMtmTypeUid);</code></p><h4 class="subheading">Description</h4>
<p>Creates a UI Data MTM object for the MTM specified by <code>aMtmTypeUid</code>.</p>
<p>The client should delete the returned object when it is no longer required.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
TUid aMtmTypeUid
</code></td>
<td class="Cell"><p class="ValueDesc">
UID of MTM to obtain
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CBaseMtmUiData*
</code></td>
<td class="Cell"><p class="ValueDesc">
UI Data MTM object for specified MTM
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
KErrNotFound
</code></td>
<td class="Cell"><p class="ValueDesc">
<code>aMtmTypeUid</code> does not specify a registered MTM
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
KErrNoMemory
</code></td>
<td class="Cell"><p class="ValueDesc">
A memory allocation failed
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
KErrBadLibraryEntryPoint
</code></td>
<td class="Cell"><p class="ValueDesc">
Malformed MTM: a library entry point was not of the required type
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
DLL loading error codes
</code></td>
<td class="Cell"><p class="ValueDesc">
The DLL that provides the MTM cannot be loaded
</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
