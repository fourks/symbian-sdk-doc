<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CSendAs</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CRegisteredMtmDllClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="MessageServerClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Messaging&nbsp;Architecture</a>&nbsp;<span class="separator">&#187;</span>
CSendAs</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> sendas.h </code>
<br>Link against: <code> send.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aCSendAs"></a>

<h1>Class <code>CSendAs</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CSendAs</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Encapsulates the Send-As functionality provided by the Messaging
Architecture. </p>
<p>It allows applications simply to package data into outgoing
messages without using directly the MTM interfaces. </p>
<p>The class is failure-safe in that if it gets deleted before the
client application commits the message, the message is abandoned rather than
saved in a potentially indeterminate state, which could later cause problems in
the Message Server.</p>
<p>If the MTM requires the data to be rendered (i.e. printed), then,
when saving the message, the <code>CSendAs</code> class calls back to the
application using the mixin observer, and give the UID of the printer driver to
use and the filename the printer should produce.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive">CActive</a></code></td><td class="Cell">The core class of the active object abstraction</td>
</tr>
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CSendAs</code></td><td class="Cell">Encapsulates the Send-As functionality provided by the Messaging Architecture</td>
</tr>
<tr><td class="Cell"><code><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver">MMsvSessionObserver</a></code></td><td class="Cell">Provides the interface for notification of events from a Message Server session</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CSendAs</code>:
<br><code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aAbandonMessageL%28%29" title="Deletes a message in progress and any attachments from the Message Server">AbandonMessageL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aAddMtmCapabilityL%28%29" title="Adds a capability requirement">AddMtmCapabilityL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aAddRecipientL%28%29" title="Adds a recipient to the message">AddRecipientL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aAvailableMtms%28%29" title="Gets an array of MTMs that satisfy the current capability requirements">AvailableMtms()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aAvailableServices%28%29" title="Gets a list of the available services">AvailableServices()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aClientMtm%28%29" title="Gets direct access to the class providing protocol-specific messaging functionality (a client MTM)">ClientMtm()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aClientRegistry%28%29" title="Gets direct access to Messaging's client registry">ClientRegistry()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aCreateAttachmentL%28%29" title="Creates an entry for an attachment in the Message Server index">CreateAttachmentL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aCreateMessageL%28%29" title="Creates a new message, specifying the location in which to store it">CreateMessageL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aDeleteAttachmentL%28%29" title="Deletes an attachment from the message">DeleteAttachmentL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aNewL%28%29" title="Allocates and constructs a Send-As object">NewL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aQueryMessageCapability%28%29" title="Tests if the chosen MTM message supports a capability">QueryMessageCapability()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aRecipientList%28%29" title="Gets a list of recipients after they have been added to the message">RecipientList()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aRemoveRecipient%28%29" title="Removes a recipient from the message">RemoveRecipient()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aResetMtmCapabilitiesL%28%29" title="Resets all capability requirements">ResetMtmCapabilitiesL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSaveMessageL%28%29" title="Commits the current message to the Message Server">SaveMessageL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetAttachmentL%28%29" title="Makes an attachment added by CreateAttachmentL() visible in the user interface of an e-mail application">SetAttachmentL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetBioTypeL%28%29" title="Sets the BIO type for the message">SetBioTypeL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetBodyL%28%29" title="Sets the body of the new message">SetBodyL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetMtmL%28%29" title="Sets which MTM to use to create the message by specifying a known MTM UID">SetMtmL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetService%28%29" title="Sets the service to use for the message">SetService()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aSetSubjectL%28%29" title="Sets the subject of the current message">SetSubjectL()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3aValidateMessage%28%29" title="Checks that the message is correctly formatted for the chosen message type">ValidateMessage()</a></code>, <code class="ApiItem"><a href="CSendAsClass.html#%3a%3aCSendAs%3a%3a%7eCSendAs%28%29" title="Destructor">~CSendAs()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive" title="The core class of the active object abstraction">CActive</a></code>:
<br><code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aCancel%28%29" title="Cancels the wait for completion of an outstanding request">Cancel()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aDeque%28%29" title="Removes the active object from the active scheduler's list of active objects">Deque()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aDoCancel%28%29" title="Implements cancellation of an outstanding request">DoCancel()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aEPriorityHigh" title="A priority higher than EPriorityUserInput">EPriorityHigh</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aEPriorityIdle" title="A low priority, useful for active objects representing background processing">EPriorityIdle</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aEPriorityLow" title="A priority higher than EPriorityIdle but lower thanEPriorityStandard">EPriorityLow</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aEPriorityStandard" title="Most active objects will have this priority">EPriorityStandard</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aEPriorityUserInput" title="A priority higher than EPriorityStandard; useful for active objects handling user input">EPriorityUserInput</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aIsActive%28%29" title="Determines whether the active object has a request outstanding">IsActive()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aIsAdded%28%29" title="Determines whether the active object has been added to the active scheduler's list of active objects">IsAdded()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aPriority%28%29" title="Returns the priority of the active object">Priority()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aRunError%28%29" title="Handles a leave occurring in the request completion event handlerRunL()">RunError()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aRunL%28%29" title="Handles an active object's request completion event">RunL()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aSetActive%28%29" title="Indicates that the active object has issued a request and that it is now outstanding">SetActive()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aSetPriority%28%29" title="Sets the priority of the active object">SetPriority()</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aTPriority" title="Defines standard priorities for active objects">TPriority</a></code>,
<code class="ApiItem"><a href="../AsynchronousServices/CActiveClass.html#%3a%3aCActive%3a%3aiStatus" title="The request status associated with an asynchronous request">iStatus</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver" title="Provides the interface for notification of events from a Message Server session">MMsvSessionObserver</a></code>:
<br><code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCloseSession" title="The client should immediately close the session with the Message Server">EMsvCloseSession</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCorruptedIndexRebuilding" title="The Message Server has started to rebuild its index after it has been corrupted">EMsvCorruptedIndexRebuilding</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvCorruptedIndexRebuilt" title="The Message Server index had been corrupted and had to be rebuilt">EMsvCorruptedIndexRebuilt</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvGeneralError" title="Something has happening in the server, but this client was unable to retrieve the information">EMsvGeneralError</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaAvailable" title="The disk containing the Message Store is available again">EMsvMediaAvailable</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaChanged" title="The Message Server has automatically changed the index location to use the internal disk">EMsvMediaChanged</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaIncorrect" title="An incorrect disk is inserted">EMsvMediaIncorrect</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMediaUnavailable" title="The media (disk) containing the Message Server index has been removed">EMsvMediaUnavailable</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMtmGroupDeInstalled" title="A MTM has been uninstalled">EMsvMtmGroupDeInstalled</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvMtmGroupInstalled" title="A new MTM has been installed">EMsvMtmGroupInstalled</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerFailedToStart" title="Received after a client has used CMsvSession::OpenAsyncL() to create a session">EMsvServerFailedToStart</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerReady" title="Received after a client has used CMsvSession::OpenAsyncL() to create a session">EMsvServerReady</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvServerTerminated" title="The Message Server has been terminated">EMsvServerTerminated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreCommitted" title="A CMsvStore has been committed">EMsvStoreCommitted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreCreated" title="An entry has just created a store">EMsvStoreCreated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEMsvStoreDeleted" title="A CMsvStore has been deleted">EMsvStoreDeleted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesChanged" title="One or more index entries have been changed">EmsvEntriesChanged</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesDeleted" title="One or more entries have been deleted">EmsvEntriesDeleted</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntriesMoved" title="One or more entries have been moved">EmsvEntriesMoved</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aEmsvEntryCreated" title="One or more entries have been created">EmsvEntryCreated</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aHandleSessionEvent%28%29" title="Indicates an event has occurred--non leaving">HandleSessionEvent()</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aHandleSessionEventL%28%29" title="Indicates an event has occurred--leaving">HandleSessionEventL()</a></code>,
<code class="ApiItem"><a href="MMsvSessionObserverClass.html#%3a%3aMMsvSessionObserver%3a%3aTMsvSessionEvent" title="Session event type">TMsvSessionEvent</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MessagingPanics.guide.html#Messaging%2epanic%2esend%2eposter5" title="Messaging panics / Post-ER5 panics / SEND panics">Messaging panics for SendAs</a></li>
</ul>
<a name="2.7"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Constructors and destructors</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CSendAs* NewL(MSendAsObserver&amp; aObserver);</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a Send-As object. </p>
<p>It returns a pointer to an instance of a <code>CSendAs</code>
object. The Send-As object creates a session against the Message Server and can
access the client-side MTM registry. The call returns immediately since any
initialisation occurs asynchronously.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> MSendAsObserver&amp; aObserver </code></td>
<td class="Cell"><p class="ValueDesc"> An abstract interface implemented by the client. MTM
capability queries may call back this interface </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CSendAs* </code></td>
<td class="Cell"><p class="ValueDesc"> New session object if successful </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3a%7eCSendAs%28%29"></a>
<hr size="1" noshade>
<h3><code>~CSendAs()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CSendAs();</code></p><h4 class="subheading">Description</h4>
<p>Destructor.</p>
<p>Causes any current message to be abandoned.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Selection of MTMs and services</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAvailableMtms%28%29"></a>
<hr size="1" noshade>
<h3><code>AvailableMtms()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>const CDesCArray&amp; AvailableMtms() const</code></p><h4 class="subheading">Description</h4>
<p>Gets an array of MTMs that satisfy the current capability
requirements. </p>
<p>The array could change after every call to
<code>AddRequiredCapabilityL()</code> and <code>ResetCapabilitiesL()</code>.
The array never contains MTMs that do not have the capability to send
messages.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CDesCArray&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> The array of the human-readable names of the MTMs that satisfy
the current required capabilities </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAddMtmCapabilityL%28%29"></a>
<hr size="1" noshade>
<h3><code>AddMtmCapabilityL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AddMtmCapabilityL(TUid aCapabilityId, TBool aResponseExpected=EFalse)</code></p><h4 class="subheading">Description</h4>
<p>Adds a capability requirement. </p>
<p>All MTMs that do not have this capability are removed from the
current array of available MTMs, initialised by <code>AvailableMtms()</code>.
This allows the client to filter out any unsuitable MTMs before presenting a
list to the user. A client can make repeated calls to
<code>AvailableMtms()</code> to specify different criteria.</p>
<p>Some clients may wish to perform additional checking of a
capability response, which they can do by setting
<code>aResponseExpected</code> to <code>ETrue</code>. This causes the function
to call back the client&#8217;s <code>MSendAsObserver::CapabilityOK()</code>
function, which can evaluates the capability further. For example, if the
<code>KUidMtmQueryMaxBodySize</code> capability (maximum message body size) is
specified, and <code>aResponseExpected</code> is <code>ETrue</code>, the
function calls back <code>MSendAsObserver::CapabilityOK()</code> with the
maximum message body size. That function can then check if the maximum size is
large enough&#0160;&#8212;  returning <code>ETrue</code> if it is.
<code>AddMtmCapabilityL()</code> then checks this return value: if it is not
<code>ETrue</code>, then the MTM is removed from the available MTM
array.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUid aCapabilityId </code></td>
<td class="Cell"><p class="ValueDesc"> The UID of the required capability </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool aResponseExpected=EFalse </code></td>
<td class="Cell"><p class="ValueDesc"> Set to <code>ETrue</code> if the capability returns a response
that needs to be checked by the client </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function calls <code>CBaseMtm::QueryCapability()</code>
on the available MTMs. It leaves if that function does not return
<code>KErrNone</code> or KErrNotSupported. The array of MTM names is unchanged.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="ConstantsGeneralCapabilities.html#Messaging%2ecapabilities%2egeneral">Capability constants: general</a></li>
<li><a href="ConstantsUICapabilities.html#Messaging%2eCapabilityIDsUI%2euids">Capability constants: UI and UI Data</a></li>
</ul>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aResetMtmCapabilitiesL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResetMtmCapabilitiesL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResetMtmCapabilitiesL();</code></p><h4 class="subheading">Description</h4>
<p>Resets all capability requirements. </p>
<p>The MTM array then contains all the installed MTMs that can
send messages.</p>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNoMemory </code></td>
<td class="Cell"><p class="ValueDesc"> A memory allocation failed. The MTM array is unchanged </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.5"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetMtmL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetMtmL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetMtmL(TInt aMtmIndex);</code></p><h4 class="subheading">Description</h4>
<p>Sets which MTM to use to create the message by referencing the
available MTM array.</p>
<p>If the function leaves, then the MTM array is unchanged and a
message cannot be created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aMtmIndex </code></td>
<td class="Cell"><p class="ValueDesc"> The index into the available MTM array indicating which MTM to
use to create the message. The function panics if an MTM has not been set.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> The specified MTM was not available </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNoMemory </code></td>
<td class="Cell"><p class="ValueDesc"> A memory allocation failed </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.6"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetMtmL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetMtmL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetMtmL(TUid aMtmUid);</code></p><h4 class="subheading">Description</h4>
<p>Sets which MTM to use to create the message by specifying a
known MTM UID. </p>
<p>If the function leaves, then the MTM array is unchanged and a
message cannot be created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUid aMtmUid </code></td>
<td class="Cell"><p class="ValueDesc"> The UID of the MTM to use to create the message </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> The specified MTM was not available </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNoMemory </code></td>
<td class="Cell"><p class="ValueDesc"> A memory allocation failed </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="ConstantsMTMtypes.guide.html#Messaging%2etypeUIDs" title="MTM type UID constants">Messaging type UIDs</a></li>
</ul>
<a name="2.8.7"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAvailableServices%28%29"></a>
<hr size="1" noshade>
<h3><code>AvailableServices()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>const CDesCArray&amp; AvailableServices() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets a list of the available services. </p>
<p>It panics if an MTM has not been set.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CDesCArray&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> The list of the names of services that can be used by the
chosen MTM type </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.8"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetService%28%29"></a>
<hr size="1" noshade>
<h3><code>SetService()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetService(TInt aServiceIndex);</code></p><h4 class="subheading">Description</h4>
<p>Sets the service to use for the message. </p>
<p>The function panics if the index is out of range or an MTM has
not been set.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aServiceIndex </code></td>
<td class="Cell"><p class="ValueDesc"> The index into the service list for the service to use </p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Message management</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aCreateMessageL%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateMessageL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CreateMessageL();</code></p><h4 class="subheading">Description</h4>
<p>Creates a new message. </p>
<p>The message is created by default in the Draft folder.</p>
<p>An MTM must have been set before calling this function. It
panics if an MTM has not been set or a message has already been created.</p>
<p>If the function leaves, then the internal state of the
<code>CSendAs</code> instance is unchanged.</p>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> No suitable service exists, or the MTM is not available
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> Other leaves </code></td>
<td class="Cell"><p class="ValueDesc"> Error propagated from Message Server </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aCreateMessageL%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateMessageL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CreateMessageL(TMsvId aId);</code></p><h4 class="subheading">Description</h4>
<p>Creates a new message, specifying the location in which to
store it.</p>
<p>An MTM must have been set before calling this function. It
panics if an MTM has not been set or a message has already been created.</p>
<p>If the function leaves, then the internal state of the
<code>CSendAs</code> instance is unchanged.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TMsvId aId</code></td>
<td class="Cell"><p class="ValueDesc">The ID of the location in which to store the message entry. See
<a href="ConstantsPredefinedEntryIDs.html#Messaging%2eentryIDs%2econstants">Predefined entry IDs</a>.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> No suitable service exists, or the MTM is not available
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> Other leaves </code></td>
<td class="Cell"><p class="ValueDesc"> Error propagated from Message Server </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAbandonMessageL%28%29"></a>
<hr size="1" noshade>
<h3><code>AbandonMessageL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AbandonMessageL();</code></p><h4 class="subheading">Description</h4>
<p>Deletes a message in progress and any attachments from the
Message Server. </p>
<p>If an MTM object has been selected, then it the selection is
cancelled. It panics if the message has already been saved.</p>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> Message Server could not delete the message </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.5"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSaveMessageL%28%29"></a>
<hr size="1" noshade>
<h3><code>SaveMessageL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SaveMessageL(TBool aMakeVisible=ETrue);<br>void SaveMessageL(TRequestStatus&amp; aStatus, TBool aMakeVisible=ETrue);</code></p><h4 class="subheading">Description</h4>
<p>Commits the current message to the Message Server. </p>
<p>When the <code>CSendAs</code> object is deleted by the client
application, it issues an <code>AbandonMessage()</code> call on itself&#0160;&#8212;
so to ensure that a message is sent, a client application must invoke this
function before closing the Send-As API. It panics if no message has been
created.</p>
<p>When the message requires rendering (e.g. fax), some
applications might use the asynchronous version.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion object </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool aMakeVisible </code></td>
<td class="Cell"><p class="ValueDesc"> Determines whether the message should be visible in the
Outbox. Defaults to true. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function can leave if rendering is required, and either
an error occurs in requesting the MTM for the printer to use for rendering, or
in <code>MMsvSendAsObserver::RenderImage()</code> . The message is left in the
same state as it was before the call. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Recipient management</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aRecipientList%28%29"></a>
<hr size="1" noshade>
<h3><code>RecipientList()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>const CDesCArray&amp; RecipientList() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets a list of recipients after they have been added to the
message. </p>
<p>It panics if no message has been created.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CDesCArray&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> A text array that lists all the recipients that have been
added </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAddRecipientL%28%29"></a>
<hr size="1" noshade>
<h3><code>AddRecipientL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AddRecipientL(const TDesC&amp; aRealAddress);</code></p><h4 class="subheading">Description</h4>
<p>Adds a recipient to the message. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aRealAddress </code></td>
<td class="Cell"><p class="ValueDesc"> The address of the recipient </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CBaseMtm::AddAddresseeL()</code> . The recipient is not added to the
message. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.4"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aAddRecipientL%28%29"></a>
<hr size="1" noshade>
<h3><code>AddRecipientL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt AddRecipientL(const TDesC&amp; aRealAddress, const TDesC&amp; aAlias);</code></p><h4 class="subheading">Description</h4>
<p>Adds a recipient to the message. </p>
<p>Both the true address and the name or alias are specified
(e.g., &#8220;an-other@somewhere.co.uk&#8221; and &#8220;A.N.
Other&#8221;).</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aRealAddress </code></td>
<td class="Cell"><p class="ValueDesc"> The address of the recipient </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aAlias </code></td>
<td class="Cell"><p class="ValueDesc"> The name or alias of the recipient rather than the actual
destination </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CBaseMtm::AddAddresseeL()</code> . The recipient is not added to the
message. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.5"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aRemoveRecipient%28%29"></a>
<hr size="1" noshade>
<h3><code>RemoveRecipient()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RemoveRecipient(TInt aIndex);</code></p><h4 class="subheading">Description</h4>
<p>Removes a recipient from the message. </p>
<p>It panics if no message has been created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aIndex </code></td>
<td class="Cell"><p class="ValueDesc"> The index of the recipient array to be removed </p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Contents management</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetSubjectL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetSubjectL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetSubjectL(const TDesC&amp; aSubject);</code></p><h4 class="subheading">Description</h4>
<p>Sets the subject of the current message. </p>
<p>It panics if no message has been created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSubject </code></td>
<td class="Cell"><p class="ValueDesc"> Descriptor containing the subject line for the message </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CBaseMtm::SetSubjectL()</code> . <code>KErrNotSupported</code> indicates
that the MTM does not support a subject field. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetBodyL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetBodyL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetBodyL(const CRichText&amp; aMessageBody);</code></p><h4 class="subheading">Description</h4>
<p>Sets the body of the new message. </p>
<p>The outgoing message may legally be left with an empty body if
the client application cannot provide the contents of its document as a
<code>CRichText</code> object. Alternatively, the client application may wish
to define a default message body, and create an attachment for the document
being sent. It panics if no message has been created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const CRichText&amp; aMessageBody </code></td>
<td class="Cell"><p class="ValueDesc"> Message body text </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CRichText::InsertL()</code> . </p></td>
</tr>
</table></td></tr></table>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Message validity and capability</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aValidateMessage%28%29"></a>
<hr size="1" noshade>
<h3><code>ValidateMessage()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TMsvPartList ValidateMessage();</code></p><h4 class="subheading">Description</h4>
<p>Checks that the message is correctly formatted for the chosen
message type. </p>
<p>In particular, the client application is able to determine
whether the recipient list is valid within the addressing syntax of the message
type. Any defective part or parts are identified by the return value.</p>
<p>The call panics if no message has been created.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TMsvPartList </code></td>
<td class="Cell"><p class="ValueDesc"> 0: message is valid Non-zero: bitmask identifying defective
part or parts </p></td>
</tr>
</table></td></tr></table>
<a name="2.12.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aQueryMessageCapability%28%29"></a>
<hr size="1" noshade>
<h3><code>QueryMessageCapability()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt QueryMessageCapability(TUid aCapabilityId, TBool aResponseExpected=EFalse);</code></p><h4 class="subheading">Description</h4>
<p>Tests if the chosen MTM message supports a capability. </p>
<p>If <code>aResponseExpected</code> is <code>ETrue</code>, then
the function call backs the client&#8217;s
<code>MSendAsObserver::CapabilityOK()</code> that can evaluate the capability
further.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUid aCapabilityId </code></td>
<td class="Cell"><p class="ValueDesc"> The UID of the capability to check </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool aResponseExpected=EFalse </code></td>
<td class="Cell"><p class="ValueDesc">
<code>ETrue</code> if the capability returns a value that
needs to be checked by the client </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNone </code></td>
<td class="Cell"><p class="ValueDesc"> The capability is supported </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotSupported </code></td>
<td class="Cell"><p class="ValueDesc"> The capability is not supported </p></td>
</tr>
</table></td></tr></table>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Attachment management</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aCreateAttachmentL%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateAttachmentL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CreateAttachmentL(TMsvId&amp; aAttachmentId, TFileName&amp; aDirectory);</code></p><h4 class="subheading">Description</h4>
<p>Creates an entry for an attachment in the Message Server index.
</p>
<p>Once an entry has been created, the client application can save
the attachment file in the directory whose name is returned. It panics if no
message has been created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TMsvId&amp; aAttachmentId </code></td>
<td class="Cell"><p class="ValueDesc"> On return, the Message Server index ID of the attachment
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TFileName&amp; aDirectory </code></td>
<td class="Cell"><p class="ValueDesc"> On return, the directory in which to save the attachment
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CMsvEntry::CreateL()</code> and <code>CMsvEntry::SetEntryL()</code> .
<code>KErrNotSupported</code> indicates that the MTM does not support
attachments. The <code>CSendAs</code> instance &#8217; s state is unchanged.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBaseMtmClass.html#%3a%3aCBaseMtm%3a%3aCreateAttachmentL%28%29" title="Creates an entry for an attachment in the Message Server index"><code class="ApiItem">CBaseMtm::CreateAttachmentL()</code></a></li>
</ul>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aDeleteAttachmentL%28%29"></a>
<hr size="1" noshade>
<h3><code>DeleteAttachmentL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void DeleteAttachmentL(TMsvId aAttachmentId);</code></p><h4 class="subheading">Description</h4>
<p>Deletes an attachment from the message. </p>
<p>The attachment directory and any files in it are also deleted.
It panics if no message has been created.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TMsvId aAttachmentId </code></td>
<td class="Cell"><p class="ValueDesc"> Identifies the attachment to be deleted </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">Leaves can be propagated from
<code>CMsvEntry::DeleteL()</code> . The attachment is not deleted. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBaseMtmClass.html#%3a%3aCBaseMtm%3a%3aDeleteAttachmentL%28%29" title="Deletes an attachment from the message"><code class="ApiItem">CBaseMtm::DeleteAttachmentL()</code></a></li>
</ul>
<a name="2.13.4"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetAttachmentL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetAttachmentL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetAttachmentL(TMsvId aAttachmentId, const TDesC&amp; aAttachmentName);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.1
</p><h4 class="subheading">Description</h4>
<p>Makes an attachment added by <code>CreateAttachmentL()</code>
visible in the user interface of an e-mail application. By default, attachments
are not be shown.</p>
<p>The function can be called before or after
<code>SaveMessageL()</code>, but will be more efficient if called
before.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TMsvId aAttachmentId </code></td>
<td class="Cell"><p class="ValueDesc"> The ID of the attachment, as obtained from
<code>CreateAttachmentL()</code>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aAttachmentName </code></td>
<td class="Cell"><p class="ValueDesc"> The name the e-mail application should give the attachment
</p></td>
</tr>
</table></td></tr></table>
<a name="2.14"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Advanced Messaging Architecture access</h2>
</div><div class="Bodytext">
<a name="2.14.2"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aClientRegistry%28%29"></a>
<hr size="1" noshade>
<h3><code>ClientRegistry()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CClientMtmRegistry&amp; ClientRegistry();</code></p><h4 class="subheading">Description</h4>
<p>Gets direct access to Messaging&#8217;s client registry.
</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CClientMtmRegistry&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> Client registry object </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.3"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aClientMtm%28%29"></a>
<hr size="1" noshade>
<h3><code>ClientMtm()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CBaseMTM&amp; ClientMtm();</code></p><h4 class="subheading">Description</h4>
<p>Gets direct access to the class providing protocol-specific
messaging functionality (a client MTM). </p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CBaseMTM&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> Client-side MTM object </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.4"></a></div><div class="Head3">
<a name="%3a%3aCSendAs%3a%3aSetBioTypeL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetBioTypeL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetBioTypeL(TUid aBioTypeUid);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Sets the BIO type for the message.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TUid aBioTypeUid</code></td>
<td class="Cell"><p class="ValueDesc">BIO message type</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
