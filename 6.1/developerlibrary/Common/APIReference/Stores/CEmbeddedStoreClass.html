<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CEmbeddedStore</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CDictionaryStoreClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CPersistentStoreClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Stores</a>&nbsp;<span class="separator">&#187;</span>
CEmbeddedStore</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>s32stor.h</code>
<br>Link against: <code>estor.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCEmbeddedStore"></a>

<h1>Class <code>CEmbeddedStore</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CEmbeddedStore</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Encapsulates an embedded store. </p>
<p>The embedded store may contain an arbitrarily complex network of
streams, but is viewed as simply another stream by the embedding store. This
means that the embedded store can dealt with as a single stream for purposes of
copying or deleting.</p>
<p>Once streams within the embedded store have been committed and
closed, they cannot subsequently be changed, i.e. streams cannot be replaced,
deleted, extended or changed in any way. </p><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CEmbeddedStore</code></td><td class="Cell">Encapsulates an embedded store</td>
</tr>
<tr><td class="Cell"><code><a href="CPersistentStoreClass.html#%3a%3aCPersistentStore">CPersistentStore</a></code></td><td class="Cell">Persistent store abstract base class</td>
</tr>
<tr><td class="Cell"><code><a href="CStreamStoreClass.html#%3a%3aCStreamStore">CStreamStore</a></code></td><td class="Cell">Provides the core abstract framework for stores allowing streams to be created and manipulated</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CEmbeddedStore</code>:
<br><code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aDetach%28%29" title="Gives up ownership of the host stream buffer">Detach()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aFromL%28%29" title="Opens the store hosted by the specified stream">FromL()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aFromLC%28%29" title="Open the store hosted by the specified stream, putting a pointer to the store onto the cleanup stack">FromLC()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aHost%28%29" title="Returns a pointer to the stream buffer which is acting as host to this embedded store">Host()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aNewL%28%29" title="Creates an embedded store within the specified host stream">NewL()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aNewLC%28%29" title="Creates an embedded store within the specified host stream, putting a pointer to the store onto the cleanup stack">NewLC()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aPosition%28%29" title="Returns the position of the specified stream, within the host stream">Position()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aReattach%28%29" title="Takes ownership of the specified stream buffer">Reattach()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3aStart%28%29" title="Returns the start position of this embedded store within the host stream">Start()</a></code>, <code class="ApiItem"><a href="CEmbeddedStoreClass.html#%3a%3aCEmbeddedStore%3a%3a%7eCEmbeddedStore%28%29" title="Frees resources owned by the object, prior to its destruction">~CEmbeddedStore()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="CPersistentStoreClass.html#%3a%3aCPersistentStore" title="Persistent store abstract base class">CPersistentStore</a></code>:
<br><code class="ApiItem"><a href="CPersistentStoreClass.html#%3a%3aCPersistentStore%3a%3aRoot%28%29" title="Returns the stream id of the root stream">Root()</a></code>,
<code class="ApiItem"><a href="CPersistentStoreClass.html#%3a%3aCPersistentStore%3a%3aSetRootL%28%29" title="Sets the specified stream as the root stream">SetRootL()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore" title="Provides the core abstract framework for stores allowing streams to be created and manipulated">CStreamStore</a></code>:
<br><code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommit%28%29" title="Commits changes">Commit()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommitL%28%29" title="Commit changes and leaves if unsuccessful">CommitL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCompactL%28%29" title="Compacts the store">CompactL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDelete%28%29" title="Deletes the specified stream from this store">Delete()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDeleteL%28%29" title="Deletes the specified stream from this store, leaving if unsuccessful">DeleteL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCommitL%28%29" title="Commits any changes to the store">DoCommitL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCompactL%28%29" title="Initialises an object for compacting space in the store">DoCompactL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCreateL%28%29" title="Creates a new stream in the store">DoCreateL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoDeleteL%28%29" title="Deletes the specified stream from the store">DoDeleteL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReadL%28%29" title="Opens the requested stream for reading">DoReadL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReclaimL%28%29" title="Initialises an object for reclaiming space in the store">DoReclaimL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReplaceL%28%29" title="Opens the specified existing stream for safe replacement">DoReplaceL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoRevertL%28%29" title="Discards any pending changes to the store">DoRevertL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoWriteL%28%29" title="Opens the specified existing stream for writing">DoWriteL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aExtendL%28%29" title="Generates a new stream within this store, and returns its id">ExtendL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aReclaimL%28%29" title="Reclaims space within a store, returning the total amount of free space available within that store">ReclaimL()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevert%28%29" title="Rolls back the store to its state at the last commit point">Revert()</a></code>,
<code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful">RevertL()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CPersistentStoreClass.html#%3a%3aCPersistentStore" title="Persistent store abstract base class"><code class="ApiItem">CPersistentStore</code></a></li>
</ul>
<a name="2.7"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CEmbeddedStore* NewL(RWriteStream&amp; aHost);</code></p><h4 class="subheading">Description</h4>
<p>Creates an embedded store within the specified host
stream.</p>
<p>Note that ownership of the stream passes to the store and the
referenced <code>RWriteStream</code> is cleared.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RWriteStream&amp; aHost</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the stream which is to host the embedded
store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CEmbeddedStore*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the embedded store object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aNewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>NewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CEmbeddedStore* NewLC(RWriteStream&amp; aHost);</code></p><h4 class="subheading">Description</h4>
<p>Creates an embedded store within the specified host stream,
putting a pointer to the store onto the cleanup stack.</p>
<p>Putting a pointer to the embedded store object onto the cleanup
stack allows the object and allocated resources to be cleaned up if a
subsequent leave occurs.</p>
<p>Note that ownership of the stream passes to the store and the
referenced <code>RWriteStream</code> is cleared.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RWriteStream&amp; aHost</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the stream which is to host the embedded
store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CEmbeddedStore*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the embedded store object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3a%7eCEmbeddedStore%28%29"></a>
<hr size="1" noshade>
<h3><code>~CEmbeddedStore()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CEmbeddedStore();</code></p><h4 class="subheading">Description</h4>
<p>Frees resources owned by the object, prior to its destruction. In
particular, the destructor closes the associated file.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Open embedded store</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aFromL%28%29"></a>
<hr size="1" noshade>
<h3><code>FromL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CEmbeddedStore* FromL(RReadStream&amp; aHost);</code></p><h4 class="subheading">Description</h4>
<p>Opens the store hosted by the specified stream.</p>
<p>Note that ownership of the stream passes to the store; the referenced
<code>RReadStream</code> is cleared.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RReadStream&amp; aHost</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the stream hosting the embedded store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CEmbeddedStore*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the embedded store object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aFromLC%28%29"></a>
<hr size="1" noshade>
<h3><code>FromLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CEmbeddedStore* FromLC(RReadStream&amp; aHost);</code></p><h4 class="subheading">Description</h4>
<p>Open the store hosted by the specified stream, putting a pointer to the
store onto the cleanup stack.</p>
<p>Putting a pointer to the embedded store object onto the cleanup stack
allows the object and allocated resources to be cleaned up if a subsequent
leave occurs.</p>
<p>Note that ownership of the stream passes to the store and the
referenced <code>RReadStream</code> is cleared.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RReadStream&amp; aHost</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the stream hosting the embedded store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CEmbeddedStore*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the embedded store object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Access the host stream buffer</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aStart%28%29"></a>
<hr size="1" noshade>
<h3><code>Start()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TStreamPos Start() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the start position of this embedded store within the host
stream.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamPos</code></td>
<td class="Cell"><p class="ValueDesc">The position of the this embedded store within the host stream.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aPosition%28%29"></a>
<hr size="1" noshade>
<h3><code>Position()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static TStreamPos Position(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Returns the position of the specified stream, within the host
stream.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The stream id of the stream in the embedded store whose position within
the host stream is to be returned.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamPos</code></td>
<td class="Cell"><p class="ValueDesc">The position of the stream with id <code>anId</code> within the host
stream.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aHost%28%29"></a>
<hr size="1" noshade>
<h3><code>Host()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>MStreamBuf* Host() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns a pointer to the stream buffer which is acting as host to this
embedded store. The embedded store retains ownership of the host stream
buffer.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the stream buffer which is host to this embedded
store.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.5"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aDetach%28%29"></a>
<hr size="1" noshade>
<h3><code>Detach()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Detach();</code></p><h4 class="subheading">Description</h4>
<p>Gives up ownership of the host stream buffer. The caller takes on the
responsibility for discarding the buffer.</p>
<a name="2.9.6"></a></div><div class="Head3">
<a name="%3a%3aCEmbeddedStore%3a%3aReattach%28%29"></a>
<hr size="1" noshade>
<h3><code>Reattach()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Reattach(MStreamBuf* aHost);</code></p><h4 class="subheading">Description</h4>
<p>Takes ownership of the specified stream buffer. On return from this
function, the embedded store assumes this to be the host stream
buffer.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf* aHost</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the stream buffer over which the embedded store is to take
ownership.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
