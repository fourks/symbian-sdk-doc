<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CStreamStore</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CPersistentStoreClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="MIncrementalCollectorClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Stores</a>&nbsp;<span class="separator">&#187;</span>
CStreamStore</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>s32stor.h</code>
<br>Link against: <code>estor.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCStreamStore"></a>

<h1>Class <code>CStreamStore</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CStreamStore</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides the core abstract framework for stores allowing streams to
be created and manipulated.</p><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CStreamStore</code></td><td class="Cell">Provides the core abstract framework for stores allowing streams to be created and manipulated</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CStreamStore</code>:
<br><code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommit%28%29" title="Commits changes">Commit()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommitL%28%29" title="Commit changes and leaves if unsuccessful">CommitL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCompactL%28%29" title="Compacts the store">CompactL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDelete%28%29" title="Deletes the specified stream from this store">Delete()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDeleteL%28%29" title="Deletes the specified stream from this store, leaving if unsuccessful">DeleteL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCommitL%28%29" title="Commits any changes to the store">DoCommitL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCompactL%28%29" title="Initialises an object for compacting space in the store">DoCompactL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCreateL%28%29" title="Creates a new stream in the store">DoCreateL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoDeleteL%28%29" title="Deletes the specified stream from the store">DoDeleteL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoExtendL%28%29" title="Generates a new stream within this store, and returns its id">DoExtendL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReadL%28%29" title="Opens the requested stream for reading">DoReadL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReclaimL%28%29" title="Initialises an object for reclaiming space in the store">DoReclaimL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReplaceL%28%29" title="Opens the specified existing stream for safe replacement">DoReplaceL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoRevertL%28%29" title="Discards any pending changes to the store">DoRevertL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoWriteL%28%29" title="Opens the specified existing stream for writing">DoWriteL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aExtendL%28%29" title="Generates a new stream within this store, and returns its id">ExtendL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aReclaimL%28%29" title="Reclaims space within a store, returning the total amount of free space available within that store">ReclaimL()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevert%28%29" title="Rolls back the store to its state at the last commit point">Revert()</a></code>, <code class="ApiItem"><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful">RevertL()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="UsingCStreamStore.guide.html#StoreStreams%2eusing%2dCStreamStore">Using CStreamStore</a></li>
</ul>
<a name="2.7"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Generating a new stream</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aExtendL%28%29"></a>
<hr size="1" noshade>
<h3><code>ExtendL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TStreamId ExtendL();</code></p><h4 class="subheading">Description</h4>
<p>Generates a new stream within this store, and returns its id.
This function can be used to create a new stream in advance of being written
to.</p>
<p>This function is not supported by the direct file store,
<code>CDirectFileStore</code>.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId</code></td>
<td class="Cell"><p class="ValueDesc">The stream id for the newly generated stream.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">If this function is called on a direct file store, it leaves
with <code>KErrNotSupported</code> . </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CDirectFileStoreClass.html#%3a%3aCDirectFileStore" title="Direct file store"><code class="ApiItem">CDirectFileStore</code></a></li>
</ul>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Deleting an existing stream</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDeleteL%28%29"></a>
<hr size="1" noshade>
<h3><code>DeleteL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void DeleteL(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Deletes the specified stream from this store, leaving if
unsuccessful.</p>
<p>The function is not supported by the direct file store,
<code>CDirectFileStore</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id of the stream to be deleted from this store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">If this function is called on a direct file store, it leaves with
<code>KErrNotSupported</code> . </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CDirectFileStoreClass.html#%3a%3aCDirectFileStore" title="Direct file store"><code class="ApiItem">CDirectFileStore</code></a></li>
</ul>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDelete%28%29"></a>
<hr size="1" noshade>
<h3><code>Delete()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Delete(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Deletes the specified stream from this store.</p>
<p>This function is deprecated.</p><p>If unsuccessful, the function fails silently with no way to return information to the user.</p>
<p>The function is not supported by the direct file store,
<code>CDirectFileStore</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id of the stream to be deleted.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Committing changes to the store</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aCommit%28%29"></a>
<hr size="1" noshade>
<h3><code>Commit()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Commit();</code></p><h4 class="subheading">Description</h4>
<p>Commits changes.</p>
<p>This function establishes a new commit point. Typically, this is done
after changes to new or existing streams are complete and the streams
themselves have been committed.</p>
<p>Establishing a new commit point makes changes to the store permanent.
Until such changes are committed, they can be rolled back or reverted,
effectively causing the store to revert back to its state before the changes
were made.</p>
<p>This ensures that persistent data moves from one consistent state to
another and guarantees the integrity of persistent store data in the event of
failures. In particular, if a process terminates or a media failure occurs, the
store reverts automatically to its state at the last successful commit
point.</p>
<p>Note that this function is not implemented by the direct file store
<code>CDirectFileStore</code> and the non-persistent in-memory store
<code>CBufStore</code>.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNone</code> if successful, otherwise another of the
system-wide error codes.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CDirectFileStoreClass.html#%3a%3aCDirectFileStore" title="Direct file store"><code class="ApiItem">CDirectFileStore</code></a></li>
<li><a href="CBufStoreClass.html#%3a%3aCBufStore" title="In-memory non-persistent store"><code class="ApiItem">CBufStore</code></a></li>
</ul>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aCommitL%28%29"></a>
<hr size="1" noshade>
<h3><code>CommitL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CommitL();</code></p><h4 class="subheading">Description</h4>
<p>Commit changes and leaves if unsuccessful.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommit%28%29" title="Commits changes"><code class="ApiItem">CStreamStore::Commit()</code></a></li>
</ul>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reverting changes</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aRevertL%28%29"></a>
<hr size="1" noshade>
<h3><code>RevertL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RevertL();</code></p><h4 class="subheading">Description</h4>
<p>Rolls back the store to its state at the last commit point and leaves if
unsuccessful.</p>
<p>The function is not supported by the direct file store
<code>CDirectFileStore</code> and the non-persistent in-memory store
<code>CBufStore</code>.</p><h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">If this function is called on a direct file store or a non persistent
in-memory store, it leaves with <code>KErrNotSupported</code>.  The function may also leave if the store is on removable media, and the media is removed before the revert operation can be implemented. The calling code, or parent application, must be able to handle such situations.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CDirectFileStoreClass.html#%3a%3aCDirectFileStore" title="Direct file store"><code class="ApiItem">CDirectFileStore</code></a></li>
<li><a href="CBufStoreClass.html#%3a%3aCBufStore" title="In-memory non-persistent store"><code class="ApiItem">CBufStore</code></a></li>
</ul>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aRevert%28%29"></a>
<hr size="1" noshade>
<h3><code>Revert()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Revert();</code></p><h4 class="subheading">Description</h4>
<p>Rolls back the store to its state at the last commit point. </p>
<p>This function is deprecated; use <a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful"><code class="ApiItem">RevertL()</code></a> instead.</p><p>If unsuccessful, the function fails silently with no way to return information to the user.</p>
<p>The function is not supported by the direct file store
<code>CDirectFileStore</code> and the non-persistent in-memory store
<code>CBufStore</code>.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CDirectFileStoreClass.html#%3a%3aCDirectFileStore" title="Direct file store"><code class="ApiItem">CDirectFileStore</code></a></li>
<li><a href="CBufStoreClass.html#%3a%3aCBufStore" title="In-memory non-persistent store"><code class="ApiItem">CBufStore</code></a></li>
</ul>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reclaiming</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aReclaimL%28%29"></a>
<hr size="1" noshade>
<h3><code>ReclaimL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt ReclaimL();</code></p><h4 class="subheading">Description</h4>
<p>Reclaims space within a store, returning the total amount of free space
available within that store.</p>
<p>The function does not return until the reclamation process is complete.
This can take an extended amount of time.</p>
<p>The function is only supported by the permanent file store,
<code>CPermanentFileStore</code>, but not by other derived classes, e.g.,
<code>CDirectFileStore</code> or <code>CBufStore</code>.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The amount of free space available within the store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">If the function is called on any object other than a permanent file
store, it leaves with <code>KErrNotSupported</code> . </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CPermanentFileStoreClass.html#%3a%3aCPermanentFileStore" title="Permanent file store"><code class="ApiItem">CPermanentFileStore</code></a></li>
</ul>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Compacting</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aCompactL%28%29"></a>
<hr size="1" noshade>
<h3><code>CompactL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt CompactL();</code></p><h4 class="subheading">Description</h4>
<p>Compacts the store. This returns free space to the appropriate system
pool, for example, the filing system in the case of file-based stores.</p>
<p>On completion, the function returns the total amount of free space
available within the store.</p>
<p>The function does not return until the compaction process is complete.
This can take an extended amount of time.</p>
<p>Note:</p>
<ul>
<li>
<p>this function is only supported by the permanent file store,
<code>CPermanentFileStore</code>, and not by <code>CDirectFileStore</code> or
<code>CBufStore</code>.</p>
</li>
<li>
<p>Streams must be closed before calling this function.</p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The amount of free space available within the store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">If the function is called on any object other than a permanent file
store, it leaves with <code>KErrNotSupported</code> . </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileStores/CPermanentFileStoreClass.html#%3a%3aCPermanentFileStore" title="Permanent file store"><code class="ApiItem">CPermanentFileStore</code></a></li>
</ul>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Store framework</h2>
</div><div class="Bodytext"><h4 class="subheading">Description</h4>
<p>These functions are all part of the store framework, and need to be
understood only by those who wish to implement their own classes derived either
from <code>CStreamStore</code> or from <code>CStreamStore</code> derived
classes.</p>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoExtendL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoExtendL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>private: virtual TStreamId DoExtendL();</code></p><h4 class="subheading">Description</h4>
<p>Generates a new stream within this store, and returns its id. This
function is intended to create a new stream in advance of being written
to.</p>
<p>This is called by <code>ExtendL()</code>.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId</code></td>
<td class="Cell"><p class="ValueDesc">The new stream id.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aExtendL%28%29" title="Generates a new stream within this store, and returns its id"><code class="ApiItem">CStreamStore::ExtendL()</code></a></li>
</ul>
<a name="2.13.4"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoDeleteL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoDeleteL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void DoDeleteL(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Deletes the specified stream from the store.</p>
<p>This is called by <code>DeleteL()</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id of the stream to be deleted.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDelete%28%29" title="Deletes the specified stream from this store"><code class="ApiItem">CStreamStore::Delete()</code></a></li>
<li><a href="CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDeleteL%28%29" title="Deletes the specified stream from this store, leaving if unsuccessful"><code class="ApiItem">CStreamStore::DeleteL()</code></a></li>
</ul>
<a name="2.13.5"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoReadL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoReadL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MStreamBuf* DoReadL(TStreamId anId) const=0;</code></p><h4 class="subheading">Description</h4>
<p>Opens the requested stream for reading. The function should return a
stream buffer positioned at the beginning of this stream.</p>
<p>This function is called by the <code>OpenL()</code> and
<code>OpenLC()</code> member functions of
<code>RStoreReadStream</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The stream to be read.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf*</code></td>
<td class="Cell"><p class="ValueDesc">A stream buffer positioned at the beginning of the stream to be
read.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../StoreStreams/RStoreReadStreamClass.html#%3a%3aRStoreReadStream%3a%3aOpenL%28%29" title="Opens and prepares an existing stream for reading"><code class="ApiItem">RStoreReadStream::OpenL()</code></a></li>
<li><a href="../StoreStreams/RStoreReadStreamClass.html#%3a%3aRStoreReadStream%3a%3aOpenLC%28%29" title="Opens and prepares an existing stream for reading, leaving a cleanup item on the cleanup stack"><code class="ApiItem">RStoreReadStream::OpenLC()</code></a></li>
</ul>
<a name="2.13.6"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoCreateL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoCreateL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MStreamBuf* DoCreateL(TStreamId&amp; anId)=0;</code></p><h4 class="subheading">Description</h4>
<p>Creates a new stream in the store. The function gets the allocated stream
id in the <code>anId</code> parameter. A stream buffer for the stream should be
returned, ready to write into the new stream. This provides the implementation
for the <code>RStoreWriteStream::CreateL()</code>
functions.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId&amp; anId</code></td>
<td class="Cell"><p class="ValueDesc">On return, contains the allocated stream id.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf*</code></td>
<td class="Cell"><p class="ValueDesc">The stream buffer to be written to.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.7"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoWriteL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoWriteL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MStreamBuf* DoWriteL(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Opens the specified existing stream for writing. A stream buffer is
returned ready to overwrite the existing stream data. This function provides
the implementation for the <code>RStoreWriteStream::OpenL()</code>
functions.</p>
<p>Note:</p>
<ul>
<li>
<p>The <code>CStreamStore</code> implementation may allow the existing
stream size to be changed as a result of committing the stream, but this is not
required. e.g. <code>CBufStore</code> will change the stream size following
commit, whereas <code>CPermanentFileStore</code> will leave the existing stream
size unaltered. The latter store leaves with <code>KErrEof</code> if it
attempts to write beyond the current end-of-stream with. </p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id stream to open for writing.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf*</code></td>
<td class="Cell"><p class="ValueDesc">The stream write buffer.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotFound</code></td>
<td class="Cell"><p class="ValueDesc">The stream id is not valid in this store.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.8"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoReplaceL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoReplaceL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MStreamBuf* DoReplaceL(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Opens the specified existing stream for safe replacement. A stream buffer
for the new stream data is returned ready for writing the new stream data. This
function provides the implementation for the
<code>RStoreWriteStream::ReplaceL()</code> functions.</p>
<p>Note:</p>
<ul>
<li>
<p>This differs in behaviour from <code>DoWriteL()</code> for stores that
provide atomic update support (such as <code>CPermanentFileStore</code>) as
this guarantees to preserve the original stream data if the store is not
successfully committed after writing the stream. Such a guarantee is not made
for the stream buffer returned by <code>DoWriteL()</code>.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id stream to open for replacement.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MStreamBuf*</code></td>
<td class="Cell"><p class="ValueDesc">The stream write buffer.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.9"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoCommitL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoCommitL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void DoCommitL();</code></p><h4 class="subheading">Description</h4>
<p>Commits any changes to the store. For a store that provides atomic
updates, this writes all of the pending updates to the to the permanent storage
medium. After committing the store contains all or none of the updates since
the last commit/revert.</p>
<p>This function provides the implementation for the public
<code>CommitL()</code> function.</p>
<a name="2.13.10"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoRevertL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoRevertL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void DoRevertL();</code></p><h4 class="subheading">Description</h4>
<p>Discards any pending changes to the store. This includes all changes
which have not been committed to a permanent storage medium. </p>
<p>This function provides the implementation for the public
<code>Revert()</code> function.</p>
<p>Note:</p>
<ul>
<li>
<p>The function need only be implemented by stores that provide atomic
updates, as revert has no meaning for other implementations.</p>
</li>
</ul>
<a name="2.13.11"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoReclaimL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoReclaimL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MIncrementalCollector* DoReclaimL();</code></p><h4 class="subheading">Description</h4>
<p>Initialises an object for reclaiming space in the store. This function
provides the direct implementation for <code>RStoreReclaim::OpenL()</code>.
</p>
<p>Note:</p>
<ul>
<li>
<p>Actually reclaiming the space is done by repeated calls to
<code>MIncrementalCollector::Next()</code>, before releasing the object.</p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MIncrementalCollector*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to an incremental collector, which implements the interface for
reclaiming store space.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.12"></a></div><div class="Head3">
<a name="%3a%3aCStreamStore%3a%3aDoCompactL%28%29"></a>
<hr size="1" noshade>
<h3><code>DoCompactL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual MIncrementalCollector* DoCompactL();</code></p><h4 class="subheading">Description</h4>
<p>Initialises an object for compacting space in the store. This function
provides the direct implementation for <code>RStoreReclaim::CompactL()</code>.
</p>
<p>Note:</p>
<ul>
<li>
<p>Actually compacting the space is done by repeated calls to
<code>MIncrementalCollector::Next()</code> before releasing the object.</p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MIncrementalCollector*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to an incremental collector, which implements the interface for
compacting store space.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
