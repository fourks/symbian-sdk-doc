<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CBufFlat</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CBufBaseClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CBufSegClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Dynamic&nbsp;Buffers</a>&nbsp;<span class="separator">&#187;</span>
CBufFlat</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> e32base.h </code>
<br>Link against: <code> euser.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aCBufFlat"></a>

<h1>Class <code>CBufFlat</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CBufFlat</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides a flat storage dynamic buffer. This class should be used
when high-speed pointer lookup is an important consideration, and you are
reasonably confident that the insertion of data will not fail. </p>
<p>This class is an implementation of the abstract buffer interface
provided by <code>CBufBase</code> and uses a single heap cell to contain the
data.</p>
<p>Its data members include a pointer to the heap cell, and the size
of the allocated cell.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code><a href="CBufBaseClass.html#%3a%3aCBufBase">CBufBase</a></code></td><td class="Cell">Specifies the interface for dynamic buffers</td>
</tr>
<tr><td class="Cell"><code>CBufFlat</code></td><td class="Cell">Provides a flat storage dynamic buffer</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CBufFlat</code>:
<br><code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aBackPtr%28%29" title="Returns a pointer descriptor to represent the data starting at beginning of the contiguous region containing that byte through to the byte immediately preceding the specified byte">BackPtr()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aCapacity%28%29" title="Returns the size to which the buffer may expand without re-allocation">Capacity()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aCompress%28%29" title="Compresses the buffer so as to occupy minimal space">Compress()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aDelete%28%29" title="Deletes data from the buffer">Delete()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aNewL%28%29" title="Allocates and constructs a flat buffer">NewL()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aPtr%28%29" title="Returns a pointer descriptor to represent the data starting at the specified data byte through to the end of the contiguous region containing that byte">Ptr()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3aSetReserveL%28%29" title="Specifies a minimum amount of space which the flat buffer should occupy">SetReserveL()</a></code>, <code class="ApiItem"><a href="CBufFlatClass.html#%3a%3aCBufFlat%3a%3a%7eCBufFlat%28%29" title="Frees all resources owned by the object, prior to its destruction">~CBufFlat()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase" title="Specifies the interface for dynamic buffers">CBufBase</a></code>:
<br><code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aExpandL%28%29" title="Inserts an uninitialised region into the buffer">ExpandL()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aInsertL%28%29" title="Inserts data into the buffer -- overloaded function">InsertL()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aRead%28%29" title="Reads data from the buffer into a descriptor -- overloaded function">Read()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aReset%28%29" title="Deletes all data in the buffer">Reset()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aResizeL%28%29" title="Re-sizes the buffer to the specified size">ResizeL()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aSize%28%29" title="Returns the number of data bytes in the buffer">Size()</a></code>,
<code class="ApiItem"><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aWrite%28%29" title="Writes data from a descriptor to the buffer -- overloaded function">Write()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CBufFlat* NewL(TInt anExpandSize);</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a flat buffer.</p>
<p>If there is insufficient memory available to allocate the flat
buffer, the function leaves.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt anExpandSize </code></td>
<td class="Cell"><p class="ValueDesc"> The granularity of buffer expansion. Additional space, when
required, is always allocated in multiples of this number. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CBufFlat* </code></td>
<td class="Cell"><p class="ValueDesc"> If successful, a pointer to the allocated buffer. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3a%7eCBufFlat%28%29"></a>
<hr size="1" noshade>
<h3><code>~CBufFlat()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CBufFlat();</code></p><h4 class="subheading">Description</h4>
<p>Frees all resources owned by the object, prior to its
destruction. Specifically, it frees the allocated cell used as a buffer.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reserving space</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aSetReserveL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetReserveL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetReserveL(TInt aSize);</code></p><h4 class="subheading">Description</h4>
<p>Specifies a minimum amount of space which the flat buffer should
occupy.</p>
<p>If the required size is zero, the heap cell is deleted. If it is
different from the current size, the heap cell is rellocated
accordingly.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aSize </code></td>
<td class="Cell"><p class="ValueDesc"> The size of the heap cell required. It must not be negative,
otherwise the function raises a E32USER-CBase 10 panic If there is data in the
buffer, the specified size must not be less than the value returned by
<code>Size()</code>, otherwise the function raises a E32USER-CBase 11 panic. If
there is no data in the buffer, i.e. <code>Size()</code> returns zero, the
specified size value can be zero which causes the buffer's allocated heap cell
to be deleted. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">This function leaves if it is impossible to re-allocate the heap
cell to a sufficiently large size. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aCapacity%28%29"></a>
<hr size="1" noshade>
<h3><code>Capacity()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Capacity() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the size to which the buffer may expand without
re-allocation.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> The size of the allocated cell associated with the buffer. This is
the maximum size the buffer may be expanded to without re-allocation. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Deleting data</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aDelete%28%29"></a>
<hr size="1" noshade>
<h3><code>Delete()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Delete(TInt aPos,TInt aLength);</code></p><h4 class="subheading">Description</h4>
<p>Deletes data from the buffer. During deletion, any data beyond the
deleted data is shuffled up so that the buffer contents are contiguous. No
memory is freed.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aDelete%28%29" title="Deletes data from the buffer"><code class="ApiItem">CBufBase::Delete()</code></a></li>
</ul>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Compressing data</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aCompress%28%29"></a>
<hr size="1" noshade>
<h3><code>Compress()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Compress();</code></p><h4 class="subheading">Description</h4>
<p>Compresses the buffer so as to occupy minimal space. This frees any
unused memory at the end of the buffer.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aCompress%28%29" title="Compresses the buffer so as to occupy minimal space"><code class="ApiItem">CBufBase::Compress()</code></a></li>
</ul>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Pointer access</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aPtr%28%29"></a>
<hr size="1" noshade>
<h3><code>Ptr()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TPtr8 Ptr(TInt aPos);</code></p><h4 class="subheading">Description</h4>
<p>Returns a pointer descriptor to represent the data starting at the
specified data byte through to the end of the contiguous region containing that
byte.</p>
<p>Calculation of the pointer and length involves only a few machine
instructions and is independent of the data contained in the buffer.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aPtr%28%29" title="Returns a pointer descriptor which refers to all from the specified data byte until the end of the contiguous region containing that byte"><code class="ApiItem">CBufBase::Ptr()</code></a></li>
</ul>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCBufFlat%3a%3aBackPtr%28%29"></a>
<hr size="1" noshade>
<h3><code>BackPtr()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TPtr8 BackPtr(TInt aPos);</code></p><h4 class="subheading">Description</h4>
<p>Returns a pointer descriptor to represent the data starting at beginning
of the contiguous region containing that byte through to the byte immediately
preceding the specified byte.</p>
<p>The descriptor always points to the beginning of the buffer containing
the specified byte. Calculation of the pointer and length involves only a few
machine instructions and is independent of the data contained in the
buffer.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CBufBaseClass.html#%3a%3aCBufBase%3a%3aBackPtr%28%29" title="Returns a pointer descriptor which refers to data from just before the specified data byte backward until the beginning of the contiguous region containing that byte"><code class="ApiItem">CBufBase::BackPtr()</code></a></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
