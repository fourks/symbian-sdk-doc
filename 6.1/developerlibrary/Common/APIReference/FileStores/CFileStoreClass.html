<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CFileStore</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CDirectFileStoreClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CPermanentFileStoreClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">File&nbsp;Stores</a>&nbsp;<span class="separator">&#187;</span>
CFileStore</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> s32file.h </code>
<br>Link against: <code> estor.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aCFileStore"></a>

<h1>Class <code>CFileStore</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CFileStore</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>File based persistent store&nbsp;&#8212; abstract base
class.</p>
<p>The class encapsulates the basic behaviour of file based stores.
File based stores are persistent stores, i.e. they have the ability to keep the
external representation of objects for longer than the lifetime of the
applications which created those objects.</p>
<p>The class forms the base for the direct file store,
<code>CDirectFileStore</code>, and the permanent file store,
<code>CPermanentFileStore</code>. In general, it is sufficient for pointers to
file based store objects to be of type <code>CFileStore</code>, rather than of
the concrete file store type.</p>
<p>Existing file stores can be opened using the member functions
<code>OpenL()</code>, <code>OpenLC()</code>, <code>FromL()</code> and
<code>FromLC()</code>. New file stores, however, must be created using the
appropriate member function of the concrete type.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CFileStore</code></td><td class="Cell">File based persistent store -- abstract base class</td>
</tr>
<tr><td class="Cell"><code><a href="../Stores/CPersistentStoreClass.html#%3a%3aCPersistentStore">CPersistentStore</a></code></td><td class="Cell">Persistent store abstract base class</td>
</tr>
<tr><td class="Cell"><code><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore">CStreamStore</a></code></td><td class="Cell">Provides the core abstract framework for stores allowing streams to be created and manipulated</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CFileStore</code>:
<br><code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aDetach%28%29" title="Detaches the file store from its associated file">Detach()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aFile%28%29" title="Gets a reference to the file associated with this file store">File()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aFromL%28%29" title="Constructs a file store object from an opened file, using the specified set of factory functions">FromL()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aFromLC%28%29" title="Constructs a file store object from an opened file, using the specified set of factory functions, and places the pointer onto the cleanup stack">FromLC()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store">Layout()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aOpenL%28%29" title="Opens a file containing a store, using the specified set of factory functions and constructs a file store object">OpenL()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aOpenLC%28%29" title="Opens a file containing a store, using the specified set of factory functions, and constructs a file store object placing a pointer onto the cleanup stack">OpenLC()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aReattach%28%29" title="Reattaches a file to the file store">Reattach()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aReset%28%29" title="Frees the file store's buffer space and changes the size of future buffer space allocations">Reset()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aSetTypeL%28%29" title="Sets the UID type of the file store">SetTypeL()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aType%28%29" title="Gets the UID type of the file store">Type()</a></code>, <code class="ApiItem"><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3a%7eCFileStore%28%29" title="Frees resources owned by the object, prior to its destruction">~CFileStore()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="../Stores/CPersistentStoreClass.html#%3a%3aCPersistentStore" title="Persistent store abstract base class">CPersistentStore</a></code>:
<br><code class="ApiItem"><a href="../Stores/CPersistentStoreClass.html#%3a%3aCPersistentStore%3a%3aRoot%28%29" title="Returns the stream id of the root stream">Root()</a></code>,
<code class="ApiItem"><a href="../Stores/CPersistentStoreClass.html#%3a%3aCPersistentStore%3a%3aSetRootL%28%29" title="Sets the specified stream as the root stream">SetRootL()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore" title="Provides the core abstract framework for stores allowing streams to be created and manipulated">CStreamStore</a></code>:
<br><code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommit%28%29" title="Commits changes">Commit()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommitL%28%29" title="Commit changes and leaves if unsuccessful">CommitL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCompactL%28%29" title="Compacts the store">CompactL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDelete%28%29" title="Deletes the specified stream from this store">Delete()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDeleteL%28%29" title="Deletes the specified stream from this store, leaving if unsuccessful">DeleteL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCommitL%28%29" title="Commits any changes to the store">DoCommitL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCompactL%28%29" title="Initialises an object for compacting space in the store">DoCompactL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoCreateL%28%29" title="Creates a new stream in the store">DoCreateL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoDeleteL%28%29" title="Deletes the specified stream from the store">DoDeleteL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReadL%28%29" title="Opens the requested stream for reading">DoReadL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReclaimL%28%29" title="Initialises an object for reclaiming space in the store">DoReclaimL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoReplaceL%28%29" title="Opens the specified existing stream for safe replacement">DoReplaceL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoRevertL%28%29" title="Discards any pending changes to the store">DoRevertL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aDoWriteL%28%29" title="Opens the specified existing stream for writing">DoWriteL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aExtendL%28%29" title="Generates a new stream within this store, and returns its id">ExtendL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aReclaimL%28%29" title="Reclaims space within a store, returning the total amount of free space available within that store">ReclaimL()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevert%28%29" title="Rolls back the store to its state at the last commit point">Revert()</a></code>,
<code class="ApiItem"><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful">RevertL()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aOpenL%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* OpenL(RFs&amp; aFs,const TDesC&amp; aName,TUint aFileMode);</code></p><h4 class="subheading">Description</h4>
<p>Opens a file containing a store and constructs an appropriate
file store object.</p>
<p>The resulting file store object is of concrete type, i.e.
either <code>CDirectFileStore</code> or <code>CPermanentFileStore</code>. The
specific type is determined from the layout information held in the file
store.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFs&amp; aFs </code></td>
<td class="Cell"><p class="ValueDesc"> Handle to a file server session.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> The full path name of the file containing the store.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFileMode </code></td>
<td class="Cell"><p class="ValueDesc"> The mode in which the file is to be accessed. The mode is
defined by the <code>TFileMode</code> type.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a direct file store or a permanent file
store, otherwise <code>OpenL()</code> leaves with
<code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aOpenL%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* OpenL(RFs&amp; aFs,const TDesC&amp; aName,TUint aFileMode,const TFileStoreFactoryFunction aFactory[]);</code></p><h4 class="subheading">Description</h4>
<p>Opens a file containing a store, using the specified set of
factory functions and constructs a file store object.</p>
<p>The function invokes each factory function, in turn, until an
attempt to construct a file store object is successful. The file store type is
determined by the layout information held in the file store and assumes that
one of the supplied factory functions is capable of opening that
type.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFs&amp; aFs </code></td>
<td class="Cell"><p class="ValueDesc"> Handle to a file server session. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> The full path name of the file containing the store.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFileMode </code></td>
<td class="Cell"><p class="ValueDesc">The mode in which the file is to be accessed. The mode is
defined by the <code>TFileMode</code> type. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TFileStoreFactoryFunction aFactory[] </code></td>
<td class="Cell"><p class="ValueDesc">An array of factory functions, one of which should be capable
of opening the file store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a file store of a type that can be
opened by one of the factory functions, otherwise <code>OpenL()</code> leaves
with <code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.4"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aOpenLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* OpenLC(RFs&amp; aFs,const TDesC&amp; aName,TUint aFileMode);</code></p><h4 class="subheading">Description</h4>
<p>Opens a file containing a store, constructs an appropriate file
store object and places the pointer onto the cleanup stack.</p>
<p>The resulting file store object is of concrete type, i.e.
either <code>CDirectFileStore</code> or <code>CPermanentFileStore</code>. The
specific type is determined from the layout information held in the file
store.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFs&amp; aFs </code></td>
<td class="Cell"><p class="ValueDesc">Handle to a file server session. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> The full path name of the file containing the store. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFileMode </code></td>
<td class="Cell"><p class="ValueDesc"> The mode in which the file is to be accessed. The mode is
defined by the <code>TFileMode</code> type. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a direct file store or a permanent file
store, otherwise <code>OpenLC()</code> leaves with
<code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.5"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aOpenLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* OpenLC(RFs&amp; aFs,const TDesC&amp; aName,TUint aFileMode,const TFileStoreFactoryFunction aFactory[]);</code></p><h4 class="subheading">Description</h4>
<p>Opens a file containing a store, using the specified set of
factory functions, and constructs a file store object placing a pointer onto
the cleanup stack.</p>
<p>The function invokes each factory function, in turn, until an
attempt to construct a file store object is successful. The file store type is
determined by the layout information held in the file store and assumes that
one of the supplied factory functions is capable of opening that type.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFs&amp; aFs </code></td>
<td class="Cell"><p class="ValueDesc">Handle to a file server session. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> The full path name of the file containing the store. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFileMode </code></td>
<td class="Cell"><p class="ValueDesc"> The mode in which the file is to be accessed. The mode is
defined by the <code>TFileMode</code> type. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TFileStoreFactoryFunction aFactory[] </code></td>
<td class="Cell"><p class="ValueDesc"> An array of factory functions, one of which should be capable
of opening the file store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a file store of a type that can be
opened by one of the factory functions, otherwise <code>OpenLC()</code> leaves
with <code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.6"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aFromL%28%29"></a>
<hr size="1" noshade>
<h3><code>FromL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* FromL(RFile&amp; aFile);</code></p><h4 class="subheading">Description</h4>
<p>Constructs a file store object from an opened file.</p>
<p> The file must already be open before calling this
function.</p>
<p>The resulting file store object is of concrete type, i.e.
either <code>CDirectFileStore</code> or <code>CPermanentFileStore</code>. The
specific type is determined from the layout information held in the file
store.</p>
<p>Note that ownership of the file passes to the store. The
referenced <code>RFile</code> is cleared and is no longer valid:</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; aFile </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the opened file. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a direct file store or a permanent file
store, otherwise <code>FromL()</code> leaves with
<code>KErrNotSupported</code>. If the function leaves, the file is closed.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.7"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aFromL%28%29"></a>
<hr size="1" noshade>
<h3><code>FromL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* FromL(RFile&amp; aFile,const TFileStoreFactoryFunction aFactory[]);</code></p><h4 class="subheading">Description</h4>
<p>Constructs a file store object from an opened file, using the
specified set of factory functions.</p>
<p> The file must already be open before calling this
function.</p>
<p>The function invokes each factory function, in turn, until an
attempt to construct a file store object is successful. The file store type is
determined by the layout information held in the file store and assumes that
one of the supplied factory functions is capable of opening that type.</p>
<p>Note that ownership of the file passes to the store. The
referenced <code>RFile</code> is cleared and is no longer
valid:</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; aFile </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the opened file. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TFileStoreFactoryFunction aFactory[] </code></td>
<td class="Cell"><p class="ValueDesc">An array of factory functions, one of which should be capable
of opening the file store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a file store of a type that can be
opened by one of the factory functions, otherwise <code>FromLC()</code> leaves
with <code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.8"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aFromLC%28%29"></a>
<hr size="1" noshade>
<h3><code>FromLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* FromLC(RFile&amp; aFile);</code></p><h4 class="subheading">Description</h4>
<p>Constructs a file store object from an opened file, and places
the pointer onto the cleanup stack.</p>
<p> The file must already be open before calling this
function.</p>
<p>The resulting file store object is of concrete type, i.e.
either <code>CDirectFileStore</code> or <code>CPermanentFileStore</code>. The
specific type is determined from the layout information held in the file
store.</p>
<p>Note that ownership of the file passes to the store. The
referenced <code>RFile</code> is cleared and is no longer
valid:</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; aFile </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the opened file. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a direct file store or a permanent file
store, otherwise <code>FromLC()</code> leaves with
<code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.9"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aFromLC%28%29"></a>
<hr size="1" noshade>
<h3><code>FromLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CFileStore* FromLC(RFile&amp; aFile,const TFileStoreFactoryFunction aFactory[]);</code></p><h4 class="subheading">Description</h4>
<p>Constructs a file store object from an opened file, using the
specified set of factory functions, and places the pointer onto the cleanup
stack.</p>
<p> The file must already be open before calling this
function.</p>
<p>The function invokes each factory function, in turn, until an
attempt to construct a file store object is successful. The file store type is
determined by the layout information held in the file store and assumes that
one of the supplied factory functions is capable of opening that type.</p>
<p>Note that ownership of the file passes to the store. The
referenced <code>RFile</code> is cleared and is no longer
valid:</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; aFile </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the opened file. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TFileStoreFactoryFunction aFactory[] </code></td>
<td class="Cell"><p class="ValueDesc">An array of factory functions, one of which should be capable
of opening the file store. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CFileStore* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the new file store object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The file must contain a file store of a type that can be
opened by one of the factory functions, otherwise <code>FromLC()</code> leaves
with <code>KErrNotSupported</code>. If the function leaves, the file is
closed.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aLayout%28%29" title="Gets the UID that uniquely identifies the specific type of this file store"><code class="ApiItem">CFileStore::Layout()</code></a></li>
</ul>
<a name="2.6.10"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3a%7eCFileStore%28%29"></a>
<hr size="1" noshade>
<h3><code>~CFileStore()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CFileStore();</code></p><h4 class="subheading">Description</h4>
<p>Frees resources owned by the object, prior to its destruction.
In particular, it closes the associated file.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>File store type and layout</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aSetTypeL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetTypeL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetTypeL(const TUidType&amp; aType);</code></p><h4 class="subheading">Description</h4>
<p>Sets the UID type of the file store.</p>
<p>The first UID, i.e. the first <code>TUid</code> component, of
the <code>TUidType</code> must be the file store type as returned by
<code>CFileStore::Layout()</code>, otherwise the function raises a STORE-File 9
panic.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TUidType&amp; aType </code></td>
<td class="Cell"><p class="ValueDesc">The UID type object containing the file store type. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../UIDManipulation/TUidClass.html#%3a%3aTUid" title="Globally unique 32-bit number"><code class="ApiItem">TUid</code></a></li>
</ul>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aType%28%29"></a>
<hr size="1" noshade>
<h3><code>Type()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>const TUidType&amp; Type() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the UID type of the file store.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUidType&amp; </code></td>
<td class="Cell"><p class="ValueDesc">The UID type object containing the file store type. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../UIDManipulation/TUidClass.html#%3a%3aTUid" title="Globally unique 32-bit number"><code class="ApiItem">TUid</code></a></li>
</ul>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aLayout%28%29"></a>
<hr size="1" noshade>
<h3><code>Layout()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TUid Layout() const=0;</code></p><h4 class="subheading">Description</h4>
<p>Gets the UID that uniquely identifies the specific type of this
file store.</p>
<p>This function must be defined and implemented by classes
derived from <code>CFileStore</code>. The direct file store,
<code>CDirectFileStore</code> and the permanent file store,
<code>CPermanentFileStore</code> both implement suitable functions.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUid </code></td>
<td class="Cell"><p class="ValueDesc"> The UID that uniquely identifies the specific type of file
store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="Constants.html#%3a%3aKDirectFileStoreLayoutUid" title="The UID that identifies a file store as being a direct file store"><code class="ApiItem">KDirectFileStoreLayoutUid</code></a></li>
<li><a href="Constants.html#%3a%3aKPermanentFileStoreLayoutUid" title="The UID that identifies a file store as being a permanent file store"><code class="ApiItem">KPermanentFileStoreLayoutUid</code></a></li>
</ul>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>File manipulation</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aFile%28%29"></a>
<hr size="1" noshade>
<h3><code>File()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>RFile&amp; File() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets a reference to the file associated with this file
store.</p>
<p> This function is called prior to detaching the file
store.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the associated file. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aDetach%28%29" title="Detaches the file store from its associated file"><code class="ApiItem">Detach()</code></a></li>
</ul>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aDetach%28%29"></a>
<hr size="1" noshade>
<h3><code>Detach()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Detach();</code></p><h4 class="subheading">Description</h4>
<p>Detaches the file store from its associated file. </p>
<p>In effect, the file store gives up ownership of the
file.</p>
<p>Detaching is useful in cases where a file needs to be closed
and later re-opened; for example, to give up a write lock for backup
purposes.</p>
<p>It is very important that the contents of the file should not
change while it is detached.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aFile%28%29" title="Gets a reference to the file associated with this file store"><code class="ApiItem">File()</code></a></li>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aReattach%28%29" title="Reattaches a file to the file store"><code class="ApiItem">Reattach()</code></a></li>
</ul>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aReattach%28%29"></a>
<hr size="1" noshade>
<h3><code>Reattach()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Reattach(RFile&amp; aFile);</code></p><h4 class="subheading">Description</h4>
<p>Reattaches a file to the file store. The file should be the one
that was detached using the <code>Detach()</code> function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RFile&amp; aFile </code></td>
<td class="Cell"><p class="ValueDesc">The file to be associated with this file store. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CFileStoreClass.html#%3a%3aCFileStore%3a%3aFile%28%29" title="Gets a reference to the file associated with this file store"><code class="ApiItem">File()</code></a></li>
</ul>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reset buffers</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aReset%28%29"></a>
<hr size="1" noshade>
<h3><code>Reset()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Reset();</code></p><h4 class="subheading">Description</h4>
<p>Frees the file store&#8217;s buffer space.</p>
<p>The buffer space is automatically re-allocated when
needed.</p>
<p>This function should only be used immediately after a
successful call to <code>CommitL()</code> or <code>RevertL()</code>.</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommitL%28%29" title="Commit changes and leaves if unsuccessful"><code class="ApiItem">CStreamStore::CommitL()</code></a></li>
<li><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful"><code class="ApiItem">CStreamStore::RevertL()</code></a></li>
</ul>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCFileStore%3a%3aReset%28%29"></a>
<hr size="1" noshade>
<h3><code>Reset()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Reset(TInt aSize);</code></p><h4 class="subheading">Description</h4>
<p>Frees the file store&#8217;s buffer space and changes the size
of future buffer space allocations.</p>
<p>The buffer space is automatically re-allocated when needed,
using the new size value.</p>
<p>This function should only be used immediately after a
successful call to <code>CommitL()</code> or <code>RevertL()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aSize </code></td>
<td class="Cell"><p class="ValueDesc"> The size of future buffer space allocations. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aCommitL%28%29" title="Commit changes and leaves if unsuccessful"><code class="ApiItem">CStreamStore::CommitL()</code></a></li>
<li><a href="../Stores/CStreamStoreClass.html#%3a%3aCStreamStore%3a%3aRevertL%28%29" title="Rolls back the store to its state at the last commit point and leaves if unsuccessful"><code class="ApiItem">CStreamStore::RevertL()</code></a></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
