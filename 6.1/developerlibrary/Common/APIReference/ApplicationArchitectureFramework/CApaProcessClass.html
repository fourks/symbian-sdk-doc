<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CApaProcess</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CApaModelHeaderClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CApaRecentFileClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Application&nbsp;Architecture&nbsp;Framework</a>&nbsp;<span class="separator">&#187;</span>
CApaProcess</p>

<hr noshade size="1">
<div class="AuthoredContent">
<p>Location: <code>
apparc.h
</code><br>Link against: <code>
apparc.lib
</code></p>
</div><div class="Head1">
<a name="%3a%3aCApaProcess"></a>

<h1>Class <code>CApaProcess</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CApaProcess</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Maintains a list of documents and all of the potentially shared resources used by documents.</p><p>This includes the application DLLs. The class also supplies utility functions that provide the basic structure for persisted document files.</p>
<p>The class deals with the loading of application DLLs and manages the creation and destruction of application (<code>CApaApplication</code>) objects and document (<code>CApaDocument</code>) objects.</p>
<p>The class is derived from by the UI framework and further derivation by the UI application is not necessary unless it needs to add extra utility functions for the use of applications.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code>CApaProcess</code></td><td class="Cell">Maintains a list of documents and all of the potentially shared resources used by documents</td>
</tr>
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CApaProcess</code>:
<br><code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aAddNewDocumentL%28%29" title="Creates and adds a new document of the specified application type">AddNewDocumentL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aCApaProcess%28%29" title="Constructs the application process object with the specified file session handle and application finder">CApaProcess()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aConstructL%28%29" title="Completes construction of the application process object">ConstructL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aDestroyDocument%28%29" title="Destroys the specified document">DestroyDocument()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aFsSession%28%29" title="Returns a handle to the file server session used by this application process">FsSession()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aMainDocFileName%28%29" title="Returns the filename of the main document">MainDocFileName()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aMainDocument%28%29" title="Returns a pointer to the main document">MainDocument()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aNewL%28%29" title="Creates and returns a pointer to a new application process">NewL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aOpenNewDocumentL%28%29" title="Opens the specified file and restores the content as a document">OpenNewDocumentL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aReadAppIdentifierL%28%29" title="Reads the application identifier from its stream in the specified store and returns it">ReadAppIdentifierL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aReadRootStreamLC%28%29" title="Reads the stream dictionary contained as the root stream in the specified document file">ReadRootStreamLC()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aResetL%28%29" title="Resets the the application process to its initial state">ResetL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aSetMainDocFileName%28%29" title="Sets the filename of the main document">SetMainDocFileName()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aSetMainDocument%28%29" title="Sets the main document">SetMainDocument()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aTempFilePath%28%29" title="Returns the path of the directory in which temporary files should be created">TempFilePath()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aWriteAppIdentifierL%28%29" title="Writes the application identifier to a new stream in the specified store and records the location of this stream in the specified stream dictionary">WriteAppIdentifierL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aWriteRootStreamL%28%29" title="Writes the application identifier stream followed by the stream dictionary to the store and makes the stream dictionary the root stream of the store">WriteRootStreamL()</a></code>, <code class="ApiItem"><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3a%7eCApaProcess%28%29" title="Frees resources prior to destruction">~CApaProcess()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CApaApplicationClass.html#%3a%3aCApaApplication" title="Defines the basic behaviour for applications"><code class="ApiItem">CApaApplication</code></a></li>
<li><a href="CApaDocumentClass.html#%3a%3aCApaDocument" title="Defines basic behaviour for documents"><code class="ApiItem">CApaDocument</code></a></li>
</ul>
<a name="2.7"></a></div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and initialisation</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CApaProcess* NewL(const RFs&amp; aFs,CApaAppFinder&amp; aAppFinder);</code></p><h4 class="subheading">Description</h4>
<p>Creates and returns a pointer to a new application process.</p>
<p>This function is not used by UI applications.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
const RFs&amp; aFs
</code></td>
<td class="Cell"><p class="ValueDesc">
Handle to a file server session.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaAppFinder&amp; aAppFinder
</code></td>
<td class="Cell"><p class="ValueDesc">
An object for finding applications within the file system. This is not part of the public API.
The process takes ownership of this object and takes responsibility for deleting it, even if the function leaves.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaProcess*
</code></td>
<td class="Cell"><p class="ValueDesc">
Pointer to the new application process.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aCApaProcess%28%29"></a>
<hr size="1" noshade>
<h3><code>CApaProcess()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>protected: CApaProcess(const RFs&amp; aFs,CApaAppFinder&amp; aAppFinder);</code></p><h4 class="subheading">Description</h4>
<p>Constructs the application process object with the specified file session handle and application finder.</p>
<p>Derived classes must define and implement a constructor through which both the file session handle and application finder object can be specified. A typical implementation calls this constructor through a constructor initialization list.</p>
<p>This constructor is used by the UI framework.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
const RFs&amp; aFs
</code></td>
<td class="Cell"><p class="ValueDesc">
Handle to a file server session
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaAppFinder&amp; aAppFinder
</code></td>
<td class="Cell"><p class="ValueDesc">
An object for finding applications within the file system. This is not part of the public API.
</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aConstructL%28%29"></a>
<hr size="1" noshade>
<h3><code>ConstructL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>protected: void ConstructL();</code></p><h4 class="subheading">Description</h4>
<p>Completes construction of the application process object.</p>
<p>Implementers of derived classes must call this function as part of the second stage construction of an object. Typically, derived classes implement their own <code>NewL()</code> function and call <code>ConstructL()</code> as part of that implementation.</p>
<a name="2.7.5"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aResetL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResetL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResetL();</code></p><h4 class="subheading">Description</h4>
<p>Resets the the application process to its initial state.</p>
<p>Specifically, it saves the main document, deletes the main and all embedded documents from memory, resets the main document filename and deletes all applications except the main application.</p>
<p>The function can leave if saving the main document fails.</p>
<a name="2.8"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Destruction</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3a%7eCApaProcess%28%29"></a>
<hr size="1" noshade>
<h3><code>~CApaProcess()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CApaProcess();</code></p><h4 class="subheading">Description</h4>
<p>Frees resources prior to destruction.</p>
<p>Documents must be saved before the application process is deleted, otherwise data may be lost.</p>
<p>In debug mode, the destructor raises an APPARC 6 panic if documents still exist, and an APPARC 5 panic if applications still exist.</p>
<a name="2.9"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>General document management</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aAddNewDocumentL%28%29"></a>
<hr size="1" noshade>
<h3><code>AddNewDocumentL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CApaDocument* AddNewDocumentL(const TDesC&amp; aDllFileName,TUid aDllUid=KNullUid);</code></p><h4 class="subheading">Description</h4>
<p>Creates and adds a new document of the specified application type.</p><p> The document may be a main document or an embedded document.</p>
<p>The function creates a new application object, a <code>CApaApplication</code> type, if this is the first document of that type to be added.</p>
<p>The search strategy for the application DLL depends on the the specified file name and UID. If the full path name of a DLL is specified, then that DLL is located and loaded. If the full path name is not specified and a UID is specified, then a DLL matching that UID is located and loaded. If the full path name is not specified and the UID is null, then a DLL with matching filename is located and loaded.</p>
<p>The function leaves with <code>KErrNotFound</code> if no suitable application DLL can be found.</p>
<p>Any document created with this function must be destroyed using <code>DestroyDocument()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
const TDesC&amp; aDllFileName
</code></td>
<td class="Cell"><p class="ValueDesc">
Filename of the application DLL.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
TUid aDllUid
</code></td>
<td class="Cell"><p class="ValueDesc">
UID of the application. If this is not specified, the default is <code>KNullUid</code>.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaDocument*
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the new document.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aDestroyDocument%28%29" title="Destroys the specified document"><code class="ApiItem">CApaProcess::DestroyDocument()</code></a></li>
<li><a href="CApaApplicationClass.html#%3a%3aCApaApplication" title="Defines the basic behaviour for applications"><code class="ApiItem">CApaApplication</code></a></li>
<li><a href="../UIDManipulation/Constants.html#%3a%3aKNullUid" title="a null UID"><code class="ApiItem">KNullUid</code></a></li>
</ul>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aOpenNewDocumentL%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenNewDocumentL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CApaDocument* OpenNewDocumentL(CFileStore*&amp; aStore,CStreamDictionary*&amp; aStreamDic,const TDesC&amp; aDocFullFileName,TUint aFileMode);</code></p><h4 class="subheading">Description</h4>
<p>Opens the specified file and restores the content as a document.</p><p>The created document can be merged into another document or embedded in another document.</p>
<p>Any document created with this function must be destroyed using <code>DestroyDocument()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CFileStore*&amp; aStore
</code></td>
<td class="Cell"><p class="ValueDesc">
On return, this contains a pointer to the store object created during the restore.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CStreamDictionary*&amp; aStreamDic
</code></td>
<td class="Cell"><p class="ValueDesc">
On return, this contains a pointer to the stream dictionary object created during the restore.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
const TDesC&amp; aDocFullFileName
</code></td>
<td class="Cell"><p class="ValueDesc">
The name of the file containing the document.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
TUint aFileMode
</code></td>
<td class="Cell"><p class="ValueDesc">
The mode in which to open the file.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaDocument*
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the restored document.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
<li><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aDestroyDocument%28%29" title="Destroys the specified document"><code class="ApiItem">CApaProcess::DestroyDocument()</code></a></li>
</ul>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aDestroyDocument%28%29"></a>
<hr size="1" noshade>
<h3><code>DestroyDocument()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void DestroyDocument(CApaDocument* aDoc); </code></p><h4 class="subheading">Description</h4>
<p>Destroys the specified document.</p>
<p>All references to the document are removed, and associated resources are freed. Specifically, the function deletes any associated application and unloads the application DLL, provided that no other documents of that application type are still open.</p>
<p>All document objects created through  <code>CApaProcess</code> must be deleted using this function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaDocument* aDoc
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the document to be destroyed.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CApaApplicationClass.html#%3a%3aCApaApplication" title="Defines the basic behaviour for applications"><code class="ApiItem">CApaApplication</code></a></li>
<li><a href="CApaProcessClass.html#%3a%3aCApaProcess" title="Maintains a list of documents and all of the potentially shared resources used by documents"><code class="ApiItem">CApaProcess</code></a></li>
</ul>
<a name="2.10"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Main document management</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aMainDocument%28%29"></a>
<hr size="1" noshade>
<h3><code>MainDocument()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CApaDocument* MainDocument() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns a pointer to the main document.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaDocument*
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the main document.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aSetMainDocument%28%29"></a>
<hr size="1" noshade>
<h3><code>SetMainDocument()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetMainDocument(CApaDocument* aDocument);</code></p><h4 class="subheading">Description</h4>
<p>Sets the main document.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CApaDocument* aDocument
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the document to be set as the main document of the application process.
This must be a an object created by the <code>AddNewDocumentL()</code> or <code>OpenNewDocumentL()</code> functions
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aAddNewDocumentL%28%29" title="Creates and adds a new document of the specified application type"><code class="ApiItem">CApaProcess::AddNewDocumentL()</code></a></li>
<li><a href="CApaProcessClass.html#%3a%3aCApaProcess%3a%3aOpenNewDocumentL%28%29" title="Opens the specified file and restores the content as a document"><code class="ApiItem">CApaProcess::OpenNewDocumentL()</code></a></li>
</ul>
<a name="2.10.4"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aMainDocFileName%28%29"></a>
<hr size="1" noshade>
<h3><code>MainDocFileName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TPtrC MainDocFileName() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the filename of the main document.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
TPtrC
</code></td>
<td class="Cell"><p class="ValueDesc">
A non-modifiable pointer descriptor to the main document filename.
For non file-based applications, the length of this descriptor is zero.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10.5"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aSetMainDocFileName%28%29"></a>
<hr size="1" noshade>
<h3><code>SetMainDocFileName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetMainDocFileName(const TDesC&amp; aMainDocFileName);</code></p><h4 class="subheading">Description</h4>
<p>Sets the filename of the main document.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
const TDesC&amp; aMainDocFileName
</code></td>
<td class="Cell"><p class="ValueDesc">
The filename to be set.
If the length of this descriptor is greater than <code>KMaxFileName</code>, then the function raises an APPARC 7 panic
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/FsConstFileConstants.html#%3a%3aKMaxFileName" title="The maximum length of a filename (and the maximum length of any component of it) = 256 characters"><code class="ApiItem">KMaxFileName</code></a></li>
</ul>
<a name="2.11"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Root stream handling and application identifiers</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aReadRootStreamLC%28%29"></a>
<hr size="1" noshade>
<h3><code>ReadRootStreamLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CStreamDictionary* ReadRootStreamLC(RFs&amp; aFs,CFileStore*&amp; aStore,const TDesC&amp; aDocFullFileName,TUint aFileMode);</code></p><h4 class="subheading">Description</h4>
<p>Reads the stream dictionary contained as the root stream in the specified document file.</p><p> The function constructs, and returns a pointer to the stream dictionary object and puts the pointer to the stream dictionary object onto the cleanup stack. It also returns a pointer to the created file store object through an argument reference. </p>
<p>The file must be a valid document file, as indicated by the UID value(s), otherwise the function leaves with <code>KErrCorrupt</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
RFs&amp; aFs
</code></td>
<td class="Cell"><p class="ValueDesc">
Handle to a file server session.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CFileStore*&amp; aStore
</code></td>
<td class="Cell"><p class="ValueDesc">
On return, a pointer to the newly created file store object.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
Const TDesC&amp; aDocFullFileName
</code></td>
<td class="Cell"><p class="ValueDesc">
The full path name of the document file.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
TUint aFileMode
</code></td>
<td class="Cell"><p class="ValueDesc">
The mode in which to open the file.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CStreamDictionary*
</code></td>
<td class="Cell"><p class="ValueDesc">
A pointer to the stream dictionary object read from the root stream of the store.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="../FileServerClientSide/TFileModeEnum.html#%3a%3aTFileMode" title="Access and share modes available when opening a file"><code class="ApiItem">TFileMode</code></a></li>
</ul>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aWriteRootStreamL%28%29"></a>
<hr size="1" noshade>
<h3><code>WriteRootStreamL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static void WriteRootStreamL(CPersistentStore&amp; aStore,CStreamDictionary&amp; aStreamDic,const CApaApplication&amp; aApp);<br>static void WriteRootStreamL(CPersistentStore&amp; aStore,CStreamDictionary&amp; aStreamDic,const TApaAppIdentifier&amp; aAppId);</code></p><h4 class="subheading">Description</h4>
<p>Writes the application identifier stream followed by the stream dictionary to the store and makes the stream dictionary the root stream of the store.</p>
<p>Typically, the function is called by the application when it implements a file create or file save type operation. It is called after all model and UI data has been persisted. The IDs of the streams containing the model and UI data should have been lodged in the stream dictionary.</p>
<p>In effect, the function finishes off the file save or file create type operation, leaving the file containing the store in a valid state with the standard interface.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CPersistentStore&amp; aStore
</code></td>
<td class="Cell"><p class="ValueDesc">
The store to which the root stream is to be written.
Before calling this function, a reference to the store must be saved by putting a pointer onto the cleanup stack or by making it member data of a class - this ensures that it is not orphaned in the event of this function leaving.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CStreamDictionary&amp; aStreamDic
</code></td>
<td class="Cell"><p class="ValueDesc">
The stream dictionary containing the locations and associated UIDs of other streams in the store.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
const CApaApplication&amp; aApp
</code></td>
<td class="Cell"><p class="ValueDesc">
The application used to create the main document in the file being written.
The application identifier to be written is constructed from this application object.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
const TApaAppIdentifier&amp; aAppId
</code></td>
<td class="Cell"><p class="ValueDesc">
The application identifier to be written into the application identifier stream.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.4"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aReadAppIdentifierL%28%29"></a>
<hr size="1" noshade>
<h3><code>ReadAppIdentifierL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static TApaAppIdentifier ReadAppIdentifierL(const CStreamStore&amp; aStore,const CStreamDictionary&amp; aStreamDic);</code></p><h4 class="subheading">Description</h4>
<p>Reads the application identifier from its stream in the specified store and returns it.</p><p>The location of the stream is found in the specified stream dictionary.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
const CStreamStore&amp; aStore
</code></td>
<td class="Cell"><p class="ValueDesc">
The store from which the application identifier should be read.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
const CStreamDictionary&amp; aStreamDic
</code></td>
<td class="Cell"><p class="ValueDesc">
The stream dictionary containing the stream ID of the application identifier stream. The stream dictionary can be found in the root stream of the store.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
TApaAppIdentifier
</code></td>
<td class="Cell"><p class="ValueDesc">
The application identifier.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.5"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aWriteAppIdentifierL%28%29"></a>
<hr size="1" noshade>
<h3><code>WriteAppIdentifierL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static void WriteAppIdentifierL(CStreamStore&amp; aStore,CStreamDictionary&amp; aStreamDic,const TApaAppIdentifier&amp; aAppId);</code></p><h4 class="subheading">Description</h4>
<p>Writes the application identifier to a new stream in the specified store and records the location of this stream in the specified stream dictionary.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
CStreamStore&amp; aStore
</code></td>
<td class="Cell"><p class="ValueDesc">
The store to which the application identifier should be written.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
CStreamDictionary&amp; aStreamDic
</code></td>
<td class="Cell"><p class="ValueDesc">
The stream dictionary.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">
const TApaAppIdentifier&amp; aAppId
</code></td>
<td class="Cell"><p class="ValueDesc">
The application identifier to be externalised to a stream.
</p></td>
</tr>
</table></td></tr></table>
<a name="2.12"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>File server session</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aFsSession%28%29"></a>
<hr size="1" noshade>
<h3><code>FsSession()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>RFs&amp; FsSession() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns a handle to the file server session used by this application process.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
RFs&amp;
</code></td>
<td class="Cell"><p class="ValueDesc">
The file server session.
</p></td>
</tr>
</table></td></tr></table>
<a name="2.13"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Path for temporary files</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aCApaProcess%3a%3aTempFilePath%28%29"></a>
<hr size="1" noshade>
<h3><code>TempFilePath()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TPtrC TempFilePath() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the path of the directory in which temporary files should be created.</p>
<p>There is only one path for temporary files in the whole system, and this is just a convenient accessor to return its location.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
TPtrC
</code></td>
<td class="Cell"><p class="ValueDesc">
The pathname of the directory.
</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
