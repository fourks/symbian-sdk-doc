<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RSemaphore</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="index.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="TFindSemaphoreClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Semaphores</a>&nbsp;<span class="separator">&#187;</span>
RSemaphore</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> e32std.h </code>
<br>Link against: <code> euser.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aRSemaphore"></a>

<h1>Class <code>RSemaphore</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RSemaphore</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides a handle to a semaphore. The semaphore itself is a Kernel
object.</p>
<p>As with all handles, they should be closed after use.
<code>RHandleBase</code> provides the necessary <code>Close()</code> function,
which should be called when the handle is no longer required.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase">RHandleBase</a></code></td><td class="Cell">Handle to an object</td>
</tr>
<tr><td class="Cell"><code>RSemaphore</code></td><td class="Cell">Provides a handle to a semaphore</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>RSemaphore</code>:
<br><code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aCount%28%29" title="Gets the current value of the semaphore count">Count()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aCreateGlobal%28%29" title="Creates a semaphore, setting its initial count, and opens this handle to that semaphore">CreateGlobal()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aCreateLocal%28%29" title="Creates a semaphore, setting its initial count, and opens this handle to that semaphore">CreateLocal()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aOpen%28%29" title="Opens a handle onto the global semaphore found using a TFindSemaphore object">Open()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aOpenGlobal%28%29" title="Opens a handle onto a specified existing global semaphore">OpenGlobal()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aSignal%28%29" title="Signals the semaphore">Signal()</a></code>, <code class="ApiItem"><a href="RSemaphoreClass.html#%3a%3aRSemaphore%3a%3aWait%28%29" title="Waits on the semaphore">Wait()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase" title="Handle to an object">RHandleBase</a></code>:
<br><code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aClose%28%29" title="Closes the handle">Close()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aDuplicate%28%29" title="Creates a valid handle to the Kernel object to which the specified thread already has a handle">Duplicate()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aHandle%28%29" title="Retrieves the handle-number of the object associated with this handle">Handle()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aSetHandle%28%29" title="Use this function to set the handle-number of this handle to the specified value">SetHandle()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Create a semaphore</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aCreateLocal%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateLocal()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt CreateLocal(TInt aCount,TOwnerType aType=EOwnerProcess);</code></p><h4 class="subheading">Description</h4>
<p>Creates a semaphore, setting its initial count, and opens this
handle to that semaphore.</p>
<p>The Kernel side object representing the semaphore is unnamed. It is, therefore, local to the calling process.
The handle can be used directly by any thread within the calling process, but no other <code>RSemaphore</code> object can open a duplicate handle.</p>
<p>By default, ownership of this semaphore handle is vested in the
current process, but can be vested in the current thread by passing
<code>EOwnerThread</code> as the second parameter to this function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aCount </code></td>
<td class="Cell"><p class="ValueDesc"> The initial value of the semaphore count. This value must not
be negative otherwise the function raises a USER 105 panic. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TOwnerType aType </code></td>
<td class="Cell"><p class="ValueDesc"> An enumeration whose enumerators define the ownership of this
semaphore handle. If not explicitly specified, <code>EOwnerProcess</code> is
taken as default. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system_wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aCreateGlobal%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateGlobal()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt CreateGlobal(const TDesC&amp; aName,TInt aCount,TOwnerType aType=EOwnerProcess);</code></p><h4 class="subheading">Description</h4>
<p>Creates a semaphore, setting its initial count, and opens this
handle to that semaphore.</p>
<p>The semaphore is visible globally and is assigned the name
contained in the descriptor <code>aName</code>; other threads may open a handle
to this semaphore.</p>
<p>By default, ownership of this semaphore handle is vested in the
current process, but can be vested in the current thread by passing
<code>EOwnerThread</code> as the second parameter to this function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the descriptor containing the name to be assigned
to this global semaphore. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aCount </code></td>
<td class="Cell"><p class="ValueDesc"> The initial value of the semaphore count. This value must not be
negative otherwise the function raises a USER 105 panic. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TOwnerType aType </code></td>
<td class="Cell"><p class="ValueDesc"> An enumeration whose enumerators define the ownership of this
semaphore handle. If not explicitly specified, <code>EOwnerProcess</code> is
taken as default. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Open a handle on an existing semaphore</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aOpenGlobal%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenGlobal()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt OpenGlobal(const TDesC&amp; aName,TOwnerType aType=EOwnerProcess);</code></p><h4 class="subheading">Description</h4>
<p>Opens a handle onto a specified existing global semaphore.</p>
<p>By default, ownership of this semaphore handle is vested in the
current process, but can be vested in the current thread by passing
<code>EOwnerThread</code> as the second parameter to this function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the descriptor containing the name of the global
semaphore which is to be opened. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TOwnerType aType=EOwnerProcess </code></td>
<td class="Cell"><p class="ValueDesc"> An enumeration whose enumerators define the ownership of this
semaphore handle. If not explicitly specified, <code>EOwnerProcess</code> is
taken as default. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> KErrNone if successful otherwise another of the system-wide error
codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Open(const TFindSemaphore&amp; aFind,TOwnerType aType=EOwnerProcess);</code></p><h4 class="subheading">Description</h4>
<p>Opens a handle onto the global semaphore found using a
<code>TFindSemaphore</code> object.</p>
<p>A <code>TFindSemaphore</code> object is used to find all global
semaphores whose full names match a specified pattern.</p>
<p>By default, ownership of this semaphore handle is vested in the
current process, but can be vested in the current thread by passing
<code>EOwnerThread</code> as the second parameter to this function.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TFindSemaphore&amp; aFind </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the <code>TFindSemaphore</code> object used to find
the semaphore. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TOwnerType aType=EOwnerProcess </code></td>
<td class="Cell"><p class="ValueDesc"> An enumeration whose enumerators define the ownership of this
semaphore handle. If not explicitly specified, <code>EOwnerProcess</code> is
taken as default. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Primitive semaphore functions</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aWait%28%29"></a>
<hr size="1" noshade>
<h3><code>Wait()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Wait();</code></p><h4 class="subheading">Description</h4>
<p>Waits on the semaphore.</p>
<p>The function decrements the semaphore count by one and returns
immediately if it is zero or positive.</p>
<p>If the semaphore count is negative after being decremented, the calling
thread is marked as waiting (on a semaphore); the thread is added to the end of
a FIFO queue of threads maintained by this semaphore.</p>
<p>The thread waits until the semaphore is signalled. More than one thread
can be waiting on a particular semaphore at a time. When there are multiple
threads waiting on a semaphore, they are released on a first-in first-out
basis.</p>
<p>If the semaphore is deleted, all threads waiting on that semaphore are
released.</p>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aSignal%28%29"></a>
<hr size="1" noshade>
<h3><code>Signal()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Signal();<br>void Signal(TInt aCount);</code></p><h4 class="subheading">Description</h4>
<p>Signals the semaphore.</p>
<p>The function increments the semaphore count by one. If the count was
negative before being incremented, the first thread waiting on the
semaphore&#8217;s queue of threads is removed from that queue and, provided
that it is not suspended for any other reason, is marked as ready to
run.</p>
<p>The function <code>Signal(aCount)</code> is equivalent to calling
<code>Signal()</code>
<code>aCount</code> times.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aCount </code></td>
<td class="Cell"><p class="ValueDesc"> The number of times the semaphore is to be signalled. If this parameter
is not specified, the semaphore is signalled once. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aRSemaphore%3a%3aCount%28%29"></a>
<hr size="1" noshade>
<h3><code>Count()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Count();</code></p><h4 class="subheading">Description</h4>
<p>Gets the current value of the semaphore count.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> The current value of the semaphore count. </p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
