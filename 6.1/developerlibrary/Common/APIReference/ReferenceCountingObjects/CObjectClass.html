<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CObject</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="index.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CObjectConClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Reference&nbsp;Counting&nbsp;Objects</a>&nbsp;<span class="separator">&#187;</span>
CObject</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>e32base.h</code>
<br>Link against: <code>euser.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCObject"></a>

<h1>Class <code>CObject</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CObject</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Implements  reference counting to track concurrent references to itself.</p>
<p>An object of this type arranges  automatic destruction of itself when the final
reference is removed.</p>
<p>A reference counting object is any object which has <code>CObject</code> as its base class.
Constructing a <code>CObject</code> derived type or calling its <code>Open()</code> member function adds a reference to that object by adding one to the reference count; calling its <code>Close()</code> member function removes a reference by subtracting one from the reference count; when the last user of the object calls <code>Close()</code>, the reference count becomes zero and the object is automatically destroyed.</p><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CObject</code></td><td class="Cell">Implements reference counting to track concurrent references to itself</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CObject</code>:
<br><code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aAccessCount%28%29" title="Gets the number of open references to this reference counting object">AccessCount()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aCObject%28%29" title="Constructs the object and initializes the reference count to one">CObject()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aClose%28%29" title="Closes this reference counting object">Close()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aDec%28%29" title="Subtracts one from the reference count">Dec()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aFullName%28%29" title="Gets the full name of this reference counting object">FullName()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aInc%28%29" title="Adds one to the reference count">Inc()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aName%28%29" title="Gets the name of this reference counting object">Name()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aOpen%28%29" title="Opens this reference counting object">Open()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aOwner%28%29" title="Gets a pointer to the reference counting object which owns this reference counting object">Owner()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aSetName%28%29" title="Sets or clears this reference counting object's name">SetName()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aSetNameL%28%29" title="Sets or clears this reference counting object's name">SetNameL()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aSetOwner%28%29" title="Sets the owner of this reference counting object">SetOwner()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3aUniqueID%28%29" title="Gets this reference counting object's unique ID">UniqueID()</a></code>, <code class="ApiItem"><a href="CObjectClass.html#%3a%3aCObject%3a%3a%7eCObject%28%29" title="Destructor">~CObject()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<a name="2.6"></a></div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aCObject%28%29"></a>
<hr size="1" noshade>
<h3><code>CObject()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CObject();</code></p><h4 class="subheading">Description</h4>
<p>Constructs the object and  initializes the reference count to one.
</p><p>Once constructed, a reference counting object cannot be deleted until its reference count is reduced to zero.
</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="CObjectClass.html#%3a%3aCObject%3a%3aClose%28%29" title="Closes this reference counting object"><code class="ApiItem">CObject::Close()</code></a></li>
</ul>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3a%7eCObject%28%29"></a>
<hr size="1" noshade>
<h3><code>~CObject()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CObject();</code></p><h4 class="subheading">Description</h4>
<p>Destructor.</p><p>It removes this reference counting object from its object container, a <code>CObjectCon</code> type.</p><p>The reference count must always be zero when the destructor is called, otherwise it raises an E32USER-CBase 33 panic.</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="CObjectConClass.html#%3a%3aCObjectCon" title="An object container"><code class="ApiItem">CObjectCon</code></a></li>
</ul>
<a name="2.7"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Opening and closing</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TInt Open();</code></p><h4 class="subheading">Description</h4>
<p>Opens this reference counting object.</p><p>The default behaviour  increments the reference count by one and returns <code>KErrNone</code>.
Where a derived class implements its own version of this function, it must either use the protected member function <code>Inc()</code> to increment the reference count or make a base call to this function.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNone</code>.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Close();</code></p><h4 class="subheading">Description</h4>
<p>Closes this reference counting object.</p><p>The default behaviour  decrements the reference count by one. If this becomes zero, then the function deletes this reference counting object.</p><p> Where a derived class implements its own version of this function, it can use the protected member function Dec() to decrement the reference count or make a base call to this function.</p><p>
The reference count must not be negative when this function is called, otherwise it raises an E32USER-CBase 34 panic.</p>
<a name="2.8"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Naming an object</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aName%28%29"></a>
<hr size="1" noshade>
<h3><code>Name()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TName Name() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the name of this reference counting object.</p><p>The default behaviour provided by this function depends on whether a name has been explicitly set into the object:</p><ul><li><p> if a name has previously been set, then the function returns that name.</p></li><li><p>
if a name has not been set, then the function builds a default name. This is fourteen characters and has the format:
LOCAL-nnnnnnnn
where nnnnnnnn is the hexadecimal character representation of this reference counting object's address. This default name is, therefore, guaranteed to be unique within the current process.</p></li></ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TName</code></td>
<td class="Cell"><p class="ValueDesc">A modifiable buffer descriptor with a defined maximum length containing the name of this reference counting object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aFullName%28%29"></a>
<hr size="1" noshade>
<h3><code>FullName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual TFullName FullName() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the full  name of this reference counting object.</p><p>By default, the full name is a concatenation of this reference counting object's name with the full name of its owning reference counting object.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TFullName</code></td>
<td class="Cell"><p class="ValueDesc">A modifiable buffer descriptor with a defined maximum length containing the full name of this reference counting object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aSetName%28%29"></a>
<hr size="1" noshade>
<h3><code>SetName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetName(const TDesC* aName);</code></p><h4 class="subheading">Description</h4>
<p>Sets or clears this reference counting object's name.</p><p>To set the name, the specified descriptor must contain the name to be set. Once the name has been successfully set, then the specified source descriptor can be discarded.</p><p>To clear an existing name, specify a  NULL argument.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC* aName</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the descriptor containing the name to be set, or NULL if an existing name is to be cleared. The length of this descriptor must not be greater than <code>KMaxName</code>, otherwise the function raises a USER 11 panic if the descriptor is a 16 bit variant or a USER 23 panic if the descriptor is an 8 bit variant.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc"><code> KErrNone</code>, if the function is successful; <code>KerrNoMemory</code>, if there is insufficient memory available.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.5"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aSetNameL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetNameL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetNameL(const TDesC* aName);</code></p><h4 class="subheading">Description</h4>
<p>Sets or clears this reference counting object's name.</p><p>To set the name, the specified descriptor must contain the name to be set. Once the name has been successfully set, then the specified source descriptor can be discarded.</p><p>To clear an existing name, specify a  NULL argument.</p><p>The function leaves if there is insufficient memory.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC* aName</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the descriptor containing the name to be set, or NULL if an existing name is to be cleared. The length of this descriptor must not be greater than <code>KMaxName</code>, otherwise the function raises a USER 11 panic if the descriptor is a 16 bit variant or a USER 23 panic if the descriptor is an 8 bit variant.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Ownership</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aOwner%28%29"></a>
<hr size="1" noshade>
<h3><code>Owner()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CObject* Owner() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets a pointer to the reference counting object which owns this reference counting object.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CObject*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the owning reference counting object.
This is NULL, if there is no owner.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aSetOwner%28%29"></a>
<hr size="1" noshade>
<h3><code>SetOwner()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetOwner(CObject* anOwner);</code></p><h4 class="subheading">Description</h4>
<p>Sets the owner of this reference counting object.</p><p>If  this reference counting object already has an owner, then all knowledge of this owner is lost.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CObject* anOwner</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the reference counting object which is to be the new owner of this reference counting
object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Diagnostic information</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aAccessCount%28%29"></a>
<hr size="1" noshade>
<h3><code>AccessCount()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt AccessCount() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the number of open references to this reference counting object.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The number of open references.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Changing the reference count</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aInc%28%29"></a>
<hr size="1" noshade>
<h3><code>Inc()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>protected: void Inc();</code></p><h4 class="subheading">Description</h4>
<p>Adds one to the reference count.</p><p>This function is called by the default implementation of the <code>Open()</code>  member function of this class.</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="CObjectClass.html#%3a%3aCObject%3a%3aOpen%28%29" title="Opens this reference counting object"><code class="ApiItem">CObject::Open()</code></a></li>
</ul>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aDec%28%29"></a>
<hr size="1" noshade>
<h3><code>Dec()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>protected: void Dec();</code></p><h4 class="subheading">Description</h4>
<p>Subtracts  one from the reference count.</p><p>This function is called by the default implementation of the <code>Close()</code>  member function of this class.</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="CObjectClass.html#%3a%3aCObject%3a%3aClose%28%29" title="Closes this reference counting object"><code class="ApiItem">CObject::Close()</code></a></li>
</ul>
<a name="2.12"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Unique ID</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCObject%3a%3aUniqueID%28%29"></a>
<hr size="1" noshade>
<h3><code>UniqueID()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>protected: TInt UniqueID() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets this reference counting object's unique ID.</p><p>The unique ID is an integer which is a property of the object container. It forms part of the identity of all reference counting
objects and is the same value for all reference counting objects held within the same object container.</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="CObjectConClass.html#%3a%3aCObjectCon" title="An object container"><code class="ApiItem">CObjectCon</code></a></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
