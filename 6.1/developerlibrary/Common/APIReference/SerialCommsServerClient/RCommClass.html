<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RComm</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="AboutSerialCommsServerClient.guide.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="RCommServClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Serial&nbsp;Communications&nbsp;Server&nbsp;Client-Side</a>&nbsp;<span class="separator">&#187;</span>
RComm</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> c32comm.h </code>
<br>Link against: <code> c32.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aRComm"></a>

<h1>Class <code>RComm</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RComm</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>A serial port. It provides all the necessary functions for
communicating via a port, including functions for opening, closing, reading,
writing, together with port configuration and capability checking.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code>RComm</code></td><td class="Cell">A serial port</td>
</tr>
<tr><td class="Cell"><code><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase">RSubSessionBase</a></code></td><td class="Cell">Client-side handle to a sub-session</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>RComm</code>:
<br><code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3a%20OpenWhenAvailableCancel%28%29" title="Cancels an OpenWhenAvailable() request"> OpenWhenAvailableCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aBreak%28%29" title="Sets a break condition for a specified time">Break()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aBreakCancel%28%29" title="Cancels any pending Break() operations">BreakCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aCancel%28%29" title="Cancels any pending reads and writes">Cancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aCaps%28%29" title="Reads the capabilities of the serial port">Caps()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aClose%28%29" title="Closes a serial port">Close()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aConfig%28%29" title="Reads the current configuration of the serial port">Config()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aGetFlowControlStatus%28%29" title="Gets the current status of flow control between the port and the third party (external PC or internal signalling stack)">GetFlowControlStatus()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aGetRole%28%29" title="Gets current DCE/DTE role">GetRole()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aMode%28%29" title="Gets server buffering mode">Mode()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyBreak%28%29" title="Notifies the client when a break occurs: the remote end has held the communication line high for a certain number of bits to indicate a break condition">NotifyBreak()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyBreakCancel%28%29" title="Cancels a NotifyBreakCancel() request">NotifyBreakCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyConfigChange%28%29" title="Notifies the client when the port configuration (data rate, character width, stop bits, handshaking, or parity) of the remote end changes">NotifyConfigChange()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyConfigChangeCancel%28%29" title="Cancels a NotifyConfigChangeCancel() request">NotifyConfigChangeCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyDataAvailable%28%29" title="Notifies the client when data is available to be read from the input buffer">NotifyDataAvailable()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyDataAvailableCancel%28%29" title="Cancels a NotifyDataAvailableCancel() request">NotifyDataAvailableCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyFlowControlChange%28%29" title="Notifies the client when the flow control between the CSY and the external device changes">NotifyFlowControlChange()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyFlowControlChangeCancel%28%29" title="Cancels a NotifyFlowControlChangeCancel() request">NotifyFlowControlChangeCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyOutputEmpty%28%29" title="Notifies the client when the transmit buffer is emptied">NotifyOutputEmpty()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifyOutputEmptyCancel%28%29" title="Cancels a NotifyOutputEmptyCancel() request">NotifyOutputEmptyCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifySignalChange%28%29" title="Notifies the client when one of the signals change">NotifySignalChange()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aNotifySignalChangeCancel%28%29" title="Cancels a NotifySignalChange() request">NotifySignalChangeCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aOpen%28%29" title="Opens a serial port, as described for the previous function">Open()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aOpenWhenAvailable%28%29" title="Opens a serial port when it is freed by another client">OpenWhenAvailable()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aQueryReceiveBuffer%28%29" title="Gets the number of bytes currently waiting in the driver's input buffer">QueryReceiveBuffer()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aRead%28%29" title="Reads data from a serial port">Read()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aReadCancel%28%29" title="Cancels any pendingRead()orReadOneOrMore()operations">ReadCancel()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aReadOneOrMore%28%29" title="Reads data from a serial port, but with slightly different behaviour toRead()">ReadOneOrMore()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aReceiveBufferLength%28%29" title="Gets the size of the serial port buffers">ReceiveBufferLength()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aResetBuffers%28%29" title="Resets the serial port buffers">ResetBuffers()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetAccessMode%28%29" title="Upgrades the mode of a port handle from pre-emptive mode to shared or exclusive mode">SetAccessMode()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetConfig%28%29" title="Sets the configuration of the serial port">SetConfig()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetMode%28%29" title="Sets the server buffering mode">SetMode()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetReceiveBufferLength%28%29" title="Sets the size of the serial port receive and transmit buffers">SetReceiveBufferLength()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetSignals%28%29" title="Sets or clears RS232 output lines (DTR and RTS)">SetSignals()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetSignalsToMark%28%29" title="Sets the specified RS232 output lines">SetSignalsToMark()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSetSignalsToSpace%28%29" title="Clears RS232 output lines">SetSignalsToSpace()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aSignals%28%29" title="Reads the status of the RS232 input and output lines (RTS, CTS, DSR, DCD, DTR)">Signals()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aWrite%28%29" title="Writes data to a serial port">Write()</a></code>, <code class="ApiItem"><a href="RCommClass.html#%3a%3aRComm%3a%3aWriteCancel%28%29" title="Cancels any pending Write() operations">WriteCancel()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase" title="Client-side handle to a sub-session">RSubSessionBase</a></code>:
<br><code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aCloseSubSession%28%29" title="Closes the sub-session">CloseSubSession()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aCreateSubSession%28%29" title="Creates a new sub-session within an existing session">CreateSubSession()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aSend%28%29" title="Sends a blind message to the server -- no reply is expected">Send()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aSendReceive%28%29" title="Sends a message to the server and waits synchronously for a reply">SendReceive()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aSubSessionHandle%28%29" title="Returns the sub-session handle number">SubSessionHandle()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aoperator%3d%28%29" title="Assignment constructor">operator=()</a></code></p>
<a name="SerialCommsServerClient%2eRComm%2eopen"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Opening ports</h2>
</div><div class="Bodytext">
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Open(RCommServ &amp;aServer, const TDesC &amp;aName,TCommAccess aMode);</code></p><h4 class="subheading">Description</h4>
<p>Opens a serial port, for one of the three modes indicated by
the <code>TCommAccess</code> argument. This may dictate exclusive use of the
<code>RComm</code>, shared use (giving permission for the port to be shared by
other <code>RComm</code>s) or pre-emptable use (allowing another client to
pre-empt this session with an open request in one of the other two modes). The
request will fail if the port does not exist, or if it has been opened in
exclusive mode elsewhere. If the port has been opened in shared mode elsewhere,
the request will fail if a subsequent attempt is made to open it in exclusive
mode.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RCommServ &amp;aServer </code></td>
<td class="Cell"><p class="ValueDesc"> The comms server session </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC &amp;aName </code></td>
<td class="Cell"><p class="ValueDesc"> The name of the port </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommAccess aMode </code></td>
<td class="Cell"><p class="ValueDesc"> The mode in which the port is opened. There is no default.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code. <code>KErrLocked</code> if the port
has already been opened in the opposite role elsewhere. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Open(RCommServ &amp;aServer, const TDesC &amp;aName,TCommAccess aMode,TCommRole aRole);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a serial port, as described for the previous function. It
allows the port to be opened in either DTE role or DCE role. This latter role
means that the lines are configured as for a port of a modem. DTR and RTS are
inputs while the other signals are outputs.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RCommServ &amp;aServer </code></td>
<td class="Cell"><p class="ValueDesc"> The comms server session </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC &amp;aName </code></td>
<td class="Cell"><p class="ValueDesc"> The name of the port </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommAccess aMode </code></td>
<td class="Cell"><p class="ValueDesc"> The mode in which the port is opened. There is no default.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommRole aRole </code></td>
<td class="Cell"><p class="ValueDesc"> DTE/DCE role </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code. <code>KErrLocked</code> if the port
has already been opened in the opposite role elsewhere. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.5"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aOpenWhenAvailable%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenWhenAvailable()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void OpenWhenAvailable(TRequestStatus&amp; aStatus, RCommServ &amp;aServer, const TDesC &amp;aName);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a serial port when it is freed by another client. When a
client has a port open in either exclusive or shared mode, another client may
use this function to gain access to the port when the owning client closes its
handle. Upon closure, the asynchronous <code>OpenWhenAvailable()</code>
function will complete. The port role, DTE or DCE, is not be changed by this
request and so the role will be inherited from the previous session. The port
is automatically opened in pre-emptive mode. This can be subsequently upgraded
to shared or exclusive mode using the <code>SetAccessMode()</code>
function.</p>
<p>Notes:</p>
<p>If client submits an <code>OpenWhenAvailable()</code> request and
then attempts to execute an action, for example a read or write request, before
the <code>OpenWhenAvailable()</code> has completed, the action will fail with
the <code>KErrNotReady</code> error code.</p>
<p>The server can only support one <code>OpenWhenAvailable()</code>
request per port. For example, if client A has a port open in exclusive mode
and client B has an <code>OpenWhenAvailable()</code> request pending, then
client C’s <code>OpenWhenAvailable()</code> request will fail with the
<code>KErrAccessDenied</code> error code.</p>
<p>The server is designed to support the
<code>OpenWhenAvailable()</code> request dispatched from a different
<code>RCommServ</code> session than the one actively using the port. This is
not viewed as a major disadvantage since, in practice, the two clients will
normally be running in different threads, and quite probably different
processes.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RCommServ &amp;aServer </code></td>
<td class="Cell"><p class="ValueDesc"> The comms server session </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC &amp;aName </code></td>
<td class="Cell"><p class="ValueDesc"> The name of the port </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.6"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3a%20OpenWhenAvailableCancel%28%29"></a>
<hr size="1" noshade>
<h3><code> OpenWhenAvailableCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void OpenWhenAvailableCancel();</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels an <code>OpenWhenAvailable()</code>
request.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Closing ports</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Close();</code></p><h4 class="subheading">Description</h4>
<p>Closes a serial port. </p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Configuring Ports</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>Cancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Cancel();</code></p><h4 class="subheading">Description</h4>
<p>Cancels any pending reads and writes.</p>
<p>A panic will result if an attempt is made to reconfigure a port if there
are any pending reads or writes. Use this function before configuring a port if
there is any doubt as to whether it is safe to do so. It isn&#8217;t necessary
to call <code>Cancel()</code> before closing a port as this is done
automatically.</p>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aCaps%28%29"></a>
<hr size="1" noshade>
<h3><code>Caps()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Caps(TDes8&amp; aCaps);</code></p><h4 class="subheading">Description</h4>
<p>Reads the capabilities of the serial port.</p>
<p>As the serial driver can control a range of different physical devices
with differing capabilities, it could be considered important from the point of
view of the operating system to be able to read these capabilities before
attempting to configure the port. In practice however, program development is
likely to be targeted at a specific hardware configuration, and interrogation
of a device to ascertain its capabilities isn&#8217;t normally
necessary.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aCaps </code></td>
<td class="Cell"><p class="ValueDesc"> On return this descriptor will contain either a
packaged<code>TCommCapsV01</code> structure or a
packaged<code>TCommCapsV02</code>structure corresponding to the capabilities of
the serial device and of the CSY module, depending on the size of the
descriptor passed in to the function.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aConfig%28%29"></a>
<hr size="1" noshade>
<h3><code>Config()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Config(TDes8 &amp;aConfig) const;</code></p><h4 class="subheading">Description</h4>
<p>Reads the current configuration of the serial port.</p>
<p>It isn&#8217;t essential to read an existing configuration in order to
set a new one. However, calling this function is a useful way of initializing
a<code>TCommConfig</code> structure and thus avoiding the overhead of having to
explicitly set every member. If a port were being shared between difference
processes, it would also be good manners to save an existing configuration
before using the port in order than it might be restored when you have finished
with it.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8 &amp;aConfig </code></td>
<td class="Cell"><p class="ValueDesc"> On return, a <code>TCommConfig</code> package buffer holding the
configuration settings </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.5"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetAccessMode%28%29"></a>
<hr size="1" noshade>
<h3><code>SetAccessMode()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetAccessMode(TCommAccess aNewMode);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Upgrades the mode of a port handle from pre-emptive mode to shared or
exclusive mode.</p>
<p>Notes:</p>
<p>If a client attempts to change the mode of a port that is already in
either shared or exclusive modes, the request will fail with
the<code>KErrNotSupported</code> error code.</p>
<p>Clients should not attempt to change the access mode to pre-emptive, the
behaviour in this case is unpredictable.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TCommAccess aNewMode</code></td>
<td class="Cell"><p class="ValueDesc">The value of the new port mode,
either<code>ECommShared</code>or<code>ECommExclusive</code></p></td>
</tr>
</table></td></tr></table>
<a name="2.8.6"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetConfig%28%29"></a>
<hr size="1" noshade>
<h3><code>SetConfig()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetConfig(const TDesC8 &amp;aConfig);</code></p><h4 class="subheading">Description</h4>
<p>Sets the configuration of the serial port.</p>
<p>It is not possible to reconfigure the capabilities of ports while they
are being used. In particular, the comms server will panic any client that
attempts to reconfigure a port when there are pending reads or writes.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8 &amp;aConfig </code></td>
<td class="Cell"><p class="ValueDesc"> New configuration settings packaged in a <code>TCommConfig</code></p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.7"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetSignals%28%29"></a>
<hr size="1" noshade>
<h3><code>SetSignals()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetSignals(TUint aSetMask,TUint aClearMask);</code></p><h4 class="subheading">Description</h4>
<p>Sets or clears RS232 output lines (DTR and RTS).</p>
<p>For many applications, these lines will be read and set under driver
control as determined by the handshaking options selected.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSetMask </code></td>
<td class="Cell"><p class="ValueDesc"> Set the handshaking lines in the mask. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aClearMask </code></td>
<td class="Cell"><p class="ValueDesc"> Clear the handshaking lines in the mask. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CsConfigConstants.html#SerialCommsServerClient%2econfig%2esignal%2dconstants" title="Configuration constants / Signal line constants">Signal line constants</a></li>
</ul>
<a name="2.8.8"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetSignalsToMark%28%29"></a>
<hr size="1" noshade>
<h3><code>SetSignalsToMark()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetSignalsToMark(TUint aSignalMask);</code></p><h4 class="subheading">Description</h4>
<p>Sets the specified RS232 output lines.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSignalMask </code></td>
<td class="Cell"><p class="ValueDesc"> Bitmask of handshaking lines </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CsConfigConstants.html#SerialCommsServerClient%2econfig%2esignal%2dconstants" title="Configuration constants / Signal line constants">Signal line constants</a></li>
</ul>
<a name="2.8.9"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetSignalsToSpace%28%29"></a>
<hr size="1" noshade>
<h3><code>SetSignalsToSpace()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetSignalsToSpace(TUint aSignalMask);</code></p><h4 class="subheading">Description</h4>
<p>Clears RS232 output lines.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSignalMask </code></td>
<td class="Cell"><p class="ValueDesc"> Bitmask of handshaking lines </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CsConfigConstants.html#SerialCommsServerClient%2econfig%2esignal%2dconstants" title="Configuration constants / Signal line constants">Signal line constants</a></li>
</ul>
<a name="2.8.10"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSignals%28%29"></a>
<hr size="1" noshade>
<h3><code>Signals()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TUint Signals(TUint aSignalMask=0x3F) const;</code></p><h4 class="subheading">Description</h4>
<p>Reads the status of the RS232 input and output lines (RTS, CTS, DSR, DCD,
DTR). They are bit-masked into a single integer and one or all of them can be
read at any time.</p>
<p>Not all of the input lines are guaranteed to be available on all serial
devices. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSignalMask </code></td>
<td class="Cell"><p class="ValueDesc"> Bitmask of lines to read. It defaults to all lines (<code>0x3f</code> as
only the top six bits of this integer are valid). A different value can be
specified as <code>aSignalMask</code> if specific information is required: for
instance, <code>Signals(KSignalDSR)</code> could be used to find out if a modem
were connected to the serial port. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> An integer with the bits set to reflect the status of the handshaking
lines </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CsConfigConstants.html#SerialCommsServerClient%2econfig%2esignal%2dconstants" title="Configuration constants / Signal line constants">Signal line constants</a></li>
</ul>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reading from ports</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aRead%28%29"></a>
<hr size="1" noshade>
<h3><code>Read()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Read(TRequestStatus &amp;aStatus, TDes8 &amp;aDes);<br>void Read(TRequestStatus &amp;aStatus, TDes8 &amp;aDes, TInt aLength);<br>void Read(TRequestStatus &amp;aStatus, TTimeIntervalMicroSeconds32 aTimeOut,TDes8 &amp;aDes);<br>void Read(TRequestStatus &amp;aStatus, TTimeIntervalMicroSeconds32 aTimeOut,TDes8 &amp;aDes, TInt aLength);</code></p><h4 class="subheading">Description</h4>
<p>Reads data from a serial port. All reads from the serial device use 8-bit
descriptors as data buffers, even on a Unicode system.</p>
<p>Note:</p>
<ul>
<li>
<p>The length of the <code>TDes8</code> is set to zero on entry, which means
that buffers can be reused without having to be zeroed first.</p>
</li>
<li>
<p>The amount of data to be read from the serial driver depends upon which
overload of <code>Read()</code> is used. Normally the length used is the
maximum length of the descriptor. In the version which takes an explicit length
this value is used in preference to the descriptor&#8217;s maximum
length.</p>
</li>
<li>
<p>If a read is issued with a data length of zero (either explicitly or
implicit in the descriptor) the <code>Read()</code> will complete immediately
with the side effect that the serial hardware will have been powered up.</p>
</li>
<li>
<p>In the case of a read terminating with <code>KErrTimedOut</code>,
different protocol modules may show different behavior. Some may write any data
received into the <code>aDes</code> buffer. Others may always return an empty
descriptor: in that case, any data in the buffer can be read
through<code>ReadOneOrMore()</code>.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus &amp;aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> The request status used to contain completion information for the
function. On completion, contains System-wide error code </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TTimeIntervalMicroSeconds32 aTimeOut </code></td>
<td class="Cell"><p class="ValueDesc"> If present, the read will terminate
after<code>aTimeout</code>microseconds if the data requested has not arrived.
A<code>KErrTimedOut</code>status is returned<code>.</code>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8 &amp;aDes </code></td>
<td class="Cell"><p class="ValueDesc"> A buffer to store the incoming data. The length of the descriptor is the
default for the number of bytes to be read. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aLength </code></td>
<td class="Cell"><p class="ValueDesc"> An optional explicit length of data to be read. If present, this
overrides the length of the <code>TDes8</code> default </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aReadCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>ReadCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ReadCancel();</code></p><h4 class="subheading">Description</h4>
<p>Cancels any
pending<code>Read()</code>or<code>ReadOneOrMore()</code>operations.</p>
<p>The cancelled request will still terminate with its TRequestStatus set to
any value other than KErrPending. While this is most likely to be KErrCancel,
it is nevertheless possible for the cancellation to have been issued after the
asynchronous request had already terminated for some other reason.</p>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aReadOneOrMore%28%29"></a>
<hr size="1" noshade>
<h3><code>ReadOneOrMore()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ReadOneOrMore(TRequestStatus &amp;aStatus,TDes8 &amp;aDes);</code></p><h4 class="subheading">Description</h4>
<p>Reads data from a serial port, but with slightly different behaviour
to<code>Read()</code>. If there is data in the serial driver&#8217;s buffer
when<code>ReadOneOrMore()</code> is called, it will read as much data as
possible (up to the maximum length of the supplied buffer) and return
immediately. If there is no data in the buffer, the request will complete as
soon as the first character arrives at the serial hardware.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus &amp;aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> The request status used to contain completion information for the
function. On completion, contains System-wide error code </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8 &amp;aDes </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor to a buffer. When the request completes this will hold data
read from the input buffer. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Writing to ports</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aWrite%28%29"></a>
<hr size="1" noshade>
<h3><code>Write()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Write(TRequestStatus &amp;aStatus,const TDesC8 &amp;aDes);<br>void Write(TRequestStatus &amp;aStatus,const TDesC8 &amp;aDes, TInt aLength);<br>void Write(TRequestStatus &amp;aStatus, TTimeIntervalMicroSeconds32 aTimeOut,const TDesC8 &amp;aDes);<br>void Write(TRequestStatus &amp;aStatus, TTimeIntervalMicroSeconds32 aTimeOut,const TDesC8 &amp;aDes, TInt aLength);</code></p><h4 class="subheading">Description</h4>
<p>Writes data to a serial port. All writes to the serial device use 8-bit
descriptors as data buffers, even on a Unicode system.</p>
<p>Note:</p>
<ul>
<li>
<p>The amount of data to be written to the serial driver depends upon which
overload of <code>Write()</code> is used. Normally the length used is the
current length of the descriptor. In the version which takes an explicit
length, this value is used in preference to the descriptor's length.</p>
</li>
<li>
<p>If a write is issued with a data length of zero (either explicitly or
implicit in the descriptor) the <code>Write()</code> will complete when the
current handshaking configuration and the state of input control lines would
allow any data to be immediately written to the serial line. This functionality
is useful to determine when serial devices come on line, and to check that the
output buffer is empty if <code>KConfigWriteBufferedComplete</code> is
set.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TrequestStatus &amp;aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> The request status used to contain completion information for the
function. On completion, contains System-wide error code </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TtimeIntervalMicroSeconds32 aTimeOut </code></td>
<td class="Cell"><p class="ValueDesc"> If present, the read will terminate
after<code>aTimeout</code>microseconds if the data requested has not been sent.
A<code>KErrTimedOut</code> status is returned<code>.</code>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> Const TDesC8 &amp;aDes </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor to a buffer containing the data to be written to the serial
port </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aLength </code></td>
<td class="Cell"><p class="ValueDesc"> An optional explicit length of data to be written. This can be used to
override the length implicit in the buffer&#8217;s descriptor. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aWriteCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>WriteCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void WriteCancel();</code></p><h4 class="subheading">Description</h4>
<p>Cancels any pending <code>Write()</code> operations.</p>
<p>The cancelled request will still terminate with its TRequestStatus set,
to any value other than KErrPending. While this is most likely to be
KErrCancel, it is nevertheless possible for the cancellation to have been
issued after the asynchronous request had already terminated for some other
reason.</p>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Buffer management</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aMode%28%29"></a>
<hr size="1" noshade>
<h3><code>Mode()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Mode(TCommServerConfig &amp;aConfig)const;</code></p><h4 class="subheading">Description</h4>
<p>Gets server buffering mode.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommServerConfig &amp;aConfig </code></td>
<td class="Cell"><p class="ValueDesc"> A packaged <code>TCommServerConfigV01</code> structure which will hold
the required information on return. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aQueryReceiveBuffer%28%29"></a>
<hr size="1" noshade>
<h3><code>QueryReceiveBuffer()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt QueryReceiveBuffer() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the number of bytes currently waiting in the driver&#8217;s input
buffer. A return value of zero means the buffer is empty.</p>
<p>It is not possible to find out exactly how many bytes are currently in
the driver&#8217;s output buffer waiting to be transmitted. However, this is
not an issue since it is easy to ensure that the output buffer is empty.
If<code>KConfigWriteBufferedComplete</code> is clear then all write requests
will delay completion until the data has completely cleared the driver&#8217;s
output buffer. If <code>KConfigWriteBufferedComplete</code> is set, a write of
zero bytes to a port which has data in the output buffer is guaranteed to delay
completion until the buffer has been fully drained.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> Tint </code></td>
<td class="Cell"><p class="ValueDesc"> The number of bytes currently waiting to be read from the receive
buffer. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aReceiveBufferLength%28%29"></a>
<hr size="1" noshade>
<h3><code>ReceiveBufferLength()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt ReceiveBufferLength() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the size of the serial port buffers. Despite its name, this function
returns the size of both the receive and transmit buffers, which are
(obviously) always the same size.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> The current size of both the receive and transmit buffers in
bytes..</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.5"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aResetBuffers%28%29"></a>
<hr size="1" noshade>
<h3><code>ResetBuffers()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResetBuffers();<br>void ResetBuffers(TUint aFlags);</code></p><h4 class="subheading">Description</h4>
<p>Resets the serial port buffers. By default, if no argument is passed,
both the receive and transmit buffers are reset to zero length, and all data in
the them is lost. Alternatively, either buffer can be reset
independently.</p>
<p>Note:</p>
<ul>
<li>
<p><code>aFlags</code> is a bitmask, so
setting<code>KCommResetRx|KCommResetTx</code> (the default) resets both
buffers</p>
</li>
<li>
<p>this function should not be called when there are pending reads or
writes</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFlags </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KCommResetRx</code> to reset the receive
buffer<code>KCommResetTx</code> to reset the transmit buffer </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.6"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetMode%28%29"></a>
<hr size="1" noshade>
<h3><code>SetMode()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetMode(const TCommServerConfig &amp;aConfig);</code></p><h4 class="subheading">Description</h4>
<p>Sets the server buffering mode. This function can be used to set either
buffering mode, and if partial buffering is being used, it can also set the
size of the buffer that the server will use. These items are packaged up into
the <code>TCommServerConfig</code> descriptor.</p>
<p>The default of full buffering is nearly always going to be the quicker
option, as only a single client-server data transfer is ever needed. The mode
should not be changed by an application without a very good reason (such as
memory constraints) otherwise performance is liable to suffer.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TCommServerConfig &amp;aConfig </code></td>
<td class="Cell"><p class="ValueDesc"> A packaged <code>TCommServerConfigV01</code> structure to be set </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.7"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aSetReceiveBufferLength%28%29"></a>
<hr size="1" noshade>
<h3><code>SetReceiveBufferLength()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetReceiveBufferLength(TInt aLength);</code></p><h4 class="subheading">Description</h4>
<p>Sets the size of the serial port receive and transmit buffers.</p>
<p>Note:</p>
<ul>
<li>
<p>There is no error code returned by this function. If the buffer is set to
too large a figure, the request is simply ignored. If you are in any doubt
about the success of a <code>SetReceiveBufferLength</code> request, you should
examine the returned value from <code>ReceiveBufferLength</code>. </p>
</li>
<li>
<p>It isn&#8217;t always essential to set a buffer size as there is a
generous default of 1024. </p>
</li>
<li>
<p>Changing the size of the receive buffer is the only way to tailor the
operation of flow control in EPOC as the exact position of the high water mark
is not configurable.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aLength </code></td>
<td class="Cell"><p class="ValueDesc"> The required size of the receive and transmit buffers in bytes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Setting a break condition</h2>
</div><div class="Bodytext">
<h4 class="subheading">Description</h4>
<p>Note:</p>
<p>A break condition on a line is when a data line is held permanently high
for an indeterminate period which must be greater than the time normally taken
to transmit two characters. It is sometimes used as an error signal between
computers and other devices attached to them over RS232 lines.</p>
<ul>
<li>
<p>Setting breaks is not supported on the integral ARM serial
hardware.</p>
</li>
<li>
<p>EPOC has no support for detecting received breaks.</p>
</li>
<li>
<p>There is no way to detects whether setting a break is supported
using<code>Caps()</code>.</p>
</li>
</ul>
<a name="2.12.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aBreak%28%29"></a>
<hr size="1" noshade>
<h3><code>Break()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Break(TRequestStatus &amp;aStatus, TTimeIntervalMicroSeconds32 aTime);</code></p><h4 class="subheading">Description</h4>
<p>Sets a break condition for a specified time.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus &amp;aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> The request status used to contain completion information for the
function. On completion, contains a System-wide error code.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TTimeIntervalMicroSeconds32 aTime </code></td>
<td class="Cell"><p class="ValueDesc"> A timed break period in microseconds </p></td>
</tr>
</table></td></tr></table>
<a name="2.12.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aBreakCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>BreakCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void BreakCancel();</code></p><h4 class="subheading">Description</h4>
<p>Cancels any pending <code>Break()</code> operations.</p>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Notifications</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifySignalChange%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifySignalChange()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifySignalChange(TRequestStatus&amp; aStatus, TUint&amp; aSignals, TUint aSignalMask=0x3F);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when one of the signals change.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint&amp; aSignals </code></td>
<td class="Cell"><p class="ValueDesc"> On return, the new set of signals. The bottom five bits contain a mask
of the signals that are set (using the Signal line constants). The top four
bits store which signal has changed (using the Signal line changed
constants).</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSignalMask=0x3F </code></td>
<td class="Cell"><p class="ValueDesc"> Bitmaks of the signals to monitor. The default is all signals. See
also<code>KSignalDTEOutputs</code> and <code>KSignalDTEInputs</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="CsConfigConstants.html#SerialCommsServerClient%2econfig%2esignal%2dconstants" title="Configuration constants / Signal line constants">Signal line constants</a></li>
<li><a href="SignalChangeConstants.html#SerialCommsServerClient%2econfig%2esignalchanged%2dconstants">Signal line changed constants</a></li>
</ul>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifySignalChangeCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifySignalChangeCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifySignalChangeCancel() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifySignalChange()</code> request.</p>
<a name="2.13.4"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyConfigChange%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyConfigChange()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyConfigChange(TRequestStatus&amp; aStatus, TDes8&amp; aNewConfig) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when the port configuration (data rate, character
width, stop bits, handshaking, or parity) of the remote end changes.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; aNewConfig </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, a packaged <code>TCommNotificationV01</code>
</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.5"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyConfigChangeCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyConfigChangeCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyConfigChangeCancel() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifyConfigChangeCancel()</code> request.</p>
<a name="2.13.6"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyFlowControlChange%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyFlowControlChange()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyFlowControlChange(TRequestStatus&amp; aStatus, TFlowControl&amp; aFlowControl);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when the flow control between the CSY and the
external device changes.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TFlowControl&amp; aFlowControl </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, new flow control status </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.7"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyFlowControlChangeCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyFlowControlChangeCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyFlowControlChangeCancel() const;  </code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifyFlowControlChangeCancel()</code> request.</p>
<a name="2.13.8"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyBreak%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyBreak()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyBreak(TRequestStatus&amp; aStatus) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when a break occurs: the remote end has held the
communication line high for a certain number of bits to indicate a break
condition</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.9"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyBreakCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyBreakCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyBreakCancel() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifyBreakCancel()</code> request.</p>
<a name="2.13.10"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyDataAvailable%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyDataAvailable()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyDataAvailable(TRequestStatus&amp; aStatus) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when data is available to be read from the input
buffer.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.11"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyDataAvailableCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyDataAvailableCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyDataAvailableCancel() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifyDataAvailableCancel()</code> request.</p>
<a name="2.13.12"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyOutputEmpty%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyOutputEmpty()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyOutputEmpty(TRequestStatus&amp; aStatus) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Notifies the client when the transmit buffer is emptied.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> Asynchronous completion status </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.13"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aNotifyOutputEmptyCancel%28%29"></a>
<hr size="1" noshade>
<h3><code>NotifyOutputEmptyCancel()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NotifyOutputEmptyCancel() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels a <code>NotifyOutputEmptyCancel()</code> request.</p>
<a name="2.14"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Information</h2>
</div><div class="Bodytext">
<a name="2.14.2"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aGetFlowControlStatus%28%29"></a>
<hr size="1" noshade>
<h3><code>GetFlowControlStatus()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt GetFlowControlStatus(TFlowControl&amp; aFlowControl) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the current status of flow control between the port and the third
party (external PC or internal signalling stack).</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TFlowControl&amp; aFlowControl </code></td>
<td class="Cell"><p class="ValueDesc"> On return, flow control status </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.3"></a></div><div class="Head3">
<a name="%3a%3aRComm%3a%3aGetRole%28%29"></a>
<hr size="1" noshade>
<h3><code>GetRole()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt GetRole(TCommRole&amp; aRole) const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets current DCE/DTE role.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommRole&amp; aRole </code></td>
<td class="Cell"><p class="ValueDesc"> On return, current DCE/DTE role </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc"> System-wide error code </p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
