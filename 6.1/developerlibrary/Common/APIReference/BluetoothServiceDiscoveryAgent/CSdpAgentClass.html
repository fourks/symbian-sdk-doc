<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CSdpAgent</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CElementParserClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CSdpAttrIdMatchListClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Bluetooth&nbsp;Service&nbsp;Discovery&nbsp;Agent</a>&nbsp;<span class="separator">&#187;</span>
CSdpAgent</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>btsdp.h</code>
<br>Link against: <code>bluetooth.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCSdpAgent"></a>

<h1>Class <code>CSdpAgent</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CSdpAgent</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Makes Bluetooth service discovery protocol (SDP) requests to a remote device.</p><p>To make SDP requests, </p><ul><li><p>Construct a <code>CSdpAgent</code> object with the Bluetooth address of
the remote device to query.</p></li><li><p>Set the classes of service that you want to query for. The classes have predefined UUIDs, which you specify with <code>SetRecordFilterL()</code>. </p></li><li><p>Get results through <code>NextRecordRequestL()</code>. Information on services is stored as records, which can be queried in turn for attribute values for the service through <code>AttributeRequestL()</code>.</p></li></ul><p>A user of this class must implement <code>MSdpAgentNotifier</code> to receive the responses to queries.</p><p>Note that queries are asynchronous, although this is hidden in the API. The implication is that the interface functions that receive responses are only called when the thread's active scheduler can schedule handling of the completion of the query. </p><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CSdpAgent</code></td><td class="Cell">Makes Bluetooth service discovery protocol (SDP) requests to a remote device</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CSdpAgent</code>:
<br><code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aAttributeRequestL%28%29" title="Gets the specified attributes for a remote service">AttributeRequestL()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aNewL%28%29" title="Allocate and construct a service discovery agent">NewL()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aNewLC%28%29" title="Allocate and construct a service discovery agent, leaving the object on the cleanup stack">NewLC()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aNextRecordRequestL%28%29" title="Gets a handle to the record for the next (or first) service on the remote device that matches the service class filter previously set">NextRecordRequestL()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aSetAttributePredictorListL%28%29" title="Creates a copy of an attribute match list supplied, and places it in the CSdpAgent object">SetAttributePredictorListL()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3aSetRecordFilterL%28%29" title="Sets the classes of service to query for on the remote device">SetRecordFilterL()</a></code>, <code class="ApiItem"><a href="CSdpAgentClass.html#%3a%3aCSdpAgent%3a%3a%7eCSdpAgent%28%29" title="Destructor">~CSdpAgent()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier" title="Handles responses to Bluetooth Service Discovery Protocol queries"><code class="ApiItem">MSdpAgentNotifier</code></a></li>
</ul>
<a name="2.7"></a></div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CSdpAgent* NewL(MSdpAgentNotifier&amp; aNotifier, const TBTDevAddr&amp; aDevAddr);</code></p><h4 class="subheading">Description</h4>
<p>Allocate and construct a service discovery agent.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MSdpAgentNotifier&amp; aNotifier</code></td>
<td class="Cell"><p class="ValueDesc">Interface implemented by the query requester, which the agent calls asynchronously to pass responses to queries</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const TBTDevAddr&amp; aDevAddr</code></td>
<td class="Cell"><p class="ValueDesc">The Bluetooth address of the remote device to query</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CSdpAgent*</code></td>
<td class="Cell"><p class="ValueDesc">New service discovery agent</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aNewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>NewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CSdpAgent* NewLC(MSdpAgentNotifier&amp; aNotifier, const TBTDevAddr&amp; aDevAddr);</code></p><h4 class="subheading">Description</h4>
<p>Allocate and construct a service discovery agent, leaving the object on the cleanup stack.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MSdpAgentNotifier&amp; aNotifier</code></td>
<td class="Cell"><p class="ValueDesc">Interface implemented by the query requester, which the agent calls asynchronously to pass responses to queries</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const TBTDevAddr&amp; aDevAddr</code></td>
<td class="Cell"><p class="ValueDesc">The Bluetooth address of the remote device to query</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CSdpAgent*</code></td>
<td class="Cell"><p class="ValueDesc">New service discovery agent</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3a%7eCSdpAgent%28%29"></a>
<hr size="1" noshade>
<h3><code>~CSdpAgent()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CSdpAgent();</code></p><h4 class="subheading">Description</h4>
<p>Destructor.</p>
<a name="2.8"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Service requests</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aSetAttributePredictorListL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetAttributePredictorListL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetAttributePredictorListL(const CSdpAttrIdMatchList&amp; aMatchList);</code></p><h4 class="subheading">Description</h4>
<p>Creates a copy of an attribute match list supplied, and places it in the <code>CSdpAgent</code> object.
</p><p>If an old attribute match list exists, it will be deleted.
</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">const CSdpAttrIdMatchList&amp; aMatchList</code></td>
<td class="Cell"><p class="ValueDesc">Attribute match list to copy</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aSetRecordFilterL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetRecordFilterL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetRecordFilterL(const CSdpSearchPattern&amp; aUUIDFilter);</code></p><h4 class="subheading">Description</h4>
<p>Sets the classes of service to query for on the remote device.</p><p>Responses from the agent will only contain records for services that belong to the classes listed in <code>aUUIDFilter</code>. Service classes are represented as unique identifiers (UUIDs).</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">const CSdpSearchPattern&amp; aUUIDFilter</code></td>
<td class="Cell"><p class="ValueDesc">A list of UUIDs that will be matched in SDP Service Search Requests. The function takes a copy of the object. Any previous UUID list is deleted.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aNextRecordRequestL%28%29"></a>
<hr size="1" noshade>
<h3><code>NextRecordRequestL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NextRecordRequestL();</code></p><h4 class="subheading">Description</h4>
<p>Gets a handle to the record for the next (or first) service  on the remote device that matches
the service class filter previously set.</p><p>The function is asynchronous: on completion,
it calls <code>NextRecordRequestComplete()</code> on the <code>MSdpAgentNotifier</code> interface passed in the <code>NewL()</code>.
</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aNextRecordRequestComplete%28%29" title="Called when an service record request (CSdpAgent::NextRecordRequestComplete()) operation completes"><code class="ApiItem">MSdpAgentNotifier::NextRecordRequestComplete()</code></a></li>
</ul>
<a name="2.9"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Attribute requests</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aAttributeRequestL%28%29"></a>
<hr size="1" noshade>
<h3><code>AttributeRequestL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AttributeRequestL(TSdpServRecordHandle aHandle, TSdpAttributeID aAttrID);</code></p><h4 class="subheading">Description</h4>
<p>         Gets the specified attribute for a remote service.
</p><p>The function is asynchronous: on completion,
it calls <code>MSdpAgentNotifier::AttributeRequestComplete()</code>. </p><p>If the attribute is found, the function passes it by also calling <code>MSdpAgentNotifier::AttributeRequestResult()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpServRecordHandle aHandle</code></td>
<td class="Cell"><p class="ValueDesc">The service for which to get the attribute, specified by its record handle
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpAttributeID aAttrID</code></td>
<td class="Cell"><p class="ValueDesc">The ID of the attribute to get</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestComplete%28%29" title="Called when an attribute request (CSdpAgent::AttributeRequestL()) finds that there are no more attributes to be returned"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestComplete()</code></a></li>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestResult%28%29" title="Called by the attribute request function (CSdpAgent::AttributeRequestL()) to pass the results of a successful attribute request"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestResult()</code></a></li>
</ul>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aAttributeRequestL%28%29"></a>
<hr size="1" noshade>
<h3><code>AttributeRequestL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AttributeRequestL(TSdpServRecordHandle aHandle, const CSdpAttrIdMatchList&amp; aMatchList);</code></p><h4 class="subheading">Description</h4>
<p>         Gets the specified attributes for a remote service.
</p><p>The function is asynchronous: on completion,
it calls <code>MSdpAgentNotifier::AttributeRequestComplete()</code>. </p><p>The function also calls <code>MSdpAgentNotifier::AttributeRequestResult()</code> for each attribute found.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpServRecordHandle aHandle</code></td>
<td class="Cell"><p class="ValueDesc">The service for which to get the attribute, specified by its record handle
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const CSdpAttrIdMatchList&amp; aMatchList</code></td>
<td class="Cell"><p class="ValueDesc">A list of attributes to get</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestComplete%28%29" title="Called when an attribute request (CSdpAgent::AttributeRequestL()) finds that there are no more attributes to be returned"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestComplete()</code></a></li>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestResult%28%29" title="Called by the attribute request function (CSdpAgent::AttributeRequestL()) to pass the results of a successful attribute request"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestResult()</code></a></li>
</ul>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aAttributeRequestL%28%29"></a>
<hr size="1" noshade>
<h3><code>AttributeRequestL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AttributeRequestL(MSdpElementBuilder* aBuilder, TSdpServRecordHandle aHandle, TSdpAttributeID aAttrID);</code></p><h4 class="subheading">Description</h4>
<p>         Gets the specified attribute for a remote service.</p><p>The function is asynchronous: on completion,
it calls <code>MSdpAgentNotifier::AttributeRequestComplete()</code>. </p><p>If the attribute is found, the function calls <code>aBuilder</code>'s interface to set the attribute ID and value.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MSdpElementBuilder* aBuilder</code></td>
<td class="Cell"><p class="ValueDesc">Object implementing the <code>MSdpElementBuilder</code> interface. It will be called with each type found in the response.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpServRecordHandle aHandle</code></td>
<td class="Cell"><p class="ValueDesc">The service for which to get the attribute, specified by its record handle</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpAttributeID aAttrID</code></td>
<td class="Cell"><p class="ValueDesc">The ID of the attribute to get</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestComplete%28%29" title="Called when an attribute request (CSdpAgent::AttributeRequestL()) finds that there are no more attributes to be returned"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestComplete()</code></a></li>
</ul>
<a name="2.9.5"></a></div><div class="Head3">
<a name="%3a%3aCSdpAgent%3a%3aAttributeRequestL%28%29"></a>
<hr size="1" noshade>
<h3><code>AttributeRequestL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void AttributeRequestL(MSdpElementBuilder* aBuilder,TSdpServRecordHandle aHandle, const CSdpAttrIdMatchList&amp; aMatchList);</code></p><h4 class="subheading">Description</h4>
<p>         Gets the specified attributes for a remote service.</p><p>The function is asynchronous: on completion,
it calls <code>MSdpAgentNotifier::AttributeRequestComplete()</code>. </p><p>As each attribute is found, the function calls <code>aBuilder</code>'s interface to set the attribute ID and value.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">MSdpElementBuilder* aBuilder</code></td>
<td class="Cell"><p class="ValueDesc">Object implementing the <code>MSdpElementBuilder</code> interface. It will be called with each type found in the response.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TSdpServRecordHandle aHandle</code></td>
<td class="Cell"><p class="ValueDesc">The service for which to get the attribute, specified by its record handle</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const CSdpAttrIdMatchList&amp; aMatchList</code></td>
<td class="Cell"><p class="ValueDesc">A list of attributes to get</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="MSdpAgentNotifierClass.html#%3a%3aMSdpAgentNotifier%3a%3aAttributeRequestComplete%28%29" title="Called when an attribute request (CSdpAgent::AttributeRequestL()) finds that there are no more attributes to be returned"><code class="ApiItem">MSdpAgentNotifier::AttributeRequestComplete()</code></a></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
