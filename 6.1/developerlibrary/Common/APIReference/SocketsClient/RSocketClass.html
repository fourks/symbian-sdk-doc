<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RSocket</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="RNetDatabaseClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="RSocketServClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Sockets&nbsp;Client</a>&nbsp;<span class="separator">&#187;</span>
RSocket</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> es_sock.h</code>
<br>Link against: <code></code>
</p>
</div><div class="Head1">
<a name="%3a%3aRSocket"></a>

<h1>Class <code>RSocket</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RSocket</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides a client endpoint to a protocol. It provides functions for
socket creation, reading, writing, passive connection, active connection,
setting addresses and querying addresses. Use this class as an endpoint for
network type communications. It provides the following services:</p>
<ul>
<li>
<p>reading from and writing to protocol</p>
</li>
<li>
<p>binding to addresses</p>
</li>
<li>
<p>active connecting</p>
</li>
<li>
<p>passive connection through the listen/accept model</p>
</li>
</ul>
<p>Before using any of these services, a connection to a socket server
session must have been made and the socket must be open. </p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code>RSocket</code></td><td class="Cell">Provides a client endpoint to a protocol</td>
</tr>
<tr><td class="Cell"><code><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase">RSubSessionBase</a></code></td><td class="Cell">Client-side handle to a sub-session</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>RSocket</code>:
<br><code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aAccept%28%29" title="Facilitates a client/server connection from a remote socket">Accept()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aBind%28%29" title="Sets the local address of a socket">Bind()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelAccept%28%29" title="Cancels an outstanding accept operation">CancelAccept()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelAll%28%29" title="Cancels all outstanding operations">CancelAll()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelConnect%28%29%20" title="Cancels an outstanding connect operation">CancelConnect()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelIoctl%28%29" title="Cancels an outstanding Ioctl operation">CancelIoctl()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelRead%28%29" title="Cancels an outstanding Read() operation">CancelRead()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelRecv%28%29" title="Cancels an outstanding receive operation">CancelRecv()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelSend%28%29" title="Cancels an outstanding send operation">CancelSend()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aCancelWrite%28%29" title="Cancels an outstanding Write() operation">CancelWrite()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aClose%28%29" title="Closes a socket">Close()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aConnect%28%29" title="Connects to a remote host">Connect()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aEImmediate" title="Stop socket input/output and complete (abortive close)">EImmediate</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aENormal" title="Complete when socket output/input stopped">ENormal</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aEStopInput" title="Stop socket input and complete when output is stopped">EStopInput</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aEStopOutput" title="Stop socket output and complete when input is stopped">EStopOutput</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aGetDisconnectData%28%29" title="Collects pending data which has been received in a protocol disconnect message">GetDisconnectData()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aGetOpt%28%29" title="Gets a socket option">GetOpt()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aInfo%28%29" title="Gets information in the protocol description for the protocol which a socket is opened on">Info()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aIoctl%28%29" title="Applies an asynchronous control operation on a socket">Ioctl()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aListen%28%29" title="Sets up a socket to listen for incoming connections">Listen()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aLocalName%28%29" title="Gets the local address of a socket">LocalName()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aLocalPort%28%29" title="Gets the local port of a socket">LocalPort()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aName%28%29" title="Gets a unique system name for the socket">Name()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aOpen%28%29" title="Opens a socket">Open()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aRead%28%29" title="Receives data from a remote host and completes when a passed buffer is full">Read()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aRecv%28%29" title="Receives data from a remote host and completes when a passed buffer is full, allowing flags for protocol specific information">Recv()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aRecvFrom%28%29" title="Receives data from a remote host with unconnected sockets where a source address is returned">RecvFrom()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aRecvOneOrMore%28%29" title="Receives data from a remote host and completes when data is available">RecvOneOrMore()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aRemoteName%28%29" title="Gets the remote name of a socket">RemoteName()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aSend%28%29" title="Sends data to a remote host with options set by protocol specific flags">Send()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aSendTo%28%29" title="Sends data to a remote host through an unconnected socket to a specified destination address">SendTo()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aSetLocalPort%28%29" title="Sets the local port of a socket">SetLocalPort()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aSetOpt%28%29" title="Sets a socket option">SetOpt()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aShutdown%28%29" title="Shuts down a connected socket -- asynchronous">Shutdown()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aTShutdown" title="Used in structure TProtocolDesc to describes the endianness of a protocol">TShutdown</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aTransfer%28%29" title="Transfers a socket from one socket server session to another">Transfer()</a></code>, <code class="ApiItem"><a href="RSocketClass.html#%3a%3aRSocket%3a%3aWrite%28%29" title="Sends data to a remote host">Write()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase" title="Client-side handle to a sub-session">RSubSessionBase</a></code>:
<br><code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aCloseSubSession%28%29" title="Closes the sub-session">CloseSubSession()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aCreateSubSession%28%29" title="Creates a new sub-session within an existing session">CreateSubSession()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aSendReceive%28%29" title="Sends a message to the server and waits synchronously for a reply">SendReceive()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aSubSessionHandle%28%29" title="Returns the sub-session handle number">SubSessionHandle()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSubSessionBaseClass.html#%3a%3aRSubSessionBase%3a%3aoperator%3d%28%29" title="Assignment constructor">operator=()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Opening and closing sockets</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Open(RSocketServ&amp; aServer,TUint addrFamily,TUint sockType,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TUint protocol);<br>TInt Open(RSocketServ&amp; aServer,const TDesC&amp; aName);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>TInt Open(RSocketServ&amp; aServer);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></p><h4 class="subheading">Description</h4>
<p>Opens a socket.</p>
<p>The first two variants are for opening channels to protocols.
Protocols can either be identified by a tuple of constants or by name. If a
socket is the first to be opened for a protocol it will have the additional
effect of loading the protocol in the socket server.</p>
<p>The third variant, which has no additional arguments, is
provided for opening a blank channel to the socket server which has no protocol
associated. A socket opened in this manner is suitable as an argument to
<code>Accept()</code>, which will marry the blank socket to a protocol when a
connection is established to a remote endpoint.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RSocketServ&amp; aServer </code></td>
<td class="Cell"><p class="ValueDesc"> The socket server session </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint addrFamily </code></td>
<td class="Cell"><p class="ValueDesc"> A valid address constant for a protocol family </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint sockType </code></td>
<td class="Cell"><p class="ValueDesc"> A valid socket type for the protocol </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint protocol </code></td>
<td class="Cell"><p class="ValueDesc"> A protocol constant which identifies a specific protocol
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> Name of a protocol </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Close();</code></p><h4 class="subheading">Description</h4>
<p>Closes a socket. If a socket has been opened using
<code>Open()</code> then it should be closed using <code>Close()</code>. This
will ensure all associated resources are released. </p>
<p>Closing serves two distinct purposes:</p>
<ul>
<li>
<p>To release resources associated with the IPC channel to the
socket server.</p>
</li>
<li>
<p>To disconnect a socket if it is connected.</p>
</li>
</ul>
<p>If a socket is connected, then calling close is equivalent to
calling <code>Shutdown()</code> with an argument of
<code>RSocket::ENormal</code>, synchronously waiting for the request to
complete, and then closing the IPC channel. If asynchronous or alternative
methods of disconnecting are required then <code>Shutdown()</code> should be
called before <code>Close()</code>.</p>
<p>Notes:</p>
<p>If the <code>RSocketServ</code> session on which a protocol was
opened is closed, then all sockets associated with that session will be
abortively closed and any further requests on the sockets will result in
panics.</p>
<p>If a protocol has the flag <code>KSIGracefulClose</code> in its
protocol information, when <code>Close()</code> is called on a connected
socket, the socket will synchronously block until a response to a close request
has been received or some other protocol condition causes the call to
complete.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Setting and getting the local address and port</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aBind%28%29"></a>
<hr size="1" noshade>
<h3><code>Bind()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Bind(TSockAddr&amp; anAddr);</code></p><h4 class="subheading">Description</h4>
<p>Sets the local address of a socket. When a socket is opened it has
no name associated with it, and binding is required so data can be routed to
the socket. <code>Bind()</code> should be called before <code>Listen()</code>
or <code>Connect()</code>. The address supplied should be a derived class
specific to the particular protocol the socket was opened on.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> Desired local address of socket </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aSetLocalPort%28%29"></a>
<hr size="1" noshade>
<h3><code>SetLocalPort()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetLocalPort(TInt aPort);</code></p><h4 class="subheading">Description</h4>
<p>Sets the local port of a socket. Setting the local port is equivalent
to calling <code>Bind()</code> with only the port set in the address.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aPort </code></td>
<td class="Cell"><p class="ValueDesc"> Desired local port of socket </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aLocalName%28%29"></a>
<hr size="1" noshade>
<h3><code>LocalName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void LocalName(TSockAddr&amp; anAddr);</code></p><h4 class="subheading">Description</h4>
<p>Gets the local address of a socket. The local address is set either by
calling <code>Bind()</code> or it is automatically set when
<code>Connect()</code> is called. If a socket is created through
<code>Accept()</code> then a socket will inherit the port of its parent unless
otherwise specified by a protocol&#8217;s behaviour. Depending on a protocol
implementation, additional information may be gained through this call.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> Local address which is filled in on return </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.5"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aLocalPort%28%29"></a>
<hr size="1" noshade>
<h3><code>LocalPort()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TUint LocalPort();</code></p><h4 class="subheading">Description</h4>
<p>Gets the local port of a socket. Getting the local port is similar to
getting the local name&#8212;see <code>LocalName()</code> for a
description.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint </code></td>
<td class="Cell"><p class="ValueDesc"> The local port of a socket </p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Connecting to a remote host</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aConnect%28%29"></a>
<hr size="1" noshade>
<h3><code>Connect()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Connect(TSockAddr&amp; anAddr,TRequestStatus&amp; aStatus);<br>void Connect(TSockAddr&amp; anAddr,const TDesC8&amp; aDataOut,TDes8&amp; aDataIn,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Connects to a remote host. The address provided specifies the address of
the remote host. Some protocols allow data to be sent in connect request
packets which may be provided in the data-out descriptor. Some protocols may
allow data to be sent in connect responses which may be collected in the
data-in descriptor. A socket may only have one connect operation outstanding at
any one time. Once the connect is completed, the socket is ready to send or
receive data. If a socket is unbound&#0160;&#8212;  i.e. <code>Bind()</code> has not
been called yet&#0160;&#8212;  then it will automatically have a local address
allocated. </p>
<p>Notes:</p>
<p><code>Connect()</code> is always required for protocols which do not have
the <code>KSIConnectionLess</code> flag in their protocol information. If a
protocol has the <code>KSIConnectionLess</code> flag,
then<code>Connect()</code> may be used to set the address for all data sent
from the socket, in which case <code>Send()/Write()</code> may be used in
addition to <code>SendTo()</code>.</p>
<p>To use data in connection a protocol must have the
flag<code>KSIConnectData</code> in its protocol information.</p>
<p>To cancel a connect use <code>CancelConnect()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> Address of remote host. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code, see the system-wide error
codes. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDataOut </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor containing data to be sent </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; aDataIn </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor to receive data. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelConnect%28%29%20"></a>
<hr size="1" noshade>
<h3><code>CancelConnect() </code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelConnect();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding connect operation. Calling it will cause any
outstanding connect operation to complete prematurely. The state of a socket
after a connect is cancelled is defined by the characteristics of the
protocol.</p>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Listening and accepting connect requests</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aListen%28%29"></a>
<hr size="1" noshade>
<h3><code>Listen()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Listen(TUint qSize);<br>TInt Listen(TUint qSize,const TDesC8&amp; aDataOut);</code></p><h4 class="subheading">Description</h4>
<p>Sets up a socket to listen for incoming connections. Before calling this
procedure a socket should be opened on a specific protocol
using<code>Open()</code> and the socket should be bound to a local address
using<code>Bind()</code>. <code>Listen()</code> creates a queue to hold
incoming connections which can be married with blank sockets
using<code>Accept()</code>. The call also allows data to be sent back to
connecting peers if a protocol allows data to be passed in connect responses.
Once a listen queue has been created it will continue to allow peers to connect
until it is full, at which point it will reject any incoming connections as
specified by protocol behaviour. When a socket is accepted by the client a
space is made available in the queue.</p>
<p>Notes:</p>
<p>To use data-in listening, a protocol must have the
flag<code>KSIConnectData</code> in its protocol information.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint qSize </code></td>
<td class="Cell"><p class="ValueDesc"> Size of listen queue </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDataOut </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor containing data to be sent in connect responses </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aAccept%28%29"></a>
<hr size="1" noshade>
<h3><code>Accept()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Accept(RSocket&amp; aBlankSocket,TRequestStatus&amp; aStatus);<br>void Accept(RSocket&amp; aBlankSocket,TDes8&amp; aConnectData,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Facilitates a client/server connection from a remote socket. The call
extracts the first pending connection on a queue of sockets, the queue size
being previously specified by <code>Listen()</code>. On successful completion
the blank socket is given the handle of the new socket and it may then be used
to transfer data. After completion the accept socket may be used to make
further connections with new blank sockets (see <code>Open()</code> on how to
open a blank socket). </p>
<p>The second variant provides an additional descriptor argument to receive
data which may have been sent in a connect request. If there is a pending
connection in the listen queue when <code>Accept()</code> is called, the call
will complete immediately. Otherwise it will wait until a socket becomes
available in the queue and complete asynchronously.</p>
<p>Notes:</p>
<p><code>Accept()</code> may be used for protocols which do not have
the<code>KSIConnectionLess</code> flag in their protocol information.</p>
<p>To receive data-in accepting, a protocol must have the
flag<code>KSIConnectData</code> in its protocol information.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RSocket&amp; aBlankSocket </code></td>
<td class="Cell"><p class="ValueDesc"> A socket opened as a blank socket </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; aConnectData </code></td>
<td class="Cell"><p class="ValueDesc"> Data which may have been received in connection </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelAccept%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelAccept()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelAccept()</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding accept operation. Calling it will cause any
outstanding accept operation to complete prematurely.</p>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Getting the remote name</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aRemoteName%28%29"></a>
<hr size="1" noshade>
<h3><code>RemoteName()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RemoteName(TSockAddr&amp; anAddr);</code></p><h4 class="subheading">Description</h4>
<p>Gets the remote name of a socket. The remote name of a socket is
associated with the remote host a socket is connected to. The remote name is
only valid for a connected socket. A socket is either connected through
calling<code>Connect()</code> or <code>Accept()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> Remote address which is filled in on return </p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Getting socket protocol information</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>Info()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Info(TProtocolDesc&amp; aProtocol);</code></p><h4 class="subheading">Description</h4>
<p>Gets information in the protocol description for the protocol which a
socket is opened on.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TProtocolDesc&amp; aProtocol </code></td>
<td class="Cell"><p class="ValueDesc"> An integer constant which identifies an option </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Setting and getting options</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aSetOpt%28%29"></a>
<hr size="1" noshade>
<h3><code>SetOpt()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SetOpt(TUint anOptionName,TUint anOptionLevel,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const TDesC8&amp; anOption=TPtrC8(NULL,0));<br>TInt SetOpt(TUint anOptionName,TUint anOptionLevel,TInt anOption);</code></p><h4 class="subheading">Description</h4>
<p>Sets a socket option. The socket server has options which are generic to
all sockets and protocols may add specific options.</p>
<p>Options available for all protocols can be set
with<code>anOptionLevel</code> set to <code>KSOLSocket</code>. See individual
protocol notes for other socket options. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anOptionName </code></td>
<td class="Cell"><p class="ValueDesc"> An integer constant which identifies an option </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anOptionLevel </code></td>
<td class="Cell"><p class="ValueDesc"> An integer constant which identifies level of an option: i.e. an option
level groups related options together. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; anOption </code></td>
<td class="Cell"><p class="ValueDesc"> Option value packaged in a descriptor </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt anOption </code></td>
<td class="Cell"><p class="ValueDesc"> Option value as an integer </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="SocketsConstants.html#SocketsClient%2econst%2dsetoptions" title="Sockets constants / Generic socket options">Generic socket options</a></li>
</ul>
<a name="2.12.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aGetOpt%28%29"></a>
<hr size="1" noshade>
<h3><code>GetOpt()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt GetOpt(TUint anOptionName,TUint anOptionLevel,TDes8&amp; anOption);<br>TInt GetOpt(TUint anOptionName,TUint anOptionLevel,TInt&amp; anOption);</code></p><h4 class="subheading">Description</h4>
<p>Gets a socket option. The socket server has options which are generic to
all sockets and protocols may add specific options.</p>
<p>Options available for all protocols can be got
with<code>anOptionLevel</code> set to <code>KSOLSocket</code>. See individual
protocol notes for other socket options. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anOptionName </code></td>
<td class="Cell"><p class="ValueDesc"> An integer constant which identifies an option </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anOptionLevel </code></td>
<td class="Cell"><p class="ValueDesc"> An integer constant which identifies level of an option </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; anOption </code></td>
<td class="Cell"><p class="ValueDesc"> On return, option value packaged in a descriptor </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt&amp; anOption </code></td>
<td class="Cell"><p class="ValueDesc"> On return, option value as an integer </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="SocketsConstants.html#SocketsClient%2econst%2dsetoptions" title="Sockets constants / Generic socket options">Generic socket options</a></li>
</ul>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Sending data</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aWrite%28%29"></a>
<hr size="1" noshade>
<h3><code>Write()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Write(const TDesC8&amp; aDesc,TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Sends data to a remote host.</p>
<p><code>Write()</code> should only be used with
connected sockets. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A constant descriptor </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates that the socket has been
shutdown with option <code>EStopOutput</code>. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aSend%28%29"></a>
<hr size="1" noshade>
<h3><code>Send()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Send(const TDesC8&amp; aDesc,TUint someFlags,TRequestStatus&amp; aStatus);<br>void Send(const TDesC8&amp; aDesc,TUint someFlags,TRequestStatus&amp; aStatus,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TSockXfrLength&amp; aLen);</code></p><h4 class="subheading">Description</h4>
<p>Sends data to a remote host with options set by protocol specific
flags.</p>
<p>The length of the descriptor indicates the amount of data to be sent. You can use a <code>TSockXfrLength</code> argument to find the amount of data
actually sent. </p><p>A
socket may only have one send operation in progress at any one time.</p>
<p><code>Send()</code> should only be used with
connected sockets. </p>
<p>Note:</p>
<p>If a protocol&#8217;s information flag is marked
with<code>KSIUrgentData</code>, then <code>KSockWriteUrgent</code> may be
provided as a flag to <code>Send()</code>. All other flags are protocol
specific.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A constant descriptor </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint someFlags </code></td>
<td class="Cell"><p class="ValueDesc"> Flags which are passed through to protocol </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates that the socket has been
shutdown with option <code>EStopOutput</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockXfrLength&amp; aLen </code></td>
<td class="Cell"><p class="ValueDesc"> Filled in with amount of data sent before completion </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.4"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aSendTo%28%29"></a>
<hr size="1" noshade>
<h3><code>SendTo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SendTo(const TDesC8&amp; aDesc,TSockAddr&amp; anAddr,TUint flags,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus);<br>void SendTo(const TDesC8&amp; aDesc,TSockAddr&amp; anAddr,TUint flags,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus,TSockXfrLength&amp; aLen);</code></p><h4 class="subheading">Description</h4>
<p>Sends data to a remote host through an unconnected socket to a specified destination address.</p><p>Flags are provided to add protocol specific
information.</p>
<p>The length of the descriptor indicates the amount of data to be sent. </p><p>A
socket may only have one send operation in progress at any one time.</p>
<p>An additional <code>TSockXfrLength</code> argument can be provided to get the amount of data
sent.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A constant descriptor</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> A remote destination address for unconnected sends </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint flags </code></td>
<td class="Cell"><p class="ValueDesc"> Flags which are passed through to protocol </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates that the socket has been
shutdown with option <code>EStopOutput</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockXfrLength&amp; aLen </code></td>
<td class="Cell"><p class="ValueDesc"> Filled in with amount of data sent before completion </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.5"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelWrite%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelWrite()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelWrite();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding <code>Write()</code> operation. </p><p>Calling the function will cause any
outstanding <code>Write()</code> operation to complete prematurely. The state of a socket after
a send is cancelled is defined by the characteristics of the protocol.</p>
<a name="2.13.6"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelSend%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelSend()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelSend();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding send operation. </p><p>Calling the function will cause any
outstanding send operation to complete prematurely. The state of a socket after
a send is cancelled is defined by the characteristics of the protocol.</p>
<a name="2.14"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Receiving data</h2>
</div><div class="Bodytext">
<a name="2.14.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aRead%28%29"></a>
<hr size="1" noshade>
<h3><code>Read()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Read(TDes8&amp; aDesc,TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Receives data from a remote host and completes when a passed buffer is full. </p><p>The function only complete when the full
amount of requested data has been received (or the connection breaks). This means when the descriptor has been filled to its maximum length (not its current length). </p><p><code>Read()</code> should only be used with connected sockets.</p>
<p>A socket may only have one receive operation outstanding
at any one time.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">  TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor where data read will be placed. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates either that a remote connection
is closed, and that no more data is available for reading, or the socket has
been shutdown with option <code>EStopInput</code>. </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aRecv%28%29"></a>
<hr size="1" noshade>
<h3><code>Recv()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Recv(TDes8&amp; aDesc,TUint flags,TRequestStatus&amp; aStatus);<br>void Recv(TDes8&amp; aDesc,TUint flags,TRequestStatus&amp; aStatus,TSockXfrLength&amp; aLen);</code></p><h4 class="subheading">Description</h4>
<p>Receives data from a remote host and completes when a passed buffer is full, allowing  flags for protocol
specific information. </p><p>The function only completes when the full
amount of requested data has been received (or the connection breaks). This means when the descriptor has been filled to its maximum length.</p><p><code>Recv()</code> should only be used with connected sockets.</p>
<p>A socket may only have one receive operation outstanding
at any one time.</p>
<p>Note:</p>
<p>If a protocol&#8217;s information flag is marked
with<code>KSIPeekData</code>, then <code>KSockReadPeek</code> may be provided
as a flag to <code>Recv()</code>. All other flags are protocol specific.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor where data received will be placed. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint flags </code></td>
<td class="Cell"><p class="ValueDesc"> Flags for protocol specific information.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc">Reference to the request status object. On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates either that a remote connection
is closed, and that no more data is available for reading, or the socket has
been shutdown with option <code>EStopInput</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockXfrLength&amp; aLen </code></td>
<td class="Cell"><p class="ValueDesc"> On return, a length which indicates how much data was read. This is the
same as length of the returned <code>aDesc</code>. </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.4"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aRecvOneOrMore%28%29"></a>
<hr size="1" noshade>
<h3><code>RecvOneOrMore()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RecvOneOrMore(TDes8&amp; aDesc,TUint flags,TRequestStatus&amp; aStatus,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TSockXfrLength&amp; aLen);</code></p><h4 class="subheading">Description</h4>
<p>Receives data from a remote host and completes when data is available. </p><p>The function reads at least one byte of data, but will
complete as soon as any data is available. The amount of data received is
returned via the <code>TSockXfrLength</code> argument.</p><p><code>RecvOneOrMore()</code>
should only be used with connected sockets.</p>
<p>A socket may only have one receive operation outstanding
at any one time.</p>
<p>Note:</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor where data read will be placed. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint flags </code></td>
<td class="Cell"><p class="ValueDesc"> Flags which are passed through to protocol.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates either that a remote connection
is closed, and that no more data is available for reading, or the socket has
been shutdown with option <code>EStopInput</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockXfrLength&amp; aLen </code></td>
<td class="Cell"><p class="ValueDesc"> On return, a length which indicates how much data was read. This is the
same as length of the returned <code>aDesc</code>. </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.5"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aRecvFrom%28%29"></a>
<hr size="1" noshade>
<h3><code>RecvFrom()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RecvFrom(TDes8&amp; aDesc,TSockAddr&amp; anAddr,TUint flags,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus);<br>void RecvFrom(TDes8&amp; aDesc,TSockAddr&amp; anAddr,TUint flags,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus,TSockXfrLength&amp; aLen);</code></p><h4 class="subheading">Description</h4>
<p>Receives data from a remote host with unconnected sockets where a
source address is returned.</p><p>Flags are provided to add protocol
specific information. </p><p>A socket may only have one receive operation outstanding
at any one time.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor where data read will be placed </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockAddr&amp; anAddr </code></td>
<td class="Cell"><p class="ValueDesc"> A remote source address for unconnected receives </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint flags </code></td>
<td class="Cell"><p class="ValueDesc"> Flags which are passed through to protocol </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. Note that <code>KErrEof</code> indicates either that a remote connection
is closed, and that no more data is available for reading, or the socket has
been shutdown with option <code>EStopInput</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TSockXfrLength&amp; aLen </code></td>
<td class="Cell"><p class="ValueDesc"> On return, a length which indicates how much data was read. This is the
same as length of the returned <code>aDesc</code>. </p></td>
</tr>
</table></td></tr></table>
<a name="2.14.6"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelRead%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelRead()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelRead();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding <code>Read()</code> operation. </p><p>Calling this function will cause any
outstanding <code>Read()</code> operation to complete prematurely. The state of a socket
after a receive is cancelled is defined by the characteristics of the
protocol.</p>
<a name="2.14.7"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelRecv%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelRecv()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelRecv();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding receive operation. </p><p>Calling this function will cause any
outstanding receive operation to complete prematurely. The state of a socket
after a receive is cancelled is defined by the characteristics of the
protocol.</p>
<a name="2.15"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Ioctls</h2>
</div><div class="Bodytext">
<a name="2.15.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aIoctl%28%29"></a>
<hr size="1" noshade>
<h3><code>Ioctl()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Ioctl(TUint aCommand,TRequestStatus&amp; aStatus,TDes8* aDesc=NULL,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TUint aLevel=KLevelUnspecified);</code></p><h4 class="subheading">Description</h4>
<p>Applies an asynchronous control operation on a socket. Data may be passed
and received if a descriptor address is provided as an argument. Only
one<code>Ioctl()</code> operation may be outstanding for each socket.</p>
<p>Commands available for all protocols can be set with
<code>aLevel</code>set to <code>KSOLSocket</code>. See individual protocol
notes for other commands. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aCommand </code></td>
<td class="Cell"><p class="ValueDesc"> Ioctl command. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8* aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> Pointer to a descriptor in which data may be sent and received on
completion </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aLevel </code></td>
<td class="Cell"><p class="ValueDesc"> Control operation level </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="SocketsConstants.html#SocketsClient%2econst%2dioctl" title="Sockets constants / Ioctl commands">Ioctl commands</a></li>
</ul>
<a name="2.15.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelIoctl%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelIoctl()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelConnect()</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding Ioctl operation. Calling it will cause any
outstanding Ioctl operation to complete prematurely. The state of a socket
after a connect is cancelled is defined by the characteristics of the
protocol.</p>
<a name="2.16"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Socket transfer</h2>
</div><div class="Bodytext">
<a name="2.16.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aName%28%29"></a>
<hr size="1" noshade>
<h3><code>Name()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Name(TName&amp; aName);</code></p><h4 class="subheading">Description</h4>
<p>Gets a unique system name for the socket. The purpose of this is to
identify the socket in a call to <code>Transfer()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TName&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> System name for the socket </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.16.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aTransfer%28%29"></a>
<hr size="1" noshade>
<h3><code>Transfer()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Transfer(RSocketServ&amp; aServer, const TDesC&amp; aName);</code></p><h4 class="subheading">Description</h4>
<p>Transfers a socket from one socket server session to another. It creates
the socket in the target session, and removes the socket from the source
session. The call is made on an uninitialised <code>RSocket</code> object. The
socket system name is used to identify the socket to transfer. </p>
<p>If the call fails, the socket that is being transferred remains with the
original session. Success or failure can be checked on the originating socket
by calling <code>RSocket::Info()</code>, which returns <code>KErrNone</code> if
the transfer failed, and <code>KErrBadHandle</code> if it succeeded.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RSocketServ&amp; aServer </code></td>
<td class="Cell"><p class="ValueDesc"> The session into which to transfer the socket. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> The system name, as obtained from a call to <code>Name()</code>, of the
socket that you want to transfer. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.17"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Shutting down a connection</h2>
</div><div class="Bodytext">
<a name="2.17.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aShutdown%28%29"></a>
<hr size="1" noshade>
<h3><code>Shutdown()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Shutdown(TShutdown aHow,TRequestStatus&amp; aStatus);<br>void Shutdown(TShutdown aHow,const TDesC8&amp; aDataOut,TDes8&amp; aDataIn,TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Shuts down a connected socket&#0160;&#8212;  asynchronous. The shutdown method
allows input and output to be individually stopped for a protocol endpoint. For
protocols which support data-in disconnect message, additional arguments are
provided.</p>
<p>Notes:</p>
<p><code>Shutdown()</code> can be used for protocols which do not have
the<code>KSIConnectionLess</code> flag in their protocol information.</p>
<p>To use data in disconnection a protocol must have the
flag<code>KSIConnectData</code> in its protocol information.</p>
<p>There is no way to cancel a socket shutdown once it has started.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TShutdown aHow </code></td>
<td class="Cell"><p class="ValueDesc"> Shutdown option. All variants complete when a socket is
disconnected.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code: see the system-wide error
codes. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aDataOut </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor containing data to be sent </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; aDataIn </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor to receive data. </p></td>
</tr>
</table></td></tr></table>
<a name="2.17.3"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aGetDisconnectData%28%29"></a>
<hr size="1" noshade>
<h3><code>GetDisconnectData()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt GetDisconnectData(TDes8&amp; aDesc);</code></p><h4 class="subheading">Description</h4>
<p>Collects pending data which has been received in a protocol disconnect
message.</p>
<p>Notes:</p>
<p>To use data in disconnection a protocol must have the
flag<code>KSIConnectData</code> in its protocol information.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8&amp; aDesc </code></td>
<td class="Cell"><p class="ValueDesc"> A descriptor to receive data. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.18"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Cancel all outstanding operations</h2>
</div><div class="Bodytext">
<a name="2.18.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aCancelAll%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelAll()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelAll()</code></p><h4 class="subheading">Description</h4>
<p>Cancels all outstanding operations. Calling it will cause all outstanding
operations to complete prematurely. Outstanding operations for a socket
include: read, write, Ioctl, connect, accept and shutdown. All of these
operations will be completed by this call except shutdown which may not be
cancelled.</p>
<a name="2.19"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Enumerations</h2>
</div><div class="Bodytext">
<a name="2.19.2"></a></div><div class="Head3">
<a name="%3a%3aRSocket%3a%3aTShutdown"></a>
<hr size="1" noshade>
<h3>Enum <code>TShutdown</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TShutdown</code></p><h4 class="subheading">Description</h4>
<p>Used in structure <code>TProtocolDesc</code> to describes the endianness
of a protocol.</p>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><a name="%3a%3aRSocket%3a%3aENormal"><code class="Value">ENormal</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Complete when socket output/input stopped.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aRSocket%3a%3aEStopInput"><code class="Value">EStopInput</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Stop socket input and complete when output is stopped.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aRSocket%3a%3aEStopOutput"><code class="Value">EStopOutput</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Stop socket output and complete when input is stopped.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aRSocket%3a%3aEImmediate"><code class="Value">EImmediate</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Stop socket input/output and complete (abortive close).</para>
</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
