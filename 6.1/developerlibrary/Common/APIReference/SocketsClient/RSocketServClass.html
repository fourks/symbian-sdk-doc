<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RSocketServ</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="RSocketClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="SSockAddrStruct.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Sockets&nbsp;Client</a>&nbsp;<span class="separator">&#187;</span>
RSocketServ</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> es_sock.h </code>
<br>Link against: <code> esock.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aRSocketServ"></a>

<h1>Class <code>RSocketServ</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RSocketServ</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides the <code>Connect()</code> function to create an IPC
communication channel to the socket server. To close the channel
<code>RHandleBase</code> provides a <code>Close()</code> function. The prime
use for instances of <code>RSocketServ</code> is to establish subsession
communications for <code>RSocket</code>, <code>RHostResolver</code> and
<code>RNetDatabase</code>. Any of the resources which are open using the
session are automatically closed when the session is terminated. The following
operations are also provided:</p>
<ul>
<li>
<p><code>NumProtocols()</code> - enumerates the number of
protocols of which the socket server is currently aware.</p>
</li>
<li>
<p><code>GetProtocolInfo()</code> - returns information about
protocols of which the socket server is currently aware.</p>
</li>
<li>
<p><code>FindProtocol()</code> - find a protocol by name.</p>
</li>
<li>
<p><code>StartProtocol()</code> - load a protocol
asynchronously.</p>
</li>
</ul>
<p>This class is not intended for user derivation</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase">RHandleBase</a></code></td><td class="Cell">Handle to an object</td>
</tr>
<tr><td class="Cell"><code><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase">RSessionBase</a></code></td><td class="Cell">Client-side handle to a session with a server</td>
</tr>
<tr><td class="Cell"><code>RSocketServ</code></td><td class="Cell">Provides the Connect() function to create an IPC communication channel to the socket server</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>RSocketServ</code>:
<br><code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aConnect%28%29" title="Opens a session to the socket server">Connect()</a></code>, <code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aFindProtocol%28%29" title="Gets the description of a protocol by name">FindProtocol()</a></code>, <code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aGetProtocolInfo%28%29" title="Gets information about all protocols">GetProtocolInfo()</a></code>, <code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aNumProtocols%28%29" title="Gets the number of protocols the socket server currently is aware of">NumProtocols()</a></code>, <code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aStartProtocol%28%29" title="Loads a protocol specified by family, socket type and protocol identifier">StartProtocol()</a></code>, <code class="ApiItem"><a href="RSocketServClass.html#%3a%3aRSocketServ%3a%3aVersion%28%29" title="Gets the version of this client">Version()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase" title="Handle to an object">RHandleBase</a></code>:
<br><code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aClose%28%29" title="Closes the handle">Close()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aDuplicate%28%29" title="Creates a valid handle to the Kernel object to which the specified thread already has a handle">Duplicate()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aHandle%28%29" title="Retrieves the handle-number of the object associated with this handle">Handle()</a></code>,
<code class="ApiItem"><a href="../Handles/RHandleBaseClass.html#%3a%3aRHandleBase%3a%3aSetHandle%28%29" title="Use this function to set the handle-number of this handle to the specified value">SetHandle()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase" title="Client-side handle to a session with a server">RSessionBase</a></code>:
<br><code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aAttach%28%29" title="Explicitly attaches a thread to the session">Attach()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aCreateSession%28%29" title="Creates a session with a server">CreateSession()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aEAutoAttach" title="Client threads are auto-attached to the session">EAutoAttach</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aEExplicitAttach" title="Client threads explicitly attach to the session">EExplicitAttach</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aSend%28%29" title="Sends a blind message to the server -- no reply is expected">Send()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aSendReceive%28%29" title="Sends a message to the server and waits synchronously for the reply">SendReceive()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aSetRetry%28%29" title="Changes the retry parameters used to resend a message if the server is busy">SetRetry()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aShare%28%29" title="Makes the session shared among all threads in the process">Share()</a></code>,
<code class="ApiItem"><a href="../ClientServer/RSessionBaseClass.html#%3a%3aRSessionBase%3a%3aTAttachMode" title="Indicates whether threads in the process are automatically attached to the session when passed as a parameter to the Share() function">TAttachMode</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aConnect%28%29"></a>
<hr size="1" noshade>
<h3><code>Connect()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Connect(TUint aMessageSlots=KESockDefaultMessageSlots);</code></p><h4 class="subheading">Description</h4>
<p>Opens a session to the socket server. </p>
<p>Notes:</p>
<ul><li><p>The number of message slots indicates how many asychronous operations are
allowed to be uncompleted at any one time by the combined resources opened on
the session. The result of having too few slots is not fatal. However, operations may
return <code>KErrServerBusy</code> indicating that no message slot was
available after a small time trying.</p></li><li><p><code>Close()</code> should be called once the session is no
longer required. All resources which are opened using the session will be
automatically closed when the session terminates.</p></li><li><p>When the last session which has open resources for a protocol
is closed a protocol module will be unloaded automatically by the socket
server.</p></li></ul>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aMessageSlots </code></td>
<td class="Cell"><p class="ValueDesc"> The number of message slots required</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Information </h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aVersion%28%29"></a>
<hr size="1" noshade>
<h3><code>Version()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TVersion Version() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the version of this client.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TVersion </code></td>
<td class="Cell"><p class="ValueDesc"> Client side version number </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aNumProtocols%28%29"></a>
<hr size="1" noshade>
<h3><code>NumProtocols()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt NumProtocols(TUint&amp; aCount);</code></p><h4 class="subheading">Description</h4>
<p>Gets the number of protocols the socket server currently is aware
of.</p>
<p>Note:</p>
<p>The count returned can be used in conjunction with
<code>GetProtocolInfo()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint&amp; aCount </code></td>
<td class="Cell"><p class="ValueDesc"> The number of protocols is returned in <code>aCount</code>
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aGetProtocolInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>GetProtocolInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt GetProtocolInfo(TUint anIndex,TProtocolDesc&amp; aProtocol);</code></p><h4 class="subheading">Description</h4>
<p>Gets information about all protocols.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anIndex </code></td>
<td class="Cell"><p class="ValueDesc"> Index of required protocol description </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TProtocolDesc&amp; aProtocol </code></td>
<td class="Cell"><p class="ValueDesc"> A protocol description type to hold protocol information </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.5"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aFindProtocol%28%29"></a>
<hr size="1" noshade>
<h3><code>FindProtocol()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt FindProtocol(const TProtocolName&amp; aName,TProtocolDesc&amp; aProtocol);</code></p><h4 class="subheading">Description</h4>
<p>Gets the description of a protocol by name.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TProtocolName&amp; aName </code></td>
<td class="Cell"><p class="ValueDesc"> Typed descriptor which identifies a protocol name. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TProtocolDesc&amp; aProtocol </code></td>
<td class="Cell"><p class="ValueDesc"> A protocol description type to hold protocol information. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Starting a protocol</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRSocketServ%3a%3aStartProtocol%28%29"></a>
<hr size="1" noshade>
<h3><code>StartProtocol()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void StartProtocol(TUint aFamily,TUint aSockType,TUint aProtocol,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Loads a protocol specified by family, socket type and protocol
identifier. Note that client programs do not normally need to call this
function, as loading of a protocol is done automatically by the Sockets Server
when a socket of that protocol is opened. Some applications may, however, need
to ensure that an open socket call will not take a significant amount of time.
This function can be called by such applications to preload the
protocol.</p>
<p>There is no way to cancel this operation once it has been called.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aFamily </code></td>
<td class="Cell"><p class="ValueDesc"> Integer which identifies a protocol suite </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aSockType </code></td>
<td class="Cell"><p class="ValueDesc"> Integer which identifies a type of socket </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aProtocol </code></td>
<td class="Cell"><p class="ValueDesc"> Integer which identifies a specific protocol in a family </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> On completion, will contain an error code, see the system-wide error
codes. </p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
