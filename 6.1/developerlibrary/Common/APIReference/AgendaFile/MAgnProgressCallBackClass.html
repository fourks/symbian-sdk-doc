<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>MAgnProgressCallBack</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="MAgnModelStateCallBackClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="TAgnDayFilterClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Agenda&nbsp;File</a>&nbsp;<span class="separator">&#187;</span>
MAgnProgressCallBack</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>agmcallb.h</code>
<br>Link against: <code>agnmodel.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aMAgnProgressCallBack"></a>

<h1>Class <code>MAgnProgressCallBack</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>MAgnProgressCallBack</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides information about the progress of prolonged agenda model
operations, and about how the operation terminated.</p>
<p>An <code>MAgnProgressCallBack</code> object is usually specified
when the client requests an activity such as merging, tidying or save as, which
might take some time to complete and needs to be updated on its progress and
completion state. See for example
<code>CAgnIndexedModel::MergeL()</code>.</p>
<p>As the model is carrying out the operation, it calls
<code>Progress()</code> with <code>aPercentageCompleted</code> set to the
amount of the operation that has been carried out so far. Note that when the
operation is complete, <code>Progress()</code> is not called with
<code>aPercentageCompleted</code> set to 100. Instead the
<code>Completed()</code> method is called. Note also that if the operation
completes quickly, for instance when opening a small file, then
<code>Progress()</code> will probably not be called. If on return,
<code>aError</code> is anything other than <code>KErrNone</code> then something
went wrong during the operation.</p><p>Defined in <code>MAgnProgressCallBack</code>:
<br><code class="ApiItem"><a href="MAgnProgressCallBackClass.html#%3a%3aMAgnProgressCallBack%3a%3aCompleted%28%29" title="Called when the operation completes">Completed()</a></code>, <code class="ApiItem"><a href="MAgnProgressCallBackClass.html#%3a%3aMAgnProgressCallBack%3a%3aProgress%28%29" title="Called by the agenda model during prolonged operations such as merging and tidying, to indicate how much of the operation has been completed">Progress()</a></code>
</p>
<a name="2.5"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Callback information</h2>
</div><div class="Bodytext">
<a name="2.5.2"></a></div><div class="Head3">
<a name="%3a%3aMAgnProgressCallBack%3a%3aCompleted%28%29"></a>
<hr size="1" noshade>
<h3><code>Completed()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Completed(TInt aError = KErrNone) = 0;</code></p><h4 class="subheading">Description</h4>
<p>Called when the operation completes. The
argument indicates how the operation completed.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aError = KErrNone</code></td>
<td class="Cell"><p class="ValueDesc">Indicates how the operation completed. <code>KErrNone</code> if
successful, otherwise one of the system error codes.</p></td>
</tr>
</table></td></tr></table>
<a name="2.5.3"></a></div><div class="Head3">
<a name="%3a%3aMAgnProgressCallBack%3a%3aProgress%28%29"></a>
<hr size="1" noshade>
<h3><code>Progress()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Progress(TInt aPercentageCompleted) = 0;</code></p><h4 class="subheading">Description</h4>
<p>Called by the agenda model during prolonged operations such as
merging and tidying, to indicate how much of the operation has been completed.
Note that this function is not called when the operation is complete, with
<code>aPercentageCompleted</code> set to 100; instead the
<code>Completed()</code> method is called. The frequency with which this
function is called is indicated by a callback frequency
parameter&nbsp;&#8212; see for instance
<code>CAgnIndexedModel::MergeL()</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aPercentageCompleted</code></td>
<td class="Cell"><p class="ValueDesc">The percentage of the task that has been completed.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
