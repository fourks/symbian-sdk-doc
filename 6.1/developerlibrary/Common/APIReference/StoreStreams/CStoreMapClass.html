<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CStoreMap</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="index.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CStreamDictionaryClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Store&nbsp;Streams</a>&nbsp;<span class="separator">&#187;</span>
CStoreMap</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>s32std.h</code>
<br>Link against: <code>estor.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCStoreMap"></a>

<h1>Class <code>CStoreMap</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CStoreMap</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Store map used when externalising swizzled in-memory objects. </p><p>It
has three main characteristics:</p>
<ul>
<li>
<p>it acts as an in-memory repository of stream ids and associated
swizzles </p>
</li>
<li>
<p>it acts as an externaliser for swizzles </p>
</li>
<li>
<p>it offers cleanup support</p>
</li>
</ul><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CStoreMap</code></td><td class="Cell">Store map used when externalising swizzled in-memory objects</td>
</tr>
<tr><td class="Cell"><code><a href="MExternalizerClass.html#%3a%3aMExternalizer">MExternalizer</a></code></td><td class="Cell">Base class used in the derivation of CStoreMap</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CStoreMap</code>:
<br><code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aAt%28%29" title="Returns the stream id of the first entry the store map matching the specified swizzle">At()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aBindL%28%29" title="Creates an entry in the store map to contain the specified stream id and an associated swizzle">BindL()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aForget%28%29" title="Deletes an entry from the store map">Forget()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aLabel%28%29" title="Returns the swizzle in the store map assocated with the specified stream id">Label()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aNewL%28%29" title="Allocates and constructs a store map associated with the specified store and returns a pointer to that store map">NewL()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aNewLC%28%29" title="Allocates and constructs a store map associated with the specified store, returns a pointer to that store map and puts the pointer onto the cleanup stack">NewLC()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aReset%28%29" title="Deletes all entries from the store map">Reset()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aResetAndDestroy%28%29" title="Deletes all streams whose ids are held within the store map, and then empties the store map">ResetAndDestroy()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3aUnbind%28%29" title="Deletes the first entry from the store map corresponding to the specified swizzle">Unbind()</a></code>, <code class="ApiItem"><a href="CStoreMapClass.html#%3a%3aCStoreMap%3a%3a%7eCStoreMap%28%29" title="Frees resources owned by the object, prior to its destruction">~CStoreMap()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CStoreMap* NewL(CStreamStore&amp; aStore);</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a store map associated with the
specified store and returns a pointer to that store map.</p>
<p>The function leaves if it cannot complete
successfully.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the store associated with this store map.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CStoreMap*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the new store map object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aNewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>NewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CStoreMap* NewLC(CStreamStore&amp; aStore);</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a store map associated with the
specified store, returns a pointer to that store map and puts the pointer onto
the cleanup stack.</p>
<p>The function leaves if it cannot complete successfully.</p>
<p>Placing a pointer to this object onto the cleanup stack allows
the object and allocated resources to be cleaned up if a subsequent leave
occurs.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc">A reference to the store associated with this store map.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CStoreMap*</code></td>
<td class="Cell"><p class="ValueDesc">A pointer to the new store map object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.6.4"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3a%7eCStoreMap%28%29"></a>
<hr size="1" noshade>
<h3><code>~CStoreMap()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CStoreMap();</code></p><h4 class="subheading">Description</h4>
<p>Frees resources owned by the object, prior to its
destruction.</p>
<p>In particular, the destructor deletes all streams whose stream ids
are currently held within the store map and then empties the store
map.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Create store map entry (binding)</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aBindL%28%29"></a>
<hr size="1" noshade>
<h3><code>BindL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void BindL(TSwizzleC&lt;TAny&gt; aSwizzle,TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Creates an entry in the store map to contain the specified stream id
and an associated swizzle. On return from this function, the stream id is said
to be bound to the swizzle.</p>
<p>If the store map already contains an entry with the same swizzle,
then the new entry replaces the existing entry; in effect, knowledge of the
original stream id associated with <code>aSwizzle</code>, is lost.</p>
<p>Callers of this function can pass any type of swizzle as the first
parameter, i.e. any swizzle derived from <code>TSwizzleCBase</code>. The
required <code>TSwizzleC&lt;TAny&gt;</code> object is constructed from the
swizzle passed by the caller.</p>
<p>Note that in most applications, callers pass a general swizzle, i.e.
an object of type <code>TSwizzle&lt;class T&gt;</code>, where
<code>T</code> is the type of object represented by that
swizzle.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSwizzleC&lt;TAny&gt; aSwizzle</code></td>
<td class="Cell"><p class="ValueDesc">Any swizzle derived from <code>TSwizzleCBase</code>.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The stream id to be bound to the swizzle.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Delete store map entry by swizzle (unbinding)</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aUnbind%28%29"></a>
<hr size="1" noshade>
<h3><code>Unbind()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Unbind(TSwizzleC&lt;TAny&gt; aSwizzle);</code></p><h4 class="subheading">Description</h4>
<p>Deletes the first entry from the store map corresponding to the
specified swizzle.</p>
<p>On return from this function, the swizzle is said to be unbound and
knowledge of the associated stream id is lost.</p>
<p>Callers of this function can pass any type of swizzle as the parameter,
i.e. any swizzle derived from <code>TSwizzleCBase</code>. The required
<code>TSwizzleC&lt;TAny&gt;</code> object is constructed from the swizzle
passed by the caller.</p>
<p>Notes:</p>
<ul>
<li>
<p>In most applications, callers pass a general swizzle, i.e. an
object of type <code>TSwizzle&lt;class&nbsp;T&gt;</code>, where
<code>T</code> is the type of object represented by that swizzle.</p>
</li>
<li>
<p>If no matching entry can be found in the store map, then the store
map remains unaltered.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSwizzleC&lt;TAny&gt; aSwizzle</code></td>
<td class="Cell"><p class="ValueDesc">Any swizzle derived from <code>TSwizzleCBase</code>.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Delete store map entry by stream id (Forgetting)</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aForget%28%29"></a>
<hr size="1" noshade>
<h3><code>Forget()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Forget(TStreamId anId);</code></p><h4 class="subheading">Description</h4>
<p>Deletes an entry from the store map. The entry selected is the first one
whose stream id matches the specified stream id.</p>
<p>On return from this function, the stream id is said to be forgotten and
knowledge of that stream id is lost.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The stream id used to identify the entry in the store map to be
deleted.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Empty the store map</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aReset%28%29"></a>
<hr size="1" noshade>
<h3><code>Reset()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Reset();</code></p><h4 class="subheading">Description</h4>
<p>Deletes all entries from the store map.</p>
<p>It is important that this function is called before deleting the store
map, as the destructor attempts to delete all streams whose stream ids are held
within the map.</p>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Delete streams and empty the store map</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aResetAndDestroy%28%29"></a>
<hr size="1" noshade>
<h3><code>ResetAndDestroy()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResetAndDestroy();</code></p><h4 class="subheading">Description</h4>
<p>Deletes all streams whose ids are held within the store map, and then
empties the store map.</p>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Find stream id associated with swizzle</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aAt%28%29"></a>
<hr size="1" noshade>
<h3><code>At()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TStreamId At(TSwizzleC&lt;TAny&gt; aSwizzle) const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the stream id of the first entry the store map matching the
specified swizzle.</p>
<p>Callers of this function can pass any type of swizzle as the first
parameter, i.e. any swizzle derived from <code>TSwizzleCBase</code>. The
required <code>TSwizzleC&lt;TAny&gt;</code> object is constructed from the
swizzle passed by the caller.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSwizzleC&lt;TAny&gt; aSwizzle</code></td>
<td class="Cell"><p class="ValueDesc">Any type of swizzle derived from <code>TSwizzleCBase</code>.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId</code></td>
<td class="Cell"><p class="ValueDesc">The required streamid.<code>KNullStreamId</code>, if no matching entry
can be found.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Find swizzle associated with stream id</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aCStoreMap%3a%3aLabel%28%29"></a>
<hr size="1" noshade>
<h3><code>Label()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TSwizzleC&lt;TAny&gt; Label(TStreamId anId) const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the swizzle in the store map assocated with the specified stream
id.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TStreamId anId</code></td>
<td class="Cell"><p class="ValueDesc">The id of the stream</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TSwizzleC&lt;TAny&gt;</code></td>
<td class="Cell"><p class="ValueDesc">The associated swizzle. If there is no matching swizzle, then this is an
uninitialized swizzle.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
