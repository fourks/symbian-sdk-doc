<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CCommsDatabase</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CCommsDatabasebaseClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CCommsDbConnectionPrefTableViewClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">CommDb</a>&nbsp;<span class="separator">&#187;</span>
CCommsDatabase</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> commdb.h </code>
<br>Link against: <code> commdb.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aCCommsDatabase"></a>

<h1>Class <code>CCommsDatabase</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDatabase</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Accesses the communications
database through the DBMS. </p><p>An object of this type must be constructed and
opened by a client before any of the tables in the database can be
accessed.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CCommsDatabase</code></td><td class="Cell">Accesses the communications database through the DBMS</td>
</tr>
<tr><td class="Cell"><code><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase">CCommsDatabaseBase</a></code></td><td class="Cell">Base class for CCommsDatabase</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CCommsDatabase</code>:
<br><code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aBeginTransaction%28%29" title="Marks the start of a transaction and gets a shared read-lock on the database">BeginTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aCancelRequestNotification%28%29" title="Cancels an outstanding request for notification of changes to the communications database">CancelRequestNotification()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aClearGlobalSettingL%28%29" title="Clears a global settings table field">ClearGlobalSettingL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aClose%28%29" title="Compacts, closes, and disconnects from, the communications database">Close()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aCloseDatabase%28%29" title="Compacts and closes the communications database">CloseDatabase()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aCommitTransaction%28%29" title="Marks the end of a transaction and commits any changes made since the start of the transaction">CommitTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aGetClientTimeoutL%28%29" title="Gets the client timeout value from the communications database">GetClientTimeoutL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aGetCurrentDialOutSettingL%28%29" title="Gets the default ISP, location or modem for dial-out">GetCurrentDialOutSettingL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aGetDefaultRecordL%28%29" title="Gets the Id of the default record belonging to a specified table">GetDefaultRecordL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aGetGlobalSettingL%28%29" title="Gets a global settings table string field">GetGlobalSettingL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aGetRouteTimeoutL%28%29" title="Gets the route timeout value from the communications database">GetRouteTimeoutL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aInTransaction%28%29" title="Tests whether a transaction is in progress, i.e">InTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aNewL%28%29" title="Allocates and constructs a new communications database object on the heap">NewL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpen%28%29" title="Connects to the DBMS">Open()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableInRankOrderLC%28%29" title="Opens a view on the records in the Connection Preferences table with a specified direction, and with records sorted into ranking order">OpenConnectionPrefTableInRankOrderLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableLC%28%29" title="Opens a view on the records in the Connection Preferences table with a specified direction">OpenConnectionPrefTableLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableViewOnRankLC%28%29" title="Opens a view on the records in the Connection Preferences table with a specified direction and ranking">OpenConnectionPrefTableViewOnRankLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenIAPTableViewMatchingBearerSetLC%28%29" title="Opens a view on records in the IAP table with a specified range of service types">OpenIAPTableViewMatchingBearerSetLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenTableLC%28%29" title="Opens a view onto a whole table and returns a pointer to that view">OpenTableLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenViewLC%28%29" title="Opens a view onto a specified table based on an explicitly coded SQL query, and returns a pointer to that view">OpenViewLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenViewMatchingBoolLC%28%29" title="Opens a view onto a specified table based on a matching boolean value, and returns a pointer to that view">OpenViewMatchingBoolLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenViewMatchingTextLC%28%29" title="Opens a view onto a specified table based on a matching 16 bit text type, and returns a pointer to that view">OpenViewMatchingTextLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenViewMatchingUintLC%28%29" title="Opens a view onto a specified table based on a matching unsigned integer value, and returns a pointer to that view">OpenViewMatchingUintLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aOpenViewOnProxyRecordLC%28%29" title="Opens a view on records in the Proxies table with a specified range of service types and service IDs">OpenViewOnProxyRecordLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aRequestNotification%28%29" title="Requests notification when any change is made to the database, whether by this client or any other">RequestNotification()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aResolvePhoneNumberFromDatabaseL%28%29" title="Resolves the telephone number supplied in the descriptor and places it into a reference containing the parsed number">ResolvePhoneNumberFromDatabaseL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aResolvePhoneNumberL%28%29" title="Resolves a telephone number and places it into a reference containing the parsed number">ResolvePhoneNumberL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aRollbackTransaction%28%29" title="Marks the end of a transaction and abandons any changes made since the start of the transaction">RollbackTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aSetClientTimeoutL%28%29" title="Sets the value of the client timeout in the communications database">SetClientTimeoutL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aSetDefaultRecordL%28%29" title="Identifies, to CommDb, the Id of the default record belonging to a specified table">SetDefaultRecordL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aSetGlobalSettingL%28%29" title="Sets a global settings table string field">SetGlobalSettingL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aSetRouteTimeoutL%28%29" title="Sets the value of the route timeout value in the communications database">SetRouteTimeoutL()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aShowHiddenRecords%28%29" title="Ensures that hidden records are included in the search criteria when creating views using the member functions:">ShowHiddenRecords()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3aType%28%29" title="Gets the database type">Type()</a></code>, <code class="ApiItem"><a href="CCommsDatabaseClass.html#%3a%3aCCommsDatabase%3a%3a%7eCCommsDatabase%28%29" title="Frees all resources owned by this object, prior to its destruction">~CCommsDatabase()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase" title="Base class for CCommsDatabase">CCommsDatabaseBase</a></code>:
<br><code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aIsDatabaseWriteLockedL%28%29" title="Tests if database is write locked">IsDatabaseWriteLockedL()</a></code>,
<code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aVersion%28%29" title="Gets the version of the underlying DBMS">Version()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Allocation and construction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CCommsDatabase* NewL(TCommDbDatabaseType aType);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a new communications database object
on the heap.</p>
<p>The function creates the directory for the database file and
creates a database with empty tables if there is no existing database. It also
connects the DBMS server and opens the database for shared access. It leaves
with an error if the database and server are not opened successfully. The error
can be any error returned by calls to the file server or the DBMS server.
</p>
<p>The database and the connection to the server are closed on
deletion of all instantiations of <code>CCommsDatabase</code>.</p><p></p><p>The <code>aType</code> parameter indicates the type of database
the client is expecting to open. The two types are:</p>
<ul>
<li>
<p>IAP type: the database has an IAP table, which defines sets
of ISP, modem, location and chargecards which may be used together.</p>
</li>
<li>
<p>ISP type: the database is arranged using separate ISP,
location, modem and chargecard tables whose records are not associated by using
IAPs.</p>
</li>
</ul>
<p>These two types cannot co-exist: any particular database is of
one type or the other. If the client knows which type of database it wants to
open, then it should use the appropriate parameter. If on the other hand it
does not mind which type the database is, it can specify the type as unknown.
Note, however, that if the type is unknown, a database must already exist. If
not, the type must be specified. </p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommDbDatabaseType aType </code></td>
<td class="Cell"><p class="ValueDesc"> Type of database </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDatabase* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to a communications database object </p></td>
</tr>
</table></td></tr></table>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CCommsDatabase* NewL();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Allocates and constructs a new communications database object on
the heap.</p>
<p>If there is insufficient memory available to create the object,
the function leaves. If allocation is successful, it returns a pointer to the
new object.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDatabase* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to a communications database object </p></td>
</tr>
</table></td></tr></table>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Destruction</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3a%7eCCommsDatabase%28%29"></a>
<hr size="1" noshade>
<h3><code>~CCommsDatabase()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CCommsDatabase();</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Frees all resources owned by this object, prior to its
destruction.</p>
<p>In particular, the destructor closes the communications database
and disconnects from the DBMS.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Database type</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aType%28%29"></a>
<hr size="1" noshade>
<h3><code>Type()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TCommDbDatabaseType Type() const;</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the database type.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TCommDbDatabaseType </code></td>
<td class="Cell"><p class="ValueDesc">
<code>
</code>
</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Global settings</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetGlobalSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetGlobalSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetGlobalSettingL(const TDesC&amp; aSetting, TUint32&amp; aVal);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets a global settings table integer field.</p>
<p>Note that:</p><ul><li><p>If a client attempts to get the default Dial Out IAP with a Version 6.1 database, the function gets the default IAP in the first connection preference for the outgoing direction if it is a dial out ISP-type IAP and returns its ID, otherwise an error is returned.</p></li><li><p>If a client attempts to get the <code>ASK_USER_BEFORE_DIAL</code> field with a Version 6.1 database, the function returns a true value if <code>CONNECT_PREF_DIALOG_PREF</code> in the first connection preference has been set to produce a prompt, otherwise false.</p></li></ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting </code></td>
<td class="Cell"><p class="ValueDesc"> Setting to get </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32&amp; aVal </code></td>
<td class="Cell"><p class="ValueDesc"> On return, setting value </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotSupported</code></td>
<td class="Cell"><p class="ValueDesc"><code>aSetting</code> is invalid</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotFound</code></td>
<td class="Cell"><p class="ValueDesc">The global setting has not been set</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetGlobalSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetGlobalSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetGlobalSettingL(const TDesC&amp; aSetting, TDes&amp; aVal);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets a global settings table string field.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting </code></td>
<td class="Cell"><p class="ValueDesc"> Setting to get </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes&amp; aVal </code></td>
<td class="Cell"><p class="ValueDesc"> On return, setting value </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotSupported</code></td>
<td class="Cell"><p class="ValueDesc"><code>aSetting</code> is invalid</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotFound</code></td>
<td class="Cell"><p class="ValueDesc">The global setting has not been set</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aSetGlobalSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetGlobalSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetGlobalSettingL(const TDesC&amp; aSetting, TUint32 aVal);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Sets a global settings table integer field.</p><ul><li><p>If a client attempts to set the default Dial Out IAP with a Version 6.1 database, the function sets the default IAP in the first connection preference for the outgoing direction to the specified IAP, and the bearer set to CSD.</p></li><li><p>If a client attempts to set the <code>ASK_USER_BEFORE_DIAL</code> field with a Version 6.1 database, the function sets <code>CONNECT_PREF_DIALOG_PREF</code> in the first connection preference to produce a prompt if true is specified, or do not prompt if  false is specified.</p></li></ul>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting </code></td>
<td class="Cell"><p class="ValueDesc"> Setting to get </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aVal </code></td>
<td class="Cell"><p class="ValueDesc"> Setting value </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotSupported</code></td>
<td class="Cell"><p class="ValueDesc"><code>aSetting</code> is invalid</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aSetGlobalSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetGlobalSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetGlobalSettingL(const TDesC&amp; aSetting, const TDesC&amp; aVal); </code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Sets a global settings table string field.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting </code></td>
<td class="Cell"><p class="ValueDesc"> Setting to get </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aVal </code></td>
<td class="Cell"><p class="ValueDesc"> Setting value </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotSupported</code></td>
<td class="Cell"><p class="ValueDesc"><code>aSetting</code> is invalid</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.6"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aClearGlobalSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>ClearGlobalSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ClearGlobalSettingL(const TDesC&amp; aSetting);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Clears a global settings table field.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting </code></td>
<td class="Cell"><p class="ValueDesc"> Setting to clear </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNotSupported</code></td>
<td class="Cell"><p class="ValueDesc"><code>aSetting</code> is invalid</p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Simple access to dial-out settings</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetCurrentDialOutSettingL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetCurrentDialOutSettingL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetCurrentDialOutSettingL(const TDesC&amp; aSetting, TUint32&amp; aValue);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the default ISP, location or modem for dial-out.</p><p>This function is not used with IAP databases.</p>
<p>The function is provided for simplicity, as its use is not dependent on a
database type.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSetting</code></td>
<td class="Cell"><p class="ValueDesc">Setting to get</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32&amp; aValue</code></td>
<td class="Cell"><p class="ValueDesc">On return, setting value</p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Open the database</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpen%28%29"></a>
<hr size="1" noshade>
<h3><code>Open()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Open();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Connects to the DBMS. </p><p>If the communications database does not exist, it
is created with an empty set of tables before the connection to the server
takes place.</p>
<p>The database is opened for shared access.</p>
<p>This function can be called any number of times on
this<code>CCommsDatabase</code> object; however, creation of the communications
database and connection to the DBMS server only occur on the first call
to<code>Open()</code>.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Close();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Compacts, closes, and disconnects from, the communications
database.</p>
<p>If there has been more than one earlier call to <code>Open()</code> on
this <code>CCommsDatabase</code> object and this call is not the last call
to<code>Close()</code>, then the database remains open, it is not compacted and
the connection to the DBMS remains active.</p>
<p>If this is the last call to <code>Close()</code> on
this<code>CCommsDatabase</code> object, then any outstanding notification
request is cancelled.</p>
<p><code>Close()</code> can be safely called, if the database has already
been closed and the connection to the DBMS removed.</p>
<a name="2.11.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aCloseDatabase%28%29"></a>
<hr size="1" noshade>
<h3><code>CloseDatabase()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CloseDatabase();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Compacts and closes the communications database.</p>
<p>If there has been more than one earlier call to <code>Open()</code> on
this <code>CCommsDatabase</code> object and this call is not the last call
to<code>CloseDatabase()</code>, then the database remains open and is not
compacted.</p>
<p><code>CloseDatabase()</code> can be safely called, if the database has
already been closed.</p>
<p>Notes:</p>
<p>This function does not disconnect the client from the DBMS. The
connection can be severed later by calling <code>Close()</code>.</p>
<p>If there is an outstanding request for notification of changes to the
database, then this request remains outstanding while the connection to the
DBMS remains.</p>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Notification service</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aRequestNotification%28%29"></a>
<hr size="1" noshade>
<h3><code>RequestNotification()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt RequestNotification(TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Requests notification when any change is made to the database, whether by
this client or any other.</p>
<p>The request is an asynchronous request.</p>
<p>When any change is made to the database, the outstanding notification
request completes and <code>TRequestStatus</code> contains a value indicating
what type of change has occurred. The value is one of the enumerators of
the<code>RDbNotifier::TEvent</code> enumeration defined in d32dbms.h.</p>
<p>Alternatively, if an outstanding notification request is cancelled by a
call to this<code>CCommsDatabase</code>'s<code>CancelRequestNotification()</code>member
function, then the request completes with a<code>KErrCancel</code>.</p>
<p>An outstanding notification request is also cancelled if the connection
to the DBMS is severed through a call to <code>Close()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the request status object. If the request is cancelled,
this is set to <code>KErrCancel</code>. If the request completes normally, this
is set to one of the enumerators of
the<code>RDbNotifier::TEvent</code>enumeration. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.12.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aCancelRequestNotification%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelRequestNotification()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelRequestNotification();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding request for notification of changes to the
communications database.</p>
<p>An outstanding request completes with <code>KErrCancel</code>.</p>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Open views onto a table in the communications database</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenTableLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenTableLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenTableLC(const TDesC&amp; aTableName);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a whole table&nbsp;and returns a pointer to that
view.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
named in <code>aTablename</code> does not exist. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewMatchingUintLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingUintLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingUintLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, TUint32 aValueToMatch);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching unsigned integer
value, and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the unsigned integer
value<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The value to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewMatchingBoolLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingBoolLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingBoolLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, TBool aValueToMatch);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching boolean value,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the boolean
value<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The value to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewMatchingTextLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingTextLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingTextLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, const TDesC8&amp; aValueToMatch);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching 8 bit text type,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the narrow text supplied in the
descriptor<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<p>The function generates an SQL query to create the view.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The narrow (ASCII) text to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.6"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewMatchingTextLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingTextLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingTextLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, const TDesC16&amp; aValueToMatch);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching 16 bit text type,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the wide text supplied in the
descriptor<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC16&amp; aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The wide (Unicode) text to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.13.7"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewLC(const TDesC&amp; aTableName, const TDesC&amp; aSqlQuery);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on an explicitly coded SQL
query, and returns a pointer to that view.</p>
<p>The view includes all those records which match the SQL query supplied in
the descriptor <code>aSqlQuery</code>. It is the caller's responsibility to
code this query correctly.</p>
<p>As the SQL query is defined by the caller, the resulting view does not
exclude hidden records unless explicitly stated in the query itself. To exclude
hidden records, insert Hidden=0 as a search condition into the SQL query
text.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSqlQuery </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the SQL query text </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.14"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Opening a view on the Connection Preferences table</h2>
</div><div class="Bodytext"><h4 class="subheading">Description</h4>
<p>Views on the Connection Preferences table cannot be opened with the generic functions such as <code>CCommsDatabaseBase::OpenViewLC()</code>. Instead, one of the following must be used.</p><h4 class="subheading">See also:</h4>
<ul>
<li><a href="ConnPreferencesTable.html#commdb%2econnprefs%2dtable">Connection preferences table</a></li>
</ul>
<a name="2.14.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenConnectionPrefTableLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbConnectionPrefTableView* OpenConnectionPrefTableLC();</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on the Connection Preferences table.</p><p>When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbConnectionPrefTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNoMemory</code>, or DBMS-related errors</p></td>
</tr>
</table></td></tr></table>
<a name="2.14.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenConnectionPrefTableLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbConnectionPrefTableView* OpenConnectionPrefTableLC(TCommDbConnectionDirection aDirection);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on the records in the Connection Preferences table with a specified direction.</p><p>When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TCommDbConnectionDirection aDirection</code></td>
<td class="Cell"><p class="ValueDesc">Direction of the records to include in the view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbConnectionPrefTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNoMemory</code>, or DBMS-related errors</p></td>
</tr>
</table></td></tr></table>
<a name="2.14.6"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableInRankOrderLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenConnectionPrefTableInRankOrderLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbConnectionPrefTableView* OpenConnectionPrefTableInRankOrderLC(TCommDbConnectionDirection aDirection);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on the records in the Connection Preferences table with a specified direction, and with records sorted into ranking order.</p><p>Records are sorted in rank order from ranking 1 first. Records with rank 0 are not included.</p><p>When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TCommDbConnectionDirection aDirection</code></td>
<td class="Cell"><p class="ValueDesc">Direction of the records to include in the view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbConnectionPrefTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNoMemory</code>, or DBMS-related errors</p></td>
</tr>
</table></td></tr></table>
<a name="2.14.7"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenConnectionPrefTableViewOnRankLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenConnectionPrefTableViewOnRankLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbConnectionPrefTableView* OpenConnectionPrefTableViewOnRankLC(TCommDbConnectionDirection aDirection, TUint32 aRank);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on the records in the Connection Preferences table with a specified direction and ranking.</p><p>When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TCommDbConnectionDirection aDirection</code></td>
<td class="Cell"><p class="ValueDesc">Direction of the records to include in the view</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TUint32 aRank</code></td>
<td class="Cell"><p class="ValueDesc">Ranking of the records to include in the view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbConnectionPrefTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNoMemory</code>, or DBMS-related errors; <code>KErrOverflow</code> if the value of <code>aRank</code> exceeds the maximum allowed.</p></td>
</tr>
</table></td></tr></table>
<a name="2.15"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Opening views by matching service type</h2>
</div><div class="Bodytext">
<a name="2.15.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenIAPTableViewMatchingBearerSetLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenIAPTableViewMatchingBearerSetLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenIAPTableViewMatchingBearerSetLC(TUint32 aBearerSet, TCommDbConnectionDirection aDirection);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on records in the IAP table with a specified range of service types.</p><p>IAP records are included that have matching bearers and direction, as read from the Connection preference table, to those specified.</p><p>When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TUint32 aBearerSet</code></td>
<td class="Cell"><p class="ValueDesc">Bearers to match. For suitable values, see <code>CONNECT_PREF_BEARER_SET</code> in the Connection preferences table.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TCommDbConnectionDirection aDirection</code></td>
<td class="Cell"><p class="ValueDesc">Direction to match</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrArgument</code></td>
<td class="Cell"><p class="ValueDesc">Either <code>aBearerSet</code> or <code>aDirection</code> is invalid.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">Other</code></td>
<td class="Cell"><p class="ValueDesc">DBMS-related error codes</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="ConnPreferencesTable.html#commdb%2econnprefs%2dtable">Connection preferences table</a></li>
<li><a href="IAPTable.html#commdb%2eiap%2dtable"> IAP table</a></li>
</ul>
<a name="2.15.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aOpenViewOnProxyRecordLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewOnProxyRecordLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewOnProxyRecordLC(TUint32 aServiceId, const TDesC&amp; aServiceType);</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.1
</p><h4 class="subheading">Description</h4>
<p>Opens a view on records in the Proxies table with a specified range of service types and service IDs.</p><p>Proxies records are included that have matching service types and IDs. When the use of the view object is complete, it should be popped from the cleanup stack, and deleted.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TUint32 aServiceId</code></td>
<td class="Cell"><p class="ValueDesc">ID of the service to match</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC&amp; aServiceType</code></td>
<td class="Cell"><p class="ValueDesc">Service type to match</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CCommsDbTableView*</code></td>
<td class="Cell"><p class="ValueDesc">The opened view</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrArgument</code></td>
<td class="Cell"><p class="ValueDesc">Either <code>aServiceId</code> or <code>aServiceType</code> is invalid.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">Other</code></td>
<td class="Cell"><p class="ValueDesc">DBMS-related error codes</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="ProxiesTable.html#commdb%2eproxies%2dtable">Proxies table</a></li>
</ul>
<a name="2.16"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Transaction support</h2>
</div><div class="Bodytext">
<a name="2.16.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aBeginTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>BeginTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt BeginTransaction();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Marks the start of a transaction and gets a shared read-lock on the
database. Other clients of the database can concurrently acquire a shared
read-lock but no client can gain an exclusive write-lock until this transaction
(and any transaction started by other clients) completes as a result of a call
to either <code>CommitTransaction()</code>or<code>RollbackTransaction()</code>.</p>
<p>Note:</p>
<ul>
<li>
<p>A transaction consists of one or more record updates and/or insertions
and/or deletions. The process of making changes to records within a view is
part of <code>CCommsDbTableView</code> behaviour. See
the<code>InsertRecord()</code>,<code>UpdateRecord()</code>,<code>DeleteRecord()</code>,<code>PutRecordChanges()</code>and<code>CancelRecordChanges()</code>
member functions of the<code>CCommsDbTableView</code> class.</p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if the database has been successfully locked; the
transaction can start. <code>KErrLocked</code> if another client already has an
exclusive write-lock on the database. </p></td>
</tr>
</table></td></tr></table>
<a name="2.16.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aCommitTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>CommitTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt CommitTransaction();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Marks the end of a transaction and commits any changes made since the
start of the transaction. The client's shared read-lock is removed if no write
operations were performed, or the exclusive write-lock is removed if write
operations were performed.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.16.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aRollbackTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>RollbackTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RollbackTransaction();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Marks the end of a transaction and abandons any changes made since the
start of the transaction. The database is, in effect, rolled back to the state
it was in at the beginning of the transaction. The client's shared read-lock is
removed if no write operations were performed, or the exclusive write-lock is
removed if write operations were performed.</p>
<a name="2.16.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aInTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>InTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TBool InTransaction();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Tests whether a transaction is in progress, i.e. whether a call
to<code>BeginTransaction()</code> has been called.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool </code></td>
<td class="Cell"><p class="ValueDesc"> true, if a transaction is in progress; false, otherwise. </p></td>
</tr>
</table></td></tr></table>
<a name="2.17"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Default record handling</h2>
</div><div class="Bodytext">
<a name="2.17.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetDefaultRecordL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetDefaultRecordL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetDefaultRecordL(const TDesC&amp; aTableName, TUint32&amp; aId);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the Id of the default record belonging to a specified table. The Id
is copied into <code>aId</code>.</p>
<p>The only tables which can have a default record are:</p>
<ul>
<li>
<p>the dial out service table, with symbolic
name <code>DIAL_OUT_SERVICE</code></p>
</li>
<li>
<p>the dial in service table, with symbolic
name <code>DIAL_IN_SERVICE</code></p>
</li>
<li>
<p>the connected modem table, with symbolic
name <code>CONNECTED_MODEM</code></p>
</li>
<li>
<p>the modem preferences table, with symbolic
name <code>MODEM_PREFS</code></p>
</li>
<li>
<p>the location table, with symbolic name <code>LOCATION</code>.</p>
</li>
</ul>
<p>Note:</p>
<ul>
<li>
<p>The default record can be a hidden record.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName</code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32&amp; aId</code></td>
<td class="Cell"><p class="ValueDesc"> A reference to an unsigned integer passed by the caller. On successful
return from this function, contains the Id of the default record. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function leaves with <code>KErrNotSupported</code> if it is called
for any other table than those specified above. </p></td>
</tr>
</table></td></tr></table>
<a name="2.17.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aSetDefaultRecordL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetDefaultRecordL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetDefaultRecordL(const TDesC&amp; aTableName, TUint32 aId);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Identifies, to CommDb, the Id of the default record belonging to a
specified table.</p>
<p>Note:</p>
<ul>
<li>
<p>The default record can be a hidden record.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aId </code></td>
<td class="Cell"><p class="ValueDesc"> The Id of the record in table <code>aTableName</code> which is to be the
default record of this table. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function leaves with <code>KErrNotSupported</code> if the table name
passed in does not have a default record. E.g. Not all tables can have a
default record; if the table name passed in <code>aTableName</code> is not one
of: <code>DIAL_OUT_SERVICE</code> (the dial-out service table),
<code>CONNECTED_MODEM</code> (the connected modem table),
<code>MODEM_PREFS</code> (the modem preferences table), <code>LOCATION</code>,
(the location table) then this function leaves
with<code>KErrNotSupported</code> . </p></td>
</tr>
</table></td></tr></table>
<a name="2.18"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Hidden records</h2>
</div><div class="Bodytext">
<a name="2.18.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aShowHiddenRecords%28%29"></a>
<hr size="1" noshade>
<h3><code>ShowHiddenRecords()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt ShowHiddenRecords();</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Ensures that hidden records are included in the search criteria when
creating views using the member functions:</p>
<ul>
<li>
<p><code>OpenTableLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingUintLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingBoolLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingTextLC()</code></p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> always. </p></td>
</tr>
</table></td></tr></table>
<a name="2.19"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Accessing timeouts</h2>
</div><div class="Bodytext">
<a name="2.19.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetClientTimeoutL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetClientTimeoutL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetClientTimeoutL(TUint32&amp; aTimeout);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the client timeout value from the communications database.</p>
<p>The function puts the value into <code>aTimeout</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32&amp; aTimeout </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to an unsigned integer passed by the caller. On successful
return from this function, contains a copy of the client timeout value. </p></td>
</tr>
</table></td></tr></table>
<a name="2.19.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aSetClientTimeoutL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetClientTimeoutL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetClientTimeoutL(const TUint32 aTimeout);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Sets the value of the client timeout in the communications
database.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aTimeout </code></td>
<td class="Cell"><p class="ValueDesc"> The client timeout value to be set. </p></td>
</tr>
</table></td></tr></table>
<a name="2.19.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aGetRouteTimeoutL%28%29"></a>
<hr size="1" noshade>
<h3><code>GetRouteTimeoutL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void GetRouteTimeoutL(TUint32&amp; aTimeout);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Gets the route timeout value from the communications database.</p>
<p>The function puts the value into <code>aTimeout</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32&amp; aTimeout </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to an unsigned integer passed by the caller. On successful
return from this function, contains a copy of the route timeout value. </p></td>
</tr>
</table></td></tr></table>
<a name="2.19.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aSetRouteTimeoutL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetRouteTimeoutL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetRouteTimeoutL(const TUint32 aTimeout);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Sets the value of the route timeout value in the communications
database.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aTimeout </code></td>
<td class="Cell"><p class="ValueDesc"> The route timeout value to be set. </p></td>
</tr>
</table></td></tr></table>
<a name="2.20"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Resolve phone number</h2>
</div><div class="Bodytext">
<a name="2.20.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aResolvePhoneNumberL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResolvePhoneNumberL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static void ResolvePhoneNumberL(TDesC&amp; aNumber, TDes8&amp; aDialString, TParseMode aDialParseMode);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Resolves a telephone number and places it into a reference containing the
parsed number. The resolution of the number uses the default location table
record to determine dialling codes and formats.</p>
<p>All read operations to tables within the database are wrapped within a
transaction.</p>
<p>The function does not resolve for mobile phones; <code>aNumber</code> is
just copied to <code>aDialString</code>.</p>
<p>Note:</p>
<ul>
<li>
<p>The function is static and does not need an explicitly constructed
instance of a <code>CCommsDatabase</code> object. Opening and accessing the
communications database is handled implicitly by the function.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC&amp; aNumber </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the descriptor containing the number to be parsed.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes&amp; aDialString </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor; on return from the function, contains the
parsed number. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TParseMode aDialParseMode </code></td>
<td class="Cell"><p class="ValueDesc"> The parse mode: indicates whether the parsed string is intended for
dialling or for display. This enumerator is defined in <!--filename style useddial.h-->dial.h</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function leaves if there is no default record in the location
table.</p></td>
</tr>
</table></td></tr></table>
<a name="2.20.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabase%3a%3aResolvePhoneNumberFromDatabaseL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResolvePhoneNumberFromDatabaseL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResolvePhoneNumberFromDatabaseL(TDesC&amp; aNumber, TDes8&amp; aDialString, TParseMode aDialParseMode);</code></p><h4 class="subheading">Support</h4>
<p>Withdrawn in 6.0
</p><h4 class="subheading">Description</h4>
<p>Resolves the telephone number supplied in the descriptor and places it
into a reference containing the parsed number.</p>
<p>The resolution of the number uses the default record to determine
dialling codes and formats.</p>
<p>The function does not resolve for mobile phones; <code>aNumber</code> is
just copied to <code>aDialString</code>.</p>
<p>Note:</p>
<ul>
<li>
<p>Unlike the static function <code>ResolvePhoneNumberL()</code> this
function does not wrap read operations in a transaction.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC&amp; aNumber </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the descriptor containing the number to be parsed.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes&amp; aDialString </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor; on return from the function, contains the
parsed number. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TParseMode aDialParseMode </code></td>
<td class="Cell"><p class="ValueDesc"> The parse mode: indicates whether the parsed string is intended for
dialling or for display. This enumerator is defined in <!--filename style useddial.h-->dial.h</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function leaves if there is no default record in the location
table.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
