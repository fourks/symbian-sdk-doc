<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CCommsDatabaseBase</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CCommDbOverrideSettingsClass.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CCommsDatabaseClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">CommDb</a>&nbsp;<span class="separator">&#187;</span>
CCommsDatabaseBase</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> commdb.h </code>
<br>Link against: <code> commdb.lib </code>
</p>
</div><div class="Head1">
<a name="%3a%3aCCommsDatabaseBase"></a>

<h1>Class <code>CCommsDatabaseBase</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDatabaseBase</code></p><h4 class="subheading">Support</h4>
<p>Supported from 6.0
</p><h4 class="subheading">Description</h4>
<p>Base class for <code>CCommsDatabase</code>. This class is never
instantiated, but its member functions are used through the derived
class.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CCommsDatabaseBase</code></td><td class="Cell">Base class for CCommsDatabase</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CCommsDatabaseBase</code>:
<br><code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aBeginTransaction%28%29" title="Marks the start of a transaction and gets a shared read-lock on the database">BeginTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aCCommsDatabaseBase%28%29" title="Default constructor">CCommsDatabaseBase()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aCancelRequestNotification%28%29" title="Cancels an outstanding request for notification of changes to the communications database">CancelRequestNotification()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aCommitTransaction%28%29" title="Marks the end of a transaction and commits any changes made since the start of the transaction">CommitTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aInTransaction%28%29" title="Tests whether a transaction is in progress, i.e">InTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aIsDatabaseWriteLockedL%28%29" title="Tests if database is write locked">IsDatabaseWriteLockedL()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aOpenTableLC%28%29" title="Opens a view onto a whole table and returns a pointer to that view">OpenTableLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aOpenViewLC%28%29" title="Opens a view onto a specified table based on an explicitly coded SQL query, and returns a pointer to that view">OpenViewLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingBoolLC%28%29" title="Opens a view onto a specified table based on a matching boolean value, and returns a pointer to that view">OpenViewMatchingBoolLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingTextLC%28%29" title="Opens a view onto a specified table based on a matching 16 bit text type, and returns a pointer to that view">OpenViewMatchingTextLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingUintLC%28%29" title="Opens a view onto a specified table based on a matching unsigned integer value, and returns a pointer to that view">OpenViewMatchingUintLC()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aRequestNotification%28%29" title="Requests notification when any change is made to the database, whether by this client or any other">RequestNotification()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aResolvePhoneNumberFromDatabaseL%28%29" title="Resolves a telephone number based on a specified dialling location and chargecard">ResolvePhoneNumberFromDatabaseL()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aResolvePhoneNumberL%28%29" title="Resolves a telephone number based on a specified dialling location and chargecard">ResolvePhoneNumberL()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aRollbackTransaction%28%29" title="Marks the end of a transaction and abandons any changes made since the start of the transaction">RollbackTransaction()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aShowHiddenRecords%28%29" title="Ensures that hidden records are included in the search criteria when creating views using the member functions:">ShowHiddenRecords()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3aVersion%28%29" title="Gets the version of the underlying DBMS">Version()</a></code>, <code class="ApiItem"><a href="CCommsDatabasebaseClass.html#%3a%3aCCommsDatabaseBase%3a%3a%7eCCommsDatabaseBase%28%29" title="Destructor">~CCommsDatabaseBase()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aCCommsDatabaseBase%28%29"></a>
<hr size="1" noshade>
<h3><code>CCommsDatabaseBase()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDatabaseBase();</code></p><h4 class="subheading">Description</h4>
<p>Default constructor.</p>
<a name="2.6.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3a%7eCCommsDatabaseBase%28%29"></a>
<hr size="1" noshade>
<h3><code>~CCommsDatabaseBase()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CCommsDatabaseBase();</code></p><h4 class="subheading">Description</h4>
<p>Destructor.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Locking</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aIsDatabaseWriteLockedL%28%29"></a>
<hr size="1" noshade>
<h3><code>IsDatabaseWriteLockedL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TBool IsDatabaseWriteLockedL();</code></p><h4 class="subheading">Description</h4>
<p>Tests if database is write locked.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool </code></td>
<td class="Cell"><p class="ValueDesc">
<code>
</code>
</p></td>
</tr>
</table></td></tr></table>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Underlying DBMS version information</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aVersion%28%29"></a>
<hr size="1" noshade>
<h3><code>Version()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TVersion Version() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the version of the underlying DBMS.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TVersion </code></td>
<td class="Cell"><p class="ValueDesc"> The object containing the version information. </p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Notification service</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aRequestNotification%28%29"></a>
<hr size="1" noshade>
<h3><code>RequestNotification()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt RequestNotification(TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Requests notification when any change is made to the database, whether
by this client or any other.</p>
<p>The request is an asynchronous request.</p>
<p>When any change is made to the database, the outstanding notification
request completes and <code>TRequestStatus</code> contains a value indicating
what type of change has occurred. The value is one of the enumerators of the
<code>RDbNotifier::TEvent</code> enumeration defined in d32dbms.h.</p>
<p>Alternatively, if an outstanding notification request is cancelled by a
call to this <code>CCommsDatabase</code>'s
<code>CancelRequestNotification()</code> member function, then the request
completes with a <code>KErrCancel</code>.</p>
<p>An outstanding notification request is also cancelled if the connection
to the DBMS is severed through a call to <code>Close()</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TRequestStatus&amp; aStatus </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the request status object. If the request is cancelled,
this is set to <code>KErrCancel</code>. If the request completes normally, this
is set to one of the enumerators of the <code>RDbNotifier::TEvent</code>
enumeration. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aCancelRequestNotification%28%29"></a>
<hr size="1" noshade>
<h3><code>CancelRequestNotification()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CancelRequestNotification();</code></p><h4 class="subheading">Description</h4>
<p>Cancels an outstanding request for notification of changes to the
communications database.</p>
<p>An outstanding request completes with <code>KErrCancel</code>.</p>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Open views onto a table in the communications database</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenTableLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenTableLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenTableLC(const TDesC&amp; aTableName);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a whole table&nbsp;and returns a pointer to that
view.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
named in <code>aTablename</code> does not exist. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingUintLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingUintLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingUintLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, TUint32 aValueToMatch);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching unsigned integer
value, and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the unsigned integer
value<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The value to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingBoolLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingBoolLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingBoolLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, TBool aValueToMatch);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching boolean value,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the boolean
value<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The value to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingTextLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingTextLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingTextLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, const TDesC8&amp; aValueToMatch);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching 8 bit text type,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the narrow text supplied in the
descriptor<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<p>The function generates an SQL query to create the view.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The narrow (ASCII) text to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.6"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenViewMatchingTextLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewMatchingTextLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewMatchingTextLC(const TDesC&amp; aTableName, const TDesC&amp; aColumnToMatch, const TDesC16&amp; aValueToMatch);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on a matching 16 bit text type,
and returns a pointer to that view.</p>
<p>The view includes all those records where the column, identified
by<code>aColumnToMatch</code>, matches the wide text supplied in the
descriptor<code>aValueToMatch</code>.</p>
<p>The view excludes hidden records, unless access to them has previously
been explicitly requested by calling the <code>ShowHiddenRecords()</code>member
function of this object.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<p>Note:</p>
<ul>
<li>
<p>The function generates an SQL query to create the view.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aColumnToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of the column to be used
in the selection process. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC16&amp; aValueToMatch </code></td>
<td class="Cell"><p class="ValueDesc"> The wide (UNICODE) text to be matched with the content of
column<code>aColumnToMatch</code>. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10.7"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aOpenViewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenViewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCommsDbTableView* OpenViewLC(const TDesC&amp; aTableName, const TDesC&amp; aSqlQuery);</code></p><h4 class="subheading">Description</h4>
<p>Opens a view onto a specified table based on an explicitly coded SQL
query, and returns a pointer to that view.</p>
<p>The view includes all those records which match the SQL query supplied in
the descriptor <code>aSqlQuery</code>. It is the caller's responsibility to
code this query correctly.</p>
<p>As the SQL query is defined by the caller, the resulting view does not
exclude hidden records unless explicitly stated in the query itself. To exclude
hidden records, insert Hidden=0 as a search condition into the SQL query
text.</p>
<p>If the open process is succesful, the function constructs and returns a
pointer to a <code>CCommsDbTableView</code> object which encapsulates the
information on that view. The pointer is also put onto the cleanup
stack.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aTableName </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the name of a table in the
communications database. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC&amp; aSqlQuery </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor containing the SQL query text </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCommsDbTableView* </code></td>
<td class="Cell"><p class="ValueDesc"> A pointer to the view object. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function may leave for a number of reasons, for example, if the table
does not exist or the named column cannot be found. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Transaction support</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aBeginTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>BeginTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt BeginTransaction();</code></p><h4 class="subheading">Description</h4>
<p>Marks the start of a transaction and gets a shared read-lock on the
database. Other clients of the database can concurrently acquire a shared
read-lock but no client can gain an exclusive write-lock until this transaction
(and any transaction started by other clients) completes as a result of a call
to either
<code>CommitTransaction()</code>or<code>RollbackTransaction()</code>.</p>
<p>Note:</p>
<ul>
<li>
<p>A transaction consists of one or more record updates and/or insertions
and/or deletions. The process of making changes to records within a view is
part of <code>CCommsDbTableView</code> behaviour. See
the<code>InsertRecord()</code>,<code>UpdateRecord()</code>,<code>DeleteRecord()</code>,<code>PutRecordChanges()</code>
and<code>CancelRecordChanges()</code> member functions of
the<code>CCommsDbTableView</code> class.</p>
</li>
</ul><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if the database has been successfully locked; the
transaction can start. <code>KErrLocked</code> if another client already has an
exclusive write-lock on the database. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aCommitTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>CommitTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt CommitTransaction();</code></p><h4 class="subheading">Description</h4>
<p>Marks the end of a transaction and commits any changes made since the
start of the transaction. The client's shared read-lock is removed if no write
operations were performed, or the exclusive write-lock is removed if write
operations were performed.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt </code></td>
<td class="Cell"><p class="ValueDesc">
<code>KErrNone</code> if successful, otherwise another of the
system-wide error codes. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.4"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aRollbackTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>RollbackTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RollbackTransaction();</code></p><h4 class="subheading">Description</h4>
<p>Marks the end of a transaction and abandons any changes made since the
start of the transaction. The database is, in effect, rolled back to the state
it was in at the beginning of the transaction. The client's shared read-lock is
removed if no write operations were performed, or the exclusive write-lock is
removed if write operations were performed.</p>
<a name="2.11.5"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aInTransaction%28%29"></a>
<hr size="1" noshade>
<h3><code>InTransaction()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TBool InTransaction();</code></p><h4 class="subheading">Description</h4>
<p>Tests whether a transaction is in progress, i.e. whether a call
to<code>BeginTransaction()</code> has been called.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TBool </code></td>
<td class="Cell"><p class="ValueDesc"> true, if a transaction is in progress; false, otherwise. </p></td>
</tr>
</table></td></tr></table>
<a name="2.12"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Hidden records</h2>
</div><div class="Bodytext">
<a name="2.12.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aShowHiddenRecords%28%29"></a>
<hr size="1" noshade>
<h3><code>ShowHiddenRecords()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ShowHiddenRecords();</code></p><h4 class="subheading">Description</h4>
<p>Ensures that hidden records are included in the search criteria when
creating views using the member functions:</p>
<ul>
<li>
<p><code>OpenTableLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingUintLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingBoolLC()</code></p>
</li>
<li>
<p><code>OpenViewMatchingTextLC()</code></p>
</li>
</ul>
<a name="2.13"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Resolve phone number</h2>
</div><div class="Bodytext">
<a name="2.13.2"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aResolvePhoneNumberL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResolvePhoneNumberL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static void ResolvePhoneNumberL(TDesC&amp; aNumber, TDes&amp; aDialString, TParseMode aDialParseMode, TUint32 aLocationId, TUint32 aChargecardId);</code></p><h4 class="subheading">Description</h4>
<p>Resolves a telephone number based on a specified dialling location and
chargecard. The function does not require a connection to the database server,
but will form one itself.</p>
<p>The function does not resolve for mobile phones; <code>aNumber</code> is
just copied to <code>aDialString</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC&amp; aNumber </code></td>
<td class="Cell"><p class="ValueDesc"> The number to be parsed. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes&amp; aDialString </code></td>
<td class="Cell"><p class="ValueDesc"> On return from the function, contains the parsed number. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TParseMode aDialParseMode </code></td>
<td class="Cell"><p class="ValueDesc"> The parse mode: indicates whether the parsed string is intended for
dialling or for display. This enumerator is defined in <!--filename style useddial.h-->dial.h</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aLocationId </code></td>
<td class="Cell"><p class="ValueDesc"> ID of the location record </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aChargecardId </code></td>
<td class="Cell"><p class="ValueDesc"> ID of the chargecard ID to be used for resolution </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> Specified location and chargecard records cannot be found or with</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrOverflow </code></td>
<td class="Cell"><p class="ValueDesc">
<code>aDialString</code> is not long enough to hold the resolved
number.</p></td>
</tr>
</table></td></tr></table>
<a name="2.13.3"></a></div><div class="Head3">
<a name="%3a%3aCCommsDatabaseBase%3a%3aResolvePhoneNumberFromDatabaseL%28%29"></a>
<hr size="1" noshade>
<h3><code>ResolvePhoneNumberFromDatabaseL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ResolvePhoneNumberFromDatabaseL(TDesC&amp; aNumber, TDes&amp; aDialString, TParseMode aDialParseMode, TUint32 aLocationId, TUint32 aChargecardId);</code></p><h4 class="subheading">Description</h4>
<p>Resolves a telephone number based on a specified dialling location and
chargecard. A connection must already exist to the database.</p>
<p>The function does not resolve for mobile phones; <code>aNumber</code> is
just copied to <code>aDialString</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC&amp; aNumber </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to the descriptor containing the number to be parsed.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes&amp; aDialString </code></td>
<td class="Cell"><p class="ValueDesc"> A reference to a descriptor; on return from the function, contains the
parsed number. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TParseMode aDialParseMode </code></td>
<td class="Cell"><p class="ValueDesc"> The parse mode: indicates whether the parsed string is intended for
dialling or for display. This enumerator is defined in <!--filename style useddial.h-->dial.h</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aLocationId </code></td>
<td class="Cell"><p class="ValueDesc"> ID of the location record </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint32 aChargecardId </code></td>
<td class="Cell"><p class="ValueDesc"> ID of the chargecard ID to be used for resolution </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrNotFound </code></td>
<td class="Cell"><p class="ValueDesc"> Specified location and chargecard records cannot be found or with</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> KErrOverflow </code></td>
<td class="Cell"><p class="ValueDesc">
<code>aDialString</code> is not long enough to hold the resolved
number.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
