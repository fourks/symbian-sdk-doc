<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>MSocketNotify</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CServProviderBaseClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="TServerProtocolDescStruct.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Socket&nbsp;Server&nbsp;Protocols</a>&nbsp;<span class="separator">&#187;</span>
MSocketNotify</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code> es_prot.h </code><br>Link against: <code></code>
</p>
</div><div class="Head1">
<a name="%3a%3aMSocketNotify"></a>

<h1>Class <code>MSocketNotify</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>MSocketNotify</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Abstract base class used by a
<code>CServProviderBase</code>-derived object through its <code>iSocket</code>
member to notify the socket server that various events have occurred. The class
provides several up-call member functions.</p>
<p>All up-calls on the <code>MSocketNotify</code> should be made in
the context of the socket server&#8217;s thread&#0160;&#8212;  i.e. the thread which
called <code>NewSAPL()</code> on the protocol.</p>
<p>Defined in <code>MSocketNotify</code>:
<br><code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aCanClose%28%29" title="Indicates that the SAP has finished closing down">CanClose()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aCanSend%28%29" title="Indicates that new buffer space is available on a service">CanSend()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aConnectComplete%28%29" title="Indicates that a connection attempt has completed successfully">ConnectComplete()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aDisConnect%28%29" title="Indicates that the other end of a connection has disconnected">DisConnect()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEDelete" title="Delete SAP">EDelete</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEDetach" title="Don't delete SAP">EDetach</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorAllOperations" title="An error has occurred which affects all operations">EErrorAllOperations</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorClose" title="An error has occurred which affects Close() operations">EErrorClose</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorConnect" title="An error has occurred which affects Connect() operations">EErrorConnect</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorFatal" title="An fatal error has occurred">EErrorFatal</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorIoctl" title="An error has occurred which affects Ioctl() operations">EErrorIoctl</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorRecv" title="An error has occurred which affects Receive() operations">EErrorRecv</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aEErrorSend" title="An error has occurred which affects Send() operations">EErrorSend</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aError%28%29" title="Tells the socket server that an error state has arisen within the protocol">Error()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aIoctlComplete%28%29" title="Indicates that the currently pending Ioctl has completed">IoctlComplete()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aNewData%28%29" title="Indicates that new data is available on a service access point">NewData()</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aTDelete" title="Delete and detach flags">TDelete</a></code>, <code class="ApiItem"><a href="MSocketNotifyClass.html#%3a%3aMSocketNotify%3a%3aTOperationBitmasks" title="Error codes">TOperationBitmasks</a></code>
</p>
<a name="2.5"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Up-calls</h2>
</div><div class="Bodytext">
<a name="2.5.2"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aNewData%28%29"></a>
<hr size="1" noshade>
<h3><code>NewData()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void NewData(TUint aCount)=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that new data is available on a service access point.
For a stream-oriented protocol <code>aCount</code> should be a byte count; for
datagram-oriented sockets <code>aCount</code> should be a datagram
count.</p>
<p>Note that <code>aCount</code> is the amount of new data, not
the total amount of data waiting to be read.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint aCount </code></td>
<td class="Cell"><p class="ValueDesc"> The amount of new data. A value of
<code>KNewDataEndofData</code> indicates that socket is in a half-closed state
and will receive no more data. Any subsequent reads will complete with
<code>KErrEof</code> and length 0. </p></td>
</tr>
</table></td></tr></table>
<a name="2.5.3"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aCanSend%28%29"></a>
<hr size="1" noshade>
<h3><code>CanSend()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void CanSend()=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that new buffer space is available on a service </p>
<a name="2.5.4"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aConnectComplete%28%29"></a>
<hr size="1" noshade>
<h3><code>ConnectComplete()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void ConnectComplete()=0;<br>virtual void ConnectComplete(const TDesC8&amp; aConnectData)=0;<br>virtual void ConnectComplete(CServProviderBase&amp; aSSP)=0;<br>virtual void ConnectComplete(CServProviderBase&amp; aSSP,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const TDesC8 &amp;aConnectData)=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that a connection attempt has completed successfully.
There are four versions of this up-call: the first two are for active opens and
the second two are for passive opens. </p>
<p>Both active and passive versions support a variant carrying user
connection data for protocols which support it.</p>
<p>The last two versions of <code>ConnectComplete()</code>, which are
for passive opens, carry a new SSP (socket service provider, or SAP) for the
newly created socket. A new socket will then be linked up to the SSP and data
transfer can take place. The original socket stays listening.</p>
<p>Notes:</p>
<ul>
<li>
<p>A connection-less protocol should never call the
<code>ConnectComplete()</code> up-calls.</p>
</li>
<li>
<p>A protocol should keep a count of sockets which have called
<code>ConnectComplete()</code> but have not had <code>Start()</code> called.
Sockets in this state have their <code>Error()</code> and
<code>NewData()</code> calls deferred until <code>Start()</code> is
called.</p>
</li>
</ul>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CServProviderBase&amp; aSSP </code></td>
<td class="Cell"><p class="ValueDesc"> The new SSP for passive opens </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aConnectData </code></td>
<td class="Cell"><p class="ValueDesc"> Connect data (if supported) </p></td>
</tr>
</table></td></tr></table>
<a name="2.5.5"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aCanClose%28%29"></a>
<hr size="1" noshade>
<h3><code>CanClose()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void CanClose(TDelete aDelete=EDelete)=0;<br>virtual void CanClose(const TDesC8&amp; aDisconnectData, TDelete aDelete=EDelete)=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that the SAP has finished closing down. This up-call is the
response to a <code>Shutdown()</code>. A connection-oriented protocol should
call <code>CanClose()</code> when it has terminated communications with the
remote host. Protocols can call <code>CanClose()</code> from within their
<code>Shutdown()</code> code. After <code>CanClose()</code> has been called, a
SAP may be deleted by the socket server. </p>
<p>Notes:</p>
<ul>
<li>
<p>The protocol must not access the <code>CServProviderBase</code>
object after calling <code>CanClose()</code>.</p>
</li>
</ul>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDelete aDelete=Edelete </code></td>
<td class="Cell"><p class="ValueDesc"> Delete SAP </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> const TDesC8&amp; aDisConnectData </code></td>
<td class="Cell"><p class="ValueDesc"> Any user data carried on the disconnect frame. </p></td>
</tr>
</table></td></tr></table>
<a name="2.5.6"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aError%28%29"></a>
<hr size="1" noshade>
<h3><code>Error()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void Error(TInt anError, TUint anOperationMask=EErrorAllOperations)=0;</code></p><h4 class="subheading">Description</h4>
<p>Tells the socket server that an error state has arisen within the
protocol. It should not be used to report programmatic errors, either in the
protocol itself or the socket server (a panic should be used in these cases).
When <code>Error()</code> is called on a connection-oriented socket, the socket
is moved into a dead state which denies user access to it.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt anError </code></td>
<td class="Cell"><p class="ValueDesc"> An standard error number&#0160;&#8212;  see the system-wide error codes.
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TUint anOperationMask </code></td>
<td class="Cell"><p class="ValueDesc"> A bitmask of <code>TOperationBitmasks</code> values specifying which
pending operations are affected by the Error up-call. </p></td>
</tr>
</table></td></tr></table>
<a name="2.5.7"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aDisConnect%28%29"></a>
<hr size="1" noshade>
<h3><code>DisConnect()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void DisConnect()=0;<br>virtual void DisConnect(TDes8&amp; aConnectData)=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that the other end of a connection has disconnected. This is
analogous to <code>CanClose()</code>, but in this case the other end initiated
it. </p>
<p>Once the client has called <code>Shutdown()</code> it is illegal to call
<code>DisConnect()</code>. Instead, <code>CanClose</code>() or
<code>Error(KErrDisConnected)</code> should be called.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDes8&amp; aConnectData </code></td>
<td class="Cell"><p class="ValueDesc"> User data in the disconnect frame. </p></td>
</tr>
</table></td></tr></table>
<a name="2.5.8"></a></div><div class="Head3">
<a name="%3a%3aMSocketNotify%3a%3aIoctlComplete%28%29"></a>
<hr size="1" noshade>
<h3><code>IoctlComplete()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual void IoctlComplete(TDesC8* aBuf)=0;</code></p><h4 class="subheading">Description</h4>
<p>Indicates that the currently pending Ioctl has completed.</p>
<p>The parameter <code>aBuf</code> is protocol defined&#0160;&#8212;  in fact it is
defined by the specific Ioctl.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TDesC8* aBuf </code></td>
<td class="Cell"><p class="ValueDesc"> Any data requested by the Ioctl operation. </p></td>
</tr>
</table></td></tr></table>
<a name="2.6"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><a name="%3a%3aMSocketNotify%3a%3aTDelete"></a>
<hr size="2" noshade>
<h2>Enum <code>TDelete</code></h2>
</div><div class="Bodytext"><p class="Prototype"><code>TDelete</code></p><h4 class="subheading">Description</h4>
<p>Delete and detach flags.</p>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEDelete"><code class="Value">EDelete</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Delete SAP</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEDetach"><code class="Value">EDetach</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Don't delete SAP</para>
</p></td>
</tr>
</table></td></tr></table>
<a name="2.7"></a></div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><a name="%3a%3aMSocketNotify%3a%3aTOperationBitmasks"></a>
<hr size="2" noshade>
<h2>Enum <code>TOperationBitmasks</code></h2>
</div><div class="Bodytext"><p class="Prototype"><code>TOperationBitmasks</code></p><h4 class="subheading">Description</h4>
<p>Error codes.</p>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorSend"><code class="Value">EErrorSend</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects <code>Send()</code>
operations.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorRecv"><code class="Value">EErrorRecv</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects <code>Receive()</code>
operations.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorConnect"><code class="Value">EErrorConnect</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects <code>Connect()</code>
operations.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorClose"><code class="Value">EErrorClose</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects <code>Close()</code>
operations.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorIoctl"><code class="Value">EErrorIoctl</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects <code>Ioctl()</code>
operations.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorFatal"><code class="Value">EErrorFatal</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An fatal error has occurred.</para>
</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aMSocketNotify%3a%3aEErrorAllOperations"><code class="Value">EErrorAllOperations</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>An error has occurred which affects all operations.</para>
</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
