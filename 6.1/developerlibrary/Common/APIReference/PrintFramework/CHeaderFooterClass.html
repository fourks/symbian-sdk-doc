<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CHeaderFooter</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="index.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CPrintSetupClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Print&nbsp;Framework</a>&nbsp;<span class="separator">&#187;</span>
CHeaderFooter</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>prninf.h</code>
<br>Link against: <code>print.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCHeaderFooter"></a>

<h1>Class <code>CHeaderFooter</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CHeaderFooter</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>A document header or footer.</p>
<p>The header is located within the top page margin and the footer
within the bottom page margin. No more than one header or footer can exist in a
document.</p>
<p><code>CHeaderFooter</code> derives from
<code>MTextFieldFactory</code>. This enables the insertion of various fields,
including page number, current date or time and filename.</p>
<p>Rich text manipulation and formatting functions (see class
<a href="../TextAndTextAttributes/CRichTextClass.html#%3a%3aCRichText" title="Text with rich formatting"><code class="ApiItem">CRichText</code></a>) can be accessed through the rich text
object which is owned by the header/footer.</p>
<p>The header and footer are retrieved using the
<code>CPrintSetup::Header()</code> and <code>Footer()</code> functions and they
are stored and restored together with the rest of the print setup
information.</p>
<p>This class is not intended for user derivation.</p>
<h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CHeaderFooter</code></td><td class="Cell">A document header or footer</td>
</tr>
<tr><td class="Cell"><code><a href="../TextAndTextAttributes/MTextFieldFactoryClass.html#%3a%3aMTextFieldFactory">MTextFieldFactory</a></code></td><td class="Cell">Abstract base class for field factories</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CHeaderFooter</code>:
<br><code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aCharFormat%28%29" title="Gets the character format layer upon which the header or footer's character formatting is based">CharFormat()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aCreateTextL%28%29" title="Allocates and constructs the rich text object owned by the header or footer">CreateTextL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aExternalizeL%28%29" title="Externalises this object's text content and global format layers to a write stream">ExternalizeL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aFileNameFieldInfo%28%29" title="Gets the object which implements the MFieldFileNameInfo interface, as set by SetFileNameInfo()">FileNameFieldInfo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aFirstPageToPrintTo%28%29" title="Gets the first page on which the header or footer is to be printed">FirstPageToPrintTo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aInternalizeL%28%29" title="Internalises this object's text content and global format layers from a read stream">InternalizeL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aNewL%28%29" title="Allocates and constructs an uninitialised CHeaderFooter object">NewL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aNumPagesFieldInfo%28%29" title="Gets the object which implements the MFieldNumPagesInfo interface, as set by SetNumPagesInfo()">NumPagesFieldInfo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aParaFormat%28%29" title="Gets the paragraph format layer which is owned by the header or footer">ParaFormat()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aRestoreComponentsL%28%29" title="Restores this object's components from a stream store">RestoreComponentsL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aRestoreL%28%29" title="Restores this object and all associated components from a stream store">RestoreL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetCharFormat%28%29" title="Sets the format layer upon which the header or footer's character formatting is based">SetCharFormat()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetFileNameInfo%28%29" title="Sets an object to update the document's filename">SetFileNameInfo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetFirstPageToPrintTo%28%29" title="Sets the first page on which the header or footer is to be printed, allowing headers and footers to be omitted from the beginning of a document">SetFirstPageToPrintTo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetNumPagesInfo%28%29" title="Sets an object to update the total number of pages">SetNumPagesInfo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetPageNumInfo%28%29" title="This function is used internally by the CPrintSetup class">SetPageNumInfo()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetParaFormat%28%29" title="Sets the format layer upon which the header or footer's paragraph formatting is based">SetParaFormat()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aSetText%28%29" title="Sets the rich text object which is owned by the header or footer">SetText()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aStoreComponentsL%28%29" title="Stores this object's components to a stream store, specifying a stream store and store map">StoreComponentsL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aStoreL%28%29" title="Stores a CHeaderFooter object and all associated components to a stream store">StoreL()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3aText%28%29" title="Gets the rich text object owned by this header or footer">Text()</a></code>, <code class="ApiItem"><a href="CHeaderFooterClass.html#%3a%3aCHeaderFooter%3a%3a%7eCHeaderFooter%28%29" title="Destructor">~CHeaderFooter()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<p>Inherited from <code class="ApiItem"><a href="../TextAndTextAttributes/MTextFieldFactoryClass.html#%3a%3aMTextFieldFactory" title="Abstract base class for field factories">MTextFieldFactory</a></code>:
<br><code class="ApiItem"><a href="../TextAndTextAttributes/MTextFieldFactoryClass.html#%3a%3aMTextFieldFactory%3a%3aNewFieldL%28%29" title="Implementations of this function should create a field of the type specified, returning NULL if the field type is not recognised or supported">NewFieldL()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="UsingCHeaderFooter.guide.html#PrintFramework%2eusing%2dCHeaderFooter">Using CHeaderFooter</a></li>
</ul>
<a name="2.7"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CHeaderFooter* NewL();</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs an uninitialised
<code>CHeaderFooter</code> object.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CHeaderFooter*</code></td>
<td class="Cell"><p class="ValueDesc"> The newly constructed <code>CHeaderFooter</code> object.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">There is insufficient memory. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3a%7eCHeaderFooter%28%29"></a>
<hr size="1" noshade>
<h3><code>~CHeaderFooter()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>virtual ~CHeaderFooter();</code></p><h4 class="subheading">Description</h4>
<p>Destructor.</p>
<p>This frees all resources owned by the
<code>CHeaderFooter</code> object, prior to its destruction.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Stream persistence</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aStoreL%28%29"></a>
<hr size="1" noshade>
<h3><code>StoreL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TStreamId StoreL(CStreamStore&amp; aStore)const;</code></p><h4 class="subheading">Description</h4>
<p>Stores a <code>CHeaderFooter</code> object and all associated
components to a stream store.</p>
<p>Components include rich text-specific formatting, fields and
pictures.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc"> The store to which the <code>CHeaderFooter</code> should be
stored. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TStreamId</code></td>
<td class="Cell"><p class="ValueDesc"> ID of the stream containing the external representation of the
<code>CHeaderFooter</code> object </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">Out of memory.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aRestoreL%28%29"></a>
<hr size="1" noshade>
<h3><code>RestoreL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RestoreL(const CStreamStore&amp; aStore,TStreamId aStreamId,MPictureFactory* aFactory);</code></p><h4 class="subheading">Description</h4>
<p>Restores this object and all associated components from a
stream store. </p>
<p>Components include fields and pictures.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc"> Stream store from which to restore the
<code>CHeaderFooter</code>. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> TStreamId aStreamId</code></td>
<td class="Cell"><p class="ValueDesc"> ID of the stream containing the external representation of the
<code>CHeaderFooter</code> object. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> MPictureFactory* aFactory</code></td>
<td class="Cell"><p class="ValueDesc"> Picture factory. Must be supplied if the header or footer
contains pictures which should be restored. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">Out of memory.</p></td>
</tr>
</table></td></tr></table>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aStoreComponentsL%28%29"></a>
<hr size="1" noshade>
<h3><code>StoreComponentsL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void StoreComponentsL(CStreamStore&amp; aStore,CStoreMap&amp; aMap)const;</code></p><h4 class="subheading">Description</h4>
<p>Stores this object's components to a stream store, specifying a
stream store and store map. </p>
<p>Components include fields and pictures.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc"> The store to which the components are stored </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> CStoreMap&amp; aMap</code></td>
<td class="Cell"><p class="ValueDesc"> Table of swizzles. Supports the deferred loading of the rich
text components of the header or footer. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">The write action caused the stream's resources to be exhausted.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>This function does not store the text content or
global formatting of the header and footer, so it may need to be accompanied by
a call to <code>ExternalizeL()</code>.</note></li>
</ul>
<a name="2.8.5"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aRestoreComponentsL%28%29"></a>
<hr size="1" noshade>
<h3><code>RestoreComponentsL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void RestoreComponentsL(const CStreamStore&amp; aStore,MPictureFactory* aFactory);</code></p><h4 class="subheading">Description</h4>
<p>Restores this object's components from a stream store.</p>
<p>Components include fields and pictures.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const CStreamStore&amp; aStore</code></td>
<td class="Cell"><p class="ValueDesc"> Stream store from which the components are restored. </p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value"> MPictureFactory* aFactory</code></td>
<td class="Cell"><p class="ValueDesc"> Picture factory. Must be supplied if the header or footer
contains pictures which should be restored. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">Out of memory.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>This function does not restore the text content
or global formatting of the header and footer, so it may need to be accompanied
by a call to <code>InternalizeL()</code>.</note></li>
</ul>
<a name="2.8.6"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aExternalizeL%28%29"></a>
<hr size="1" noshade>
<h3><code>ExternalizeL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ExternalizeL(RWriteStream&amp; aStream) const;</code></p><h4 class="subheading">Description</h4>
<p>Externalises this object's text content and global format
layers to a write stream. </p>
<p>The object's components are not externalised. The presence of
this function means that the standard templated <code>operator&lt;&lt;()</code>
(defined in s32strm.h) is available to externalise objects of this
class.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RWriteStream&amp; aStream</code></td>
<td class="Cell"><p class="ValueDesc"> Stream to which the object should be externalised. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">The write action caused the stream's resources to be exhausted.
</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>This function does not store any fields, pictures
or rich text-specific formatting, so may need to be accompanied by a call to
<code>StoreComponentsL()</code>.</note></li>
</ul>
<a name="2.8.7"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aInternalizeL%28%29"></a>
<hr size="1" noshade>
<h3><code>InternalizeL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void InternalizeL(RReadStream&amp; aStream);</code></p><h4 class="subheading">Description</h4>
<p>Internalises this object's text content and global format
layers from a read stream. </p>
<p>The presence of this function means that the standard templated
<code>operator&gt;&gt;()</code> (defined in s32strm.h) is available to
internalise objects of this class.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> RReadStream&amp; aStream </code></td>
<td class="Cell"><p class="ValueDesc"> Stream from which the object should be internalised.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">Out of memory.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>This function does not restore any fields,
pictures or rich text-specific formatting, so may need to be accompanied by a
call to <code>RestoreComponentsL()</code>.</note></li>
</ul>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>First page</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetFirstPageToPrintTo%28%29"></a>
<hr size="1" noshade>
<h3><code>SetFirstPageToPrintTo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetFirstPageToPrintTo(TInt aPageNum);</code></p><h4 class="subheading">Description</h4>
<p>Sets the first page on which the header or footer is to be
printed, allowing headers and footers to be omitted from the beginning of a
document.</p>
<p>Page numbering begins at zero.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt aPageNum</code></td>
<td class="Cell"><p class="ValueDesc"> The number of the first page on which the header or footer is
to be printed. The first page is numbered zero. If less than zero, a panic
occurs.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aFirstPageToPrintTo%28%29"></a>
<hr size="1" noshade>
<h3><code>FirstPageToPrintTo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt FirstPageToPrintTo()const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the first page on which the header or footer is to be
printed.</p>
<p>Page numbering begins at zero.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> TInt</code></td>
<td class="Cell"><p class="ValueDesc"> The number of the first page on which the header or footer is
to be printed. </p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Field support</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetFileNameInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>SetFileNameInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetFileNameInfo(const MFieldFileNameInfo&amp; aFileNameInfo);</code></p><h4 class="subheading">Description</h4>
<p>Sets an object to update the document's filename.</p>
<p>If the header or footer supports filename fields, use this
function to set an object that implements the <code>MFieldFileNameInfo</code>
interface.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const
MFieldFileNameInfo&amp; aFileNameInfo</code></td>
<td class="Cell"><p class="ValueDesc"> Provides a filename update function.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10.3"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetPageNumInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>SetPageNumInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetPageNumInfo(const MFieldPageNumInfo&amp; aPageNumInfo);</code></p><h4 class="subheading">Description</h4>
<p>This function is used internally by the
<code>CPrintSetup</code> class.</p>
<a name="2.10.4"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetNumPagesInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>SetNumPagesInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetNumPagesInfo(const MFieldNumPagesInfo&amp; aNumPagesInfo);</code></p><h4 class="subheading">Description</h4>
<p>Sets an object to update the total number of pages.</p>
<p>If the header or footer supports total number of pages fields,
use this function to set up an object that implements the
<code>MFieldNumPagesInfo</code> interface.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> const
MFieldNumPagesInfo&amp; aNumPagesInfo</code></td>
<td class="Cell"><p class="ValueDesc"> Provides a function that updates the total number of pages in
the document.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10.5"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aFileNameFieldInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>FileNameFieldInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>MFieldFileNameInfo* FileNameFieldInfo() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the object which implements the
<code>MFieldFileNameInfo</code> interface, as set by
<code>SetFileNameInfo()</code>.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
MFieldFileNameInfo* </code></td>
<td class="Cell"><p class="ValueDesc"> The object which implements the
<code>MFieldFileNameInfo</code> interface.</p></td>
</tr>
</table></td></tr></table>
<a name="2.10.6"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aNumPagesFieldInfo%28%29"></a>
<hr size="1" noshade>
<h3><code>NumPagesFieldInfo()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>MFieldNumPagesInfo* NumPagesFieldInfo() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the object which implements the
<code>MFieldNumPagesInfo</code> interface, as set by
<code>SetNumPagesInfo()</code>.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">
MFieldNumPagesInfo*</code></td>
<td class="Cell"><p class="ValueDesc"> The object which implements the
<code>MFieldNumPagesInfo</code> interface.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Rich text</h2>
</div><div class="Bodytext">
<a name="2.11.2"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aCreateTextL%28%29"></a>
<hr size="1" noshade>
<h3><code>CreateTextL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void CreateTextL();</code></p><h4 class="subheading">Description</h4>
<p>Allocates and constructs the rich text object owned by the
header or footer.</p>
<p>The object's formatting is based on default values. If the
header or footer's rich text object has already been allocated, the object is
deleted and replaced by the one created by this function. So, calling this
function causes a header or footer to lose all its existing text content,
fields and formatting.</p>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">KErrNoMemory</code></td>
<td class="Cell"><p class="ValueDesc">There is insufficient memory to perform the operation.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.3"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aText%28%29"></a>
<hr size="1" noshade>
<h3><code>Text()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CRichText* Text() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the rich text object owned by this header or footer.
</p>
<p>Through this object, rich text, fields and pictures can be
inserted. This function can also be used to find out whether the rich text
component is NULL, in which case a call to <code>CreateTextL()</code> or
<code>SetText()</code> may be necessary.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CRichText*</code></td>
<td class="Cell"><p class="ValueDesc"> The rich text object owned by the header or footer.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.4"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aParaFormat%28%29"></a>
<hr size="1" noshade>
<h3><code>ParaFormat()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CParaFormatLayer* ParaFormat() const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the paragraph format layer which is owned by the header or
footer.</p>
<p>The header or footer's paragraph formatting is based upon this
layer.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CParaFormatLayer*</code></td>
<td class="Cell"><p class="ValueDesc"> The format layer upon which the header or footer's paragraph
formatting is based.</p></td>
</tr>
</table></td></tr></table>
<a name="2.11.5"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aCharFormat%28%29"></a>
<hr size="1" noshade>
<h3><code>CharFormat()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>CCharFormatLayer* CharFormat()const;</code></p><h4 class="subheading">Description</h4>
<p>Gets the character format layer upon which the header or
footer's character formatting is based.</p>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCharFormatLayer*</code></td>
<td class="Cell"><p class="ValueDesc"> The format layer upon which the header or footer's character
formatting is based. </p></td>
</tr>
</table></td></tr></table>
<a name="2.11.6"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetText%28%29"></a>
<hr size="1" noshade>
<h3><code>SetText()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetText(CRichText* aText);</code></p><h4 class="subheading">Description</h4>
<p>Sets the rich text object which is owned by the header or
footer.</p>
<p>The character and paragraph format layers upon which the header
or footer's formatting is based are not updated by this function, so you may
also need to call <code>SetParaFormat()</code> and
<code>SetCharFormat()</code>, specifying the paragraph and character format
layers referenced by <code>aText</code>.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CRichText* aText</code></td>
<td class="Cell"><p class="ValueDesc"> The rich text object to set as the header or footer's rich
text object.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>Ownership of <code>aText</code> is
transferred to this object.</note></li>
<li><note>Any existing rich text object is
replaced, but is not deleted by this function.</note></li>
</ul>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="UsingCHeaderFooter.guide.html#PrintFramework%2eusing%2dCHeaderFooter">Using CHeaderFooter</a></li>
</ul>
<a name="2.11.7"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetParaFormat%28%29"></a>
<hr size="1" noshade>
<h3><code>SetParaFormat()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetParaFormat(CParaFormatLayer* aParaFormat);</code></p><h4 class="subheading">Description</h4>
<p>Sets the format layer upon which the header or footer's
paragraph formatting is based.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CParaFormatLayer* aParaFormat</code></td>
<td class="Cell"><p class="ValueDesc"> The format layer upon which the header or footer's paragraph
formatting is based.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>Ownership of <code>aParaFormat</code> is
transferred to this object.</note></li>
<li><note>Any existing paragraph format layer is
replaced, but not deleted by this function.</note></li>
</ul>
<a name="2.11.8"></a></div><div class="Head3">
<a name="%3a%3aCHeaderFooter%3a%3aSetCharFormat%28%29"></a>
<hr size="1" noshade>
<h3><code>SetCharFormat()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetCharFormat(CCharFormatLayer* aCharFormat);</code></p><h4 class="subheading">Description</h4>
<p>Sets the format layer upon which the header or footer's
character formatting is based.</p>
<h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value"> CCharFormatLayer* aCharFormat</code></td>
<td class="Cell"><p class="ValueDesc"> The format layer upon which the header or footer's character
formatting is based. </p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Notes:</h4>
<ul>
<li><note>Ownership of <code>aCharFormat</code> is
transferred to this object.</note></li>
<li><note>Any existing character format layer is
replaced, but not deleted by this function.</note></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
