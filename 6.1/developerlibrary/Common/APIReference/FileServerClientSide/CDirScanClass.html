<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>CDirScan</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="CDirClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="CFileBaseClass.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">File&nbsp;Server&nbsp;Client&nbsp;Side</a>&nbsp;<span class="separator">&#187;</span>
CDirScan</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>f32file.h</code>
<br>Link against: <code>efsrv.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aCDirScan"></a>

<h1>Class <code>CDirScan</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>CDirScan</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Scans a directory structure.</p>
<p>The scan moves from directory to directory through the hierarchy,
returning a list of the entries contained in each. The order in which the
directories are scanned is determined by a sort key which is specified when
setting up the scan. The base directory to be scanned and the entry types of
interest must also be specified before performing the scan.</p>
<p>This class is not intended for user derivation</p><h4 class="subheading">Derivation</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr><td class="Cell"><code><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase">CBase</a></code></td><td class="Cell">Base class for all classes to be instantiated on the heap</td>
</tr>
<tr><td class="Cell"><code>CDirScan</code></td><td class="Cell">Scans a directory structure</td>
</tr>
</table></td></tr></table>
<p>Defined in <code>CDirScan</code>:
<br><code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aAbbreviatedPath%28%29" title="Returns the abbreviated path of the entry currently being scanned">AbbreviatedPath()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aEScanDownTree" title="Scan downwards from the top level directory in the hierarchy to the bottom level directory">EScanDownTree</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aEScanUpTree" title="Scan upwards from the lowest level directory in the hierarchy to the top level directory">EScanUpTree</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aFullPath%28%29" title="Returns the full path of the entry currently being scanned">FullPath()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aNewL%28%29" title="Constructs and allocates memory for a new CDirScan object">NewL()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aNewLC%28%29" title="Constructs and allocates memory for a new CDirScan object -- leaving object on cleanup stack">NewLC()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aNextL%28%29" title="Scans the next directory entry in the structure">NextL()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aSetScanDataL%28%29" title="Initialises the scan">SetScanDataL()</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3aTScanDirection" title="Scan direction">TScanDirection</a></code>, <code class="ApiItem"><a href="CDirScanClass.html#%3a%3aCDirScan%3a%3a%7eCDirScan%28%29" title="Frees all resources owned by the object, prior to its destruction">~CDirScan()</a></code>
</p>
<p>Inherited from <code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase" title="Base class for all classes to be instantiated on the heap">CBase</a></code>:
<br><code class="ApiItem"><a href="../BasicTypes/CBaseClass.html#%3a%3aCBase%3a%3aoperator%20new%28%29" title="Allocates the object from the heap and then initialises its contents to binary zeroes">operator new()</a></code></p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="UsingCDirScanClass.guide.html#FileServerClientSide%2eusing%2dCDirScan">Using CDirScan</a></li>
</ul>
<a name="2.7"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aNewL%28%29"></a>
<hr size="1" noshade>
<h3><code>NewL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CDirScan* NewL(RFs&amp; aFs);</code></p><h4 class="subheading">Description</h4>
<p>Constructs and allocates memory for a new <code>CDirScan</code>
object.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RFs&amp; aFs</code></td>
<td class="Cell"><p class="ValueDesc">File server session.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CDirScan*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to the new directory scan object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aNewLC%28%29"></a>
<hr size="1" noshade>
<h3><code>NewLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>static CDirScan* NewLC(RFs&amp; aFs);</code></p><h4 class="subheading">Description</h4>
<p>Constructs and allocates memory for a new <code>CDirScan</code>
object&nbsp;&#8212; leaving object on cleanup stack. If construction is
successful, the object is placed on the clean-up stack before the function
returns.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RFs&amp; aFs</code></td>
<td class="Cell"><p class="ValueDesc">File server session</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CDirScan*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to the new directory scan object.</p></td>
</tr>
</table></td></tr></table>
<a name="2.7.4"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3a%7eCDirScan%28%29"></a>
<hr size="1" noshade>
<h3><code>~CDirScan()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>~CDirScan();</code></p><h4 class="subheading">Description</h4>
<p>Frees all resources owned by the object, prior to its
destruction.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Scanning functions</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aSetScanDataL%28%29"></a>
<hr size="1" noshade>
<h3><code>SetScanDataL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void SetScanDataL(const TDesC&amp; aMatchName,TUint anEntryAttMask,TUint anEntrySortMask,TScanDirection aScanDir=EScanDownTree);</code></p><h4 class="subheading">Description</h4>
<p>Initialises the scan. This involves specifying:</p>
<ul>
<li>
<p>the directory at the top of the structure to be scanned</p>
</li>
<li>
<p>a filter for the entry types of interest</p>
</li>
<li>
<p>the order in which the entries in each directory in the structure
are to be sorted</p>
</li>
<li>
<p>the scan direction.</p>
</li>
</ul>
<p>Whether the scan direction is upwards or downwards, the directories
which are scanned are those in the part of the hierarchy below the directory
specified in <code>aMatchName</code>. By default, the scan direction is
downwards. If the scan direction is set to <code>CDirScan::EScanUpTree</code>,
all branches of the tree are explored starting at the lowest level directory in
the tree below <code>aMatchName</code>, and ending at <code>aMatchName</code>.
This option is provided for deleting a directory
structure.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC&amp; aMatchName</code></td>
<td class="Cell"><p class="ValueDesc">The top level directory for the scan. Any path components which are
not specified here are taken from the session path.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TUint anEntryAttMask</code></td>
<td class="Cell"><p class="ValueDesc">A bit mask which filters the entry types which should be returned by
<code>NextL()</code>. The mask works as follows: To match files only, specify
<code>KEntryAttNormal</code>. To match both files and directories, specify
<code>KEntryAttDir</code>. To match directories only, specify
<code>KEntryAttDir|KEntryAttMatchExclusive</code>. To match files with a
specific attribute, OR the attribute involved with
<code>KEntryAttMatchExclusive</code>. For example, to match read-only files,
specify <code>KEntryAttReadOnly|KEntryAttMatchExclusive</code>. For more
information see <code>KEntryAttNormal</code> or the other file/directory
attributes</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TUint anEntrySortMask</code></td>
<td class="Cell"><p class="ValueDesc">The order in which the directories are scanned by
<code>NextL()</code>.This flag is defined in <code>TEntryKey</code>.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TScanDirection aScanDir=EScanDownTree</code></td>
<td class="Cell"><p class="ValueDesc">The direction of the scan. By default, downwards.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="UsingCDirScanClass.guide.html#FileServerClientSide%2eusing%2dCDirScan">Using CDirScan</a></li>
</ul>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aNextL%28%29"></a>
<hr size="1" noshade>
<h3><code>NextL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void NextL(CDir*&amp; aDirEntries);</code></p><h4 class="subheading">Description</h4>
<p>Scans the next directory entry in the structure.</p>
<p>The order in which the structure is scanned is determined by the scan
direction and the entry sort mask. These values are specified when setting up
the scan. The type of entries retrieved by this function is determined by the
entry attribute mask. This is also specified when setting up the scan.</p>
<p>Notes:</p>
<ul>
<li>
<p>The function first sets <code>aDirEntries</code> to NULL, then
allocates memory for it before appending entries to it. Therefore,
<code>aDirEntries</code> should have no memory allocated to it before this
function is called, otherwise this memory will become orphaned.</p>
</li>
<li>
<p>The caller of this function is responsible for deleting
<code>aDirEntries</code> after the function has returned.</p>
</li>
</ul><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">CDir*&amp; aDirEntries</code></td>
<td class="Cell"><p class="ValueDesc">On return, a pointer to an array containing filtered entries from the
next directory in the structure. NULL if there are no more directories in the
structure.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Parsing paths</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aAbbreviatedPath%28%29"></a>
<hr size="1" noshade>
<h3><code>AbbreviatedPath()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TPtrC AbbreviatedPath();</code></p><h4 class="subheading">Description</h4>
<p>Returns the abbreviated path of the entry currently being scanned. The
abbreviated path is the path relative to the top level directory in the
scan.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TPtrC</code></td>
<td class="Cell"><p class="ValueDesc">A non modifiable pointer descriptor for the abbreviated path of the entry
currently being scanned.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aFullPath%28%29"></a>
<hr size="1" noshade>
<h3><code>FullPath()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TPtrC FullPath();</code></p><h4 class="subheading">Description</h4>
<p>Returns the full path of the entry currently being scanned. The full path
includes the drive letter.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TPtrC</code></td>
<td class="Cell"><p class="ValueDesc">A non modifiable pointer descriptor for the full path of the entry
currently being scanned..</p></td>
</tr>
</table></td></tr></table>
<a name="2.10"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Enumerations</h2>
</div><div class="Bodytext">
<a name="2.10.2"></a></div><div class="Head3">
<a name="%3a%3aCDirScan%3a%3aTScanDirection"></a>
<hr size="1" noshade>
<h3>Enum <code>TScanDirection</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TScanDirection</code></p><h4 class="subheading">Description</h4>
<p>Scan direction</p><table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><a name="%3a%3aCDirScan%3a%3aEScanUpTree"><code class="Value">EScanUpTree</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Scan upwards from the lowest level directory in the hierarchy to the top
level directory</para></p></td>
</tr>
<tr valign="top">
<td class="Cell" ><a name="%3a%3aCDirScan%3a%3aEScanDownTree"><code class="Value">EScanDownTree</code></a></td>
<td class="Cell"><p class="ValueDesc">
<para>Scan downwards from the top level directory in the hierarchy to the
bottom level directory</para></p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
