<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RResourceFile</title>
<link href="../../../_stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../_stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../_stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../_stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../_stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../_stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../_stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="index.html"><img src="../../../_stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="TResourceReaderClass.html"><img src="../../../_stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">Interface&nbsp;to&nbsp;Resource&nbsp;Files</a>&nbsp;<span class="separator">&#187;</span>
RResourceFile</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>barsc.h</code>
<br>Link against: <code>bafl.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aRResourceFile"></a>

<h1>Class <code>RResourceFile</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RResourceFile</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Accesses a resource file and reads the resource data into a buffer.
</p>
<p>Interpretation of the data is achieved using the
<code>TResourceReader</code> class.</p><p>Defined in <code>RResourceFile</code>:
<br><code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aAllocReadL%28%29" title="Reads a resource into a heap descriptor and returns a pointer to that descriptor">AllocReadL()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aAllocReadLC%28%29" title="Reads a resource into a heap descriptor, returns a pointer to that descriptor and pushes the pointer onto the cleanup stack">AllocReadLC()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aClose%28%29" title="Closes the resource file reader">Close()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aConfirmSignatureL%28%29" title="Initialises the offset value from the first resource">ConfirmSignatureL()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file">Offset()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOpenL%28%29" title="Opens the resource file reader">OpenL()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOwnsResourceId%28%29" title="Tests whether the resource file owns the specified resource id">OwnsResourceId()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aRResourceFile%28%29" title="Constructs a default resource file object">RResourceFile()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aReadL%28%29" title="Reads a resource specified by resource id into the specified descriptor">ReadL()</a></code>, <code class="ApiItem"><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aSignatureL%28%29" title="Returns this resource file's version number">SignatureL()</a></code>
</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="TResourceReaderClass.html#%3a%3aTResourceReader" title="Interprets resource data read from a resource file"><code class="ApiItem">TResourceReader</code></a></li>
</ul>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Construction and destruction</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aRResourceFile%28%29"></a>
<hr size="1" noshade>
<h3><code>RResourceFile()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>RResourceFile();</code></p><h4 class="subheading">Description</h4>
<p>Constructs a default resource file object.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Opening and closing</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aOpenL%28%29"></a>
<hr size="1" noshade>
<h3><code>OpenL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void OpenL(RFs&amp; aFs,const TDesC&amp; aName);</code></p><h4 class="subheading">Description</h4>
<p>Opens the resource file reader.</p>
<p>The resource file reader must be opened before reading resources
or checking the signature of the resource file.</p>
<p>If the function is successful, a cleanup item is placed onto the
cleanup stack for the resource file; if a leave occurs, the resource file is
closed.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RFs&amp; aFs</code></td>
<td class="Cell"><p class="ValueDesc">Handle to a file server session</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC&amp; aName</code></td>
<td class="Cell"><p class="ValueDesc">File to open as a resource file</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Leave codes</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">&nbsp;</code></td>
<td class="Cell"><p class="ValueDesc">The function leaves if the named file cannot be opened or the
header record at the beginning of the file cannot be read. </p></td>
</tr>
</table></td></tr></table>
<a name="2.7.3"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Close();</code></p><h4 class="subheading">Description</h4>
<p>Closes the resource file reader.</p>
<p>This function is called after finishing reading all
resources.</p>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Reading resources</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aAllocReadL%28%29"></a>
<hr size="1" noshade>
<h3><code>AllocReadL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>HBufC8* AllocReadL(TInt aResourceId) const;</code></p><h4 class="subheading">Description</h4>
<p>Reads a resource into a heap descriptor and returns a pointer to that
descriptor.</p>
<p>A heap descriptor of appropriate length is allocated for the
resource. Ownership of the heap descriptor passes to the caller who must
destroy it when it is no longer needed.</p>
<p>The search for the resource uses the following algorithm:</p>
<ul>
<li>
<p>A resource id in the range 1 to 4095 is looked up in this
resource file. The function leaves if there is no matching resource.</p>
</li>
<li>
<p>If the resource id is greater than 4095, then the most
significant 20 bits of the resource id is treated as an offset and the least
significant 12 bits is treated as the real resource id. If the offset matches
the offset value defined for this file, then the resource is looked up in this
resource file using the real resource id (i.e. the least significant 12 bits).
If the offset does not match, then the function leaves.</p>
</li>
</ul>
<p>Note, do not call this function until a call to
<code>ConfirmSignatureL()</code> has completed
successfully.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aResourceId</code></td>
<td class="Cell"><p class="ValueDesc">The numeric id of the resource to be read.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">HBufC8*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to an 8 bit heap descriptor containing the resource.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file"><code class="ApiItem">RResourceFile::Offset()</code></a></li>
</ul>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aAllocReadLC%28%29"></a>
<hr size="1" noshade>
<h3><code>AllocReadLC()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>HBufC8* AllocReadLC(TInt aResourceId) const;</code></p><h4 class="subheading">Description</h4>
<p>Reads a resource into a heap descriptor, returns a pointer to that
descriptor and pushes the pointer onto the cleanup stack.</p>
<p>A heap descriptor of appropriate length is allocated for the resource.
Ownership of the heap descriptor passes to the caller who must destroy it and
pop its pointer off the cleanup stack when it is no longer needed.</p>
<p>The search for the resource uses the following algorithm:</p>
<ul>
<li>
<p>A resource id in the range 1 to 4095 is looked up in this resource
file. The function leaves if there is no matching resource.</p>
</li>
<li>
<p>If the resource id is greater than 4095, then the most significant
20 bits of the resource id is treated as an offset and the least significant 12
bits is treated as the real resource id. If the offset matches the offset value
defined for this file, then the resource is looked up in this resource file
using the real resource id (i.e. the least significant 12 bits). If the offset
does not match, then the function leaves.</p>
</li>
</ul>
<p>Note, do not call this function until a call to
<code>ConfirmSignatureL()</code> has completed
successfully.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aResourceId</code></td>
<td class="Cell"><p class="ValueDesc">The numeric id of the resource to be read.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">HBufC8*</code></td>
<td class="Cell"><p class="ValueDesc">Pointer to a heap descriptor containing the resource.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file"><code class="ApiItem">RResourceFile::Offset()</code></a></li>
</ul>
<a name="2.8.4"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aReadL%28%29"></a>
<hr size="1" noshade>
<h3><code>ReadL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ReadL(TDes8&amp; aDes,TInt aResourceId) const;</code></p><h4 class="subheading">Description</h4>
<p>Reads a resource specified by resource id into the specified
descriptor.</p>
<p>The descriptor must be long enough to contain the entire resource</p>
<p>The search for the resource uses the following algorithm:</p>
<ul>
<li>
<p>A resource id in the range 1 to 4095 is looked up in this resource
file. The function leaves if there is no matching resource.</p>
</li>
<li>
<p>If the resource id is greater than 4095, then the most significant 20
bits of the resource id is treated as an offset and the least significant 12
bits is treated as the real resource id. If the offset matches the offset value
defined for this file, then the resource is looked up in this resource file
using the real resource id (i.e. the least significant 12 bits). If the offset
does not match, then the function leaves.</p>
</li>
</ul>
<p>Note, do not call this function until a call to
<code>ConfirmSignatureL()</code> has completed
successfully.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TDes8&amp; aDes</code></td>
<td class="Cell"><p class="ValueDesc">On return, contains the resource that has been read. The function leaves
if the descriptor is not long enough to contain the entire resource.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aResourceId</code></td>
<td class="Cell"><p class="ValueDesc">The numeric id of the resource to be read. The function leaves if this
resource id is not in this resource file.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file"><code class="ApiItem">RResourceFile::Offset()</code></a></li>
</ul>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../_stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Multiple resource file support</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aSignatureL%28%29"></a>
<hr size="1" noshade>
<h3><code>SignatureL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt SignatureL() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns this resource file's version number.</p>
<p>The function assumes that the first resource in the file consists of two
32-bit integers. The first integer contains the version
number.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The version number</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aConfirmSignatureL%28%29" title="Initialises the offset value from the first resource"><code class="ApiItem">RResourceFile::ConfirmSignatureL()</code></a></li>
</ul>
<a name="2.9.3"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aConfirmSignatureL%28%29"></a>
<hr size="1" noshade>
<h3><code>ConfirmSignatureL()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void ConfirmSignatureL(TInt /*aSignature*/);</code></p><h4 class="subheading">Description</h4>
<p>Initialises the offset value from the first resource.</p>
<p>The function assumes that the first resource in the file consists of two
32-bit integers. The first integer contains the version number and the second
is a self-referencing link whose value is the offset for the resources in the
file, plus 1.</p>
<p>This function must be called before calling <code>Offset()</code>,
<code>AllocReadL()</code>, <code>AllocReadLC()</code> or
<code>ReadL()</code>.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aSignature</code></td>
<td class="Cell"><p class="ValueDesc">This argument value is not used by the function.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file"><code class="ApiItem">RResourceFile::Offset()</code></a></li>
</ul>
<a name="2.9.4"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aOffset%28%29"></a>
<hr size="1" noshade>
<h3><code>Offset()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Offset() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the offset value defined for this resource file. </p>
<p>This function must not be called until a call to
<code>ConfirmSignatureL()</code> has completed successfully, otherwise the
value returned by this function may be meaningless.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The offset value defined for this resource file.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aConfirmSignatureL%28%29" title="Initialises the offset value from the first resource"><code class="ApiItem">RResourceFile::ConfirmSignatureL()</code></a></li>
</ul>
<a name="2.9.5"></a></div><div class="Head3">
<a name="%3a%3aRResourceFile%3a%3aOwnsResourceId%28%29"></a>
<hr size="1" noshade>
<h3><code>OwnsResourceId()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TBool OwnsResourceId(TInt aResourceId) const;</code></p><h4 class="subheading">Description</h4>
<p>Tests whether the resource file owns the specified resource id.</p>
<p>The resource file owns the resource id if the most significant 20 bits of
the resource id are zero or match the offset value as returned from a call to
the <code>Offset()</code> member function.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt aResourceId</code></td>
<td class="Cell"><p class="ValueDesc">The resource id to test.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TBool</code></td>
<td class="Cell"><p class="ValueDesc">True, if the resource file owns the id, false otherwise</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RResourceFileClass.html#%3a%3aRResourceFile%3a%3aOffset%28%29" title="Returns the offset value defined for this resource file"><code class="ApiItem">RResourceFile::Offset()</code></a></li>
</ul>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../_stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
