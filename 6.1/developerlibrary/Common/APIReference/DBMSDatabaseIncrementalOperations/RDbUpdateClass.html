<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>RDbUpdate</title>
<link href="../../../stock/sysdoc.css" type="text/css" rel="stylesheet" media="screen">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen"><!--
.ButtonBox { background-image: url(../../../stock/gradient.jpg); }
--></style>
</head>
<body><a name="_top"></a><a name="2"></a>
<table width="100%" border="0" cellspacing="0"
cellpadding="0"><tbody><tr><td colspan=2 class="LogoBox"><a><img
src="../../../stock/symbian.gif" alt="Symbian" width="121"
height="46" border="0"></a><img src="../../../stock/mainheading.gif"
alt=" Developer Library" height="46" width="183"></td></tr><tr><td
class="DocSetBox" width="33%">
<p><a href="../../../Product/Generic/index.html">SYMBIAN OS V6.1 EDITION FOR C++</a></p>
</td><td class="ButtonBox" align="right" width="67%">
<p><a href="../../../_index/index.html"><img
src="../../../stock/btn_index.gif" alt="[Index]" width="53"
height="22" border="0"></a> <a href="../../GlobalGlossary/index.html"><img src="../../../stock/btn_glossary.gif"
alt="[Glossary]" border="0" width="81" height="22"></a> <img src="../../../stock/btn_spacer.gif"
alt="" width="60" height="22"> <a href="RDbIncrementalClass.html"><img src="../../../stock/btn_prev.gif"
alt="[Previous]" border="0" width="85" height="22"></a> <a href="DBMSErrorCodes.guide.html"><img src="../../../stock/btn_next.gif" alt="[Next]"
border="0" width="58" height="22"></a></p>
</td></tr></table>
<hr noshade size="1">
<p class="breadcrumbNav">&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/index.html">Symbian&nbsp;OS&nbsp;v6.1&nbsp;Edition&nbsp;for&nbsp;C++</a>&nbsp;<span class="separator">&#187;</span>
<a href="../../../Product/Generic/APIReference/index.html">API&nbsp;Reference</a>&nbsp;<span class="separator">&#187;</span>
<a href="index.html">DBMS&nbsp;Database&nbsp;Incremental&nbsp;Operations</a>&nbsp;<span class="separator">&#187;</span>
RDbUpdate</p>

<hr noshade size="1">
<div class="AuthoredContent">

<p>Location:
<code>d32dbms.h</code>
<br>Link against: <code>edbms.lib</code>
</p>
</div><div class="Head1">
<a name="%3a%3aRDbUpdate"></a>

<h1>Class <code>RDbUpdate</code></h1>
</div><div class="Bodytext"><p class="Prototype"><code>RDbUpdate</code></p><h4 class="subheading">Support</h4>
<p>Supported from 5.0
</p><h4 class="subheading">Description</h4>
<p>Provides an interface to allow incremental execution of a DML (SQL
data update) statement. </p>
<p>This class offers similar behaviour to the
<code>RDbIncremental</code> class, in that it allows an application to perform
long running operations while remaining responsive to events. However, unlike
that class, <code>RDbUpdate</code> is restricted to executing DML
statements.</p><p>Defined in <code>RDbUpdate</code>:
<br><code class="ApiItem"><a href="RDbUpdateClass.html#%3a%3aRDbUpdate%3a%3aClose%28%29" title="Releases the resources used by this incremental operation object">Close()</a></code>, <code class="ApiItem"><a href="RDbUpdateClass.html#%3a%3aRDbUpdate%3a%3aExecute%28%29" title="Initiates the incremental execution of a DML (SQL data update) statement on the database">Execute()</a></code>, <code class="ApiItem"><a href="RDbUpdateClass.html#%3a%3aRDbUpdate%3a%3aNext%28%29" title="Performs the next step in the incremental execution of the DML (SQL data update) statement asynchronously">Next()</a></code>, <code class="ApiItem"><a href="RDbUpdateClass.html#%3a%3aRDbUpdate%3a%3aRowCount%28%29" title="Returns the number of rows currently affected by the execution of the DML (SQL data update) statement on the database">RowCount()</a></code>
</p>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RDbIncrementalClass.html#%3a%3aRDbIncremental" title="Provides the interface for performing long-running database operations in incremental steps, allowing application programs to remain responsive to other events"><code class="ApiItem">RDbIncremental</code></a></li>
</ul>
<a name="2.6"></a>
</div><div class="Head2">
<hr size="2" noshade>
<h2>Release resources</h2>
</div><div class="Bodytext">
<a name="2.6.2"></a></div><div class="Head3">
<a name="%3a%3aRDbUpdate%3a%3aClose%28%29"></a>
<hr size="1" noshade>
<h3><code>Close()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Close();</code></p><h4 class="subheading">Description</h4>
<p>Releases the resources used by this incremental operation
object. If the operation is not yet complete, then the operation is abandoned
and the database is rolled back to its state before the operation
started.</p>
<a name="2.7"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Starting the incremental execution of the DML statement</h2>
</div><div class="Bodytext">
<a name="2.7.2"></a></div><div class="Head3">
<a name="%3a%3aRDbUpdate%3a%3aExecute%28%29"></a>
<hr size="1" noshade>
<h3><code>Execute()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Execute(RDbDatabase&amp; aDatabase,const TDesC&amp; aSql,TDbTextComparison aComparison=EDbCompareNormal);</code></p><h4 class="subheading">Description</h4>
<p>Initiates the incremental execution of a DML (SQL data update)
statement on the database. This is similar to
<code>RDbDatabase::Execute()</code>.</p>
<p>Note that to begin executing a DDL (SQL schema update) statement
incrementally, use the <code>RDbIncremental</code> class.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">RDbDatabase&amp; aDatabase</code></td>
<td class="Cell"><p class="ValueDesc">The database on which the DML (SQL data update) statement is to
execute.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">const TDesC&amp; aSql</code></td>
<td class="Cell"><p class="ValueDesc">A reference to a descriptor containing the DML statement to be
executed.</p></td>
</tr>
<tr valign="top">
<td class="Cell" ><code class="Value">TDbTextComparison aComparison</code></td>
<td class="Cell"><p class="ValueDesc">This argument is only used in the execution of some SQL
statements. By default the comparison is <code>EDbCompareNormal</code>. For
more information see <code>RDbDatabase::Execute()</code>.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNone</code>, if the operation is complete or 1, if the
operation requires further incremental execution or another of the system-wide
error codes.</p></td>
</tr>
</table></td></tr></table>
<h4 class="subheading">See also:</h4>
<ul>
<li><a href="RDbIncrementalClass.html#%3a%3aRDbIncremental" title="Provides the interface for performing long-running database operations in incremental steps, allowing application programs to remain responsive to other events"><code class="ApiItem">RDbIncremental</code></a></li>
<li><a href="../InterfaceToDBMSDatabases/RDbDatabaseClass.html#%3a%3aRDbDatabase%3a%3aExecute%28%29" title="Executes a DDL (SQL schema update) statement or a DML (SQL data update) statement on the database and returns when complete"><code class="ApiItem">RDbDatabase::Execute()</code></a></li>
</ul>
<a name="2.8"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Continuing the incremental execution of the DML statement</h2>
</div><div class="Bodytext">
<a name="2.8.2"></a></div><div class="Head3">
<a name="%3a%3aRDbUpdate%3a%3aNext%28%29"></a>
<hr size="1" noshade>
<h3><code>Next()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt Next();</code></p><h4 class="subheading">Description</h4>
<p>Performs the next step in the incremental execution of the DML (SQL
data update) statement synchronously. The function returns when the step is
complete.</p>
<p>Note that if the incremental step fails, then the incremental
object should be closed and the operation abandoned.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc"><code>KErrNone</code> if execution of the DML statement is complete
or 1 if another step in the execution of the DML statement is needed. or
another of the system-wide error codes is returned if the incremental step
fails. </p></td>
</tr>
</table></td></tr></table>
<a name="2.8.3"></a></div><div class="Head3">
<a name="%3a%3aRDbUpdate%3a%3aNext%28%29"></a>
<hr size="1" noshade>
<h3><code>Next()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>void Next(TRequestStatus&amp; aStatus);</code></p><h4 class="subheading">Description</h4>
<p>Performs the next step in the incremental execution of the DML (SQL
data update) statement asynchronously.</p>
<p>The function returns immediately and signals when the step is
complete.</p>
<p>This function is most effectively used when the incremental operation
is packaged as an active object.</p>
<p>Note that if the incremental step fails, then the incremental object
should be closed, and the operation abandoned.</p><h4 class="subheading">Parameters</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TRequestStatus&amp; aStatus</code></td>
<td class="Cell"><p class="ValueDesc">The request status used to contain completion information for the
operation. On completion, it contains:<code>KErrNone</code>, if execution of
the DML statement is complete or 1, if another step in the execution of the DML
statement is needed. or another of the system-wide error codes, if the
incremental step fails.</p></td>
</tr>
</table></td></tr></table>
<a name="2.9"></a>
</div><div class="Head2">
<table cellpadding="0" cellspacing="0" border="0" width="97%"><tr valign="bottom"><td align="right"><p><a href="#_top"><img alt="[Top]" src="../../../stock/arrow_up_2.gif" border="0"align="bottom"></a></p></td></tr></table><hr size="2" noshade>
<h2>Number of rows affected</h2>
</div><div class="Bodytext">
<a name="2.9.2"></a></div><div class="Head3">
<a name="%3a%3aRDbUpdate%3a%3aRowCount%28%29"></a>
<hr size="1" noshade>
<h3><code>RowCount()</code></h3>
</div><div class="Bodytext"><p class="Prototype"><code>TInt RowCount() const;</code></p><h4 class="subheading">Description</h4>
<p>Returns the number of rows currently affected by the execution of the
DML (SQL data update) statement on the database.</p>
<p>Once execution of the DML statement is complete, the value returned is
the final total number of rows affected.</p><h4 class="subheading">Return value</h4>
<table cellpadding="0" border="0"
cellspacing="0"><tr><td class="ValueTableWrap"><table border="0"
cellpadding="5" cellspacing="1">
<tr valign="top">
<td class="Cell" ><code class="Value">TInt</code></td>
<td class="Cell"><p class="ValueDesc">The current/final number of rows affected by the execution of the DML
statement.</p></td>
</tr>
</table></td></tr></table>

</div><div class="Footer">
<hr noshade size="1">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="bottom">
<td><p class="copyrightStatement">Copyright &copy;2002&nbsp; Symbian Ltd. &nbsp; &nbsp; &nbsp;	6.1-00174
</p></td>
<td align="right"><p><a href="#_top"><img
alt="[Top]" src="../../../stock/arrow_up.gif" border="0"
align="bottom"></a></p></td>
</table>
</div>
</body>
</html>
